define("page",["../lib/js/modules/Swiper/swiper","jquery.bpopup.min","jquery.mobile-events.min","leaves","../lib/js/config/config","prefixfree.min","yanhua","Snow","ThreeCanvas","playSnow"],(function(t,e,i){var n=t("../lib/js/modules/Swiper/swiper");t("./jquery.bpopup.min"),t("./jquery.mobile-events.min"),t("./leaves"),t("./prefixfree.min"),t("./yanhua"),t("./Snow");var a=t("./playSnow");window.onload=function(){a()},$(document).ready((function(){travo({gobackFunc:"window.goback()",sns:{enableMore:1,sina:1,weChat:1,weMoments:1,zls:1,qq:1,qZone:1,clipBoard:1,sms:0}});var t={shareTitle:"旅行中该怎么“日”？",shareTxt:"超级达人力荐4条日本路线，教你一步步从头到尾玩透日本。",shareUrl:"http://tao.117go.com/japan-strategy?refer=zlswx"};t.sharePic=OP_CDN_PREFIX+"images/share.jpg",travo.setShareParam(t.shareTitle,t.sharePic,t.shareUrl,t.shareTxt),$("a").on("click",(function(t){var e=$(this);localStorage.setItem(e.attr("href"),!0),e.addClass("visited")})),$("a").each((function(t,e){var i=$(e);localStorage.getItem(i.attr("href"))&&i.addClass("visited")})),$("html").css({"font-size":.0625*$window.width()});new n(".swiper-container");$(".role").tap((function(){$(".role_pop").bPopup()})),$(".role_pop button").tap((function(){$(".b-modal").click()})),$(".egg").click((function(){$(".zaozhidao").bPopup()})),$(".zaozhidao button").tap((function(){$(".b-modal").click()}))}))})),define("../lib/js/modules/Swiper/swiper",[],(function(t,e,i){"use strict";var n,a,r=function(t,e){if(!(this instanceof r))return new r(t,e);var i={direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,autoplay:!1,autoplayDisableOnInteraction:!0,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeSticky:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",coverflow:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},cube:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94},fade:{crossFade:!1},parallax:!1,scrollbar:null,scrollbarHide:!0,keyboardControl:!1,mousewheelControl:!1,mousewheelReleaseOnEdges:!1,mousewheelInvert:!1,mousewheelForceToAxis:!1,hashnav:!1,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,onlyExternal:!1,threshold:0,touchMoveStopPropagation:!0,pagination:null,paginationClickable:!1,paginationHide:!1,paginationBulletRender:null,resistance:!0,resistanceRatio:.85,nextButton:null,prevButton:null,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,lazyLoading:!1,lazyLoadingInPrevNext:!1,lazyLoadingOnTransitionStart:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,control:void 0,controlInverse:!1,allowSwipeToPrev:!0,allowSwipeToNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",buttonDisabledClass:"swiper-button-disabled",paginationHiddenClass:"swiper-pagination-hidden",observer:!1,observeParents:!1,a11y:!1,prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",runCallbacksOnInit:!0},n=e&&e.virtualTranslate;for(var a in e=e||{},i)if(void 0===e[a])e[a]=i[a];else if("object"==typeof e[a])for(var s in i[a])void 0===e[a][s]&&(e[a][s]=i[a][s]);var l,h=this;if(h.version="3.0.8",h.params=e,h.classNames=[],(l=void 0===o?window.Dom7||window.Zepto||window.jQuery:o)&&(h.$=l,h.container=l(t),0!==h.container.length)){if(!(h.container.length>1)){h.container[0].swiper=h,h.container.data("swiper",h),h.classNames.push("swiper-container-"+h.params.direction),h.params.freeMode&&h.classNames.push("swiper-container-free-mode"),h.support.flexbox||(h.classNames.push("swiper-container-no-flexbox"),h.params.slidesPerColumn=1),(h.params.parallax||h.params.watchSlidesVisibility)&&(h.params.watchSlidesProgress=!0),["cube","coverflow"].indexOf(h.params.effect)>=0&&(h.support.transforms3d?(h.params.watchSlidesProgress=!0,h.classNames.push("swiper-container-3d")):h.params.effect="slide"),"slide"!==h.params.effect&&h.classNames.push("swiper-container-"+h.params.effect),"cube"===h.params.effect&&(h.params.resistanceRatio=0,h.params.slidesPerView=1,h.params.slidesPerColumn=1,h.params.slidesPerGroup=1,h.params.centeredSlides=!1,h.params.spaceBetween=0,h.params.virtualTranslate=!0,h.params.setWrapperSize=!1),"fade"===h.params.effect&&(h.params.slidesPerView=1,h.params.slidesPerColumn=1,h.params.slidesPerGroup=1,h.params.watchSlidesProgress=!0,h.params.spaceBetween=0,void 0===n&&(h.params.virtualTranslate=!0)),h.params.grabCursor&&h.support.touch&&(h.params.grabCursor=!1),h.wrapper=h.container.children("."+h.params.wrapperClass),h.params.pagination&&(h.paginationContainer=l(h.params.pagination),h.params.paginationClickable&&h.paginationContainer.addClass("swiper-pagination-clickable")),h.rtl=E()&&("rtl"===h.container[0].dir.toLowerCase()||"rtl"===h.container.css("direction")),h.rtl&&h.classNames.push("swiper-container-rtl"),h.rtl&&(h.wrongRTL="-webkit-box"===h.wrapper.css("display")),h.params.slidesPerColumn>1&&h.classNames.push("swiper-container-multirow"),h.device.android&&h.classNames.push("swiper-container-android"),h.container.addClass(h.classNames.join(" ")),h.translate=0,h.progress=0,h.velocity=0,h.lockSwipeToNext=function(){h.params.allowSwipeToNext=!1},h.lockSwipeToPrev=function(){h.params.allowSwipeToPrev=!1},h.lockSwipes=function(){h.params.allowSwipeToNext=h.params.allowSwipeToPrev=!1},h.unlockSwipeToNext=function(){h.params.allowSwipeToNext=!0},h.unlockSwipeToPrev=function(){h.params.allowSwipeToPrev=!0},h.unlockSwipes=function(){h.params.allowSwipeToNext=h.params.allowSwipeToPrev=!0},h.params.grabCursor&&(h.container[0].style.cursor="move",h.container[0].style.cursor="-webkit-grab",h.container[0].style.cursor="-moz-grab",h.container[0].style.cursor="grab"),h.imagesToLoad=[],h.imagesLoaded=0,h.loadImage=function(t,e,i,n){var a;function r(){n&&n()}t.complete&&i?r():e?((a=new window.Image).onload=r,a.onerror=r,a.src=e):r()},h.preloadImages=function(){function t(){null!=h&&(void 0!==h.imagesLoaded&&h.imagesLoaded++,h.imagesLoaded===h.imagesToLoad.length&&(h.params.updateOnImagesReady&&h.update(),h.emit("onImagesReady",h)))}h.imagesToLoad=h.container.find("img");for(var e=0;e<h.imagesToLoad.length;e++)h.loadImage(h.imagesToLoad[e],h.imagesToLoad[e].currentSrc||h.imagesToLoad[e].getAttribute("src"),!0,t)},h.autoplayTimeoutId=void 0,h.autoplaying=!1,h.autoplayPaused=!1,h.startAutoplay=function(){return void 0===h.autoplayTimeoutId&&(!!h.params.autoplay&&(!h.autoplaying&&(h.autoplaying=!0,h.emit("onAutoplayStart",h),void P())))},h.stopAutoplay=function(t){h.autoplayTimeoutId&&(h.autoplayTimeoutId&&clearTimeout(h.autoplayTimeoutId),h.autoplaying=!1,h.autoplayTimeoutId=void 0,h.emit("onAutoplayStop",h))},h.pauseAutoplay=function(t){h.autoplayPaused||(h.autoplayTimeoutId&&clearTimeout(h.autoplayTimeoutId),h.autoplayPaused=!0,0===t?(h.autoplayPaused=!1,P()):h.wrapper.transitionEnd((function(){h&&(h.autoplayPaused=!1,h.autoplaying?P():h.stopAutoplay())})))},h.minTranslate=function(){return-h.snapGrid[0]},h.maxTranslate=function(){return-h.snapGrid[h.snapGrid.length-1]},h.updateContainerSize=function(){var t,e;t=void 0!==h.params.width?h.params.width:h.container[0].clientWidth,e=void 0!==h.params.height?h.params.height:h.container[0].clientHeight,0===t&&E()||0===e&&!E()||(h.width=t,h.height=e,h.size=E()?h.width:h.height)},h.updateSlidesSize=function(){h.slides=h.wrapper.children("."+h.params.slideClass),h.snapGrid=[],h.slidesGrid=[],h.slidesSizesGrid=[];var t,e,i,n=h.params.spaceBetween,a=0,r=0,s=0;"string"==typeof n&&n.indexOf("%")>=0&&(n=parseFloat(n.replace("%",""))/100*h.size),h.virtualSize=-n,h.rtl?h.slides.css({marginLeft:"",marginTop:""}):h.slides.css({marginRight:"",marginBottom:""}),h.params.slidesPerColumn>1&&(e=Math.floor(h.slides.length/h.params.slidesPerColumn)===h.slides.length/h.params.slidesPerColumn?h.slides.length:Math.ceil(h.slides.length/h.params.slidesPerColumn)*h.params.slidesPerColumn);var o,l=h.params.slidesPerColumn,c=e/l,p=c-(h.params.slidesPerColumn*c-h.slides.length);for(t=0;t<h.slides.length;t++){i=0;var d,u,f,m=h.slides.eq(t);if(h.params.slidesPerColumn>1)"column"===h.params.slidesPerColumnFill?(f=t-(u=Math.floor(t/l))*l,(u>p||u===p&&f===l-1)&&++f>=l&&(f=0,u++),d=u+f*e/l,m.css({"-webkit-box-ordinal-group":d,"-moz-box-ordinal-group":d,"-ms-flex-order":d,"-webkit-order":d,order:d})):u=t-(f=Math.floor(t/c))*c,m.css({"margin-top":0!==f&&h.params.spaceBetween&&h.params.spaceBetween+"px"}).attr("data-swiper-column",u).attr("data-swiper-row",f);"none"!==m.css("display")&&("auto"===h.params.slidesPerView?i=E()?m.outerWidth(!0):m.outerHeight(!0):(i=(h.size-(h.params.slidesPerView-1)*n)/h.params.slidesPerView,E()?h.slides[t].style.width=i+"px":h.slides[t].style.height=i+"px"),h.slides[t].swiperSlideSize=i,h.slidesSizesGrid.push(i),h.params.centeredSlides?(a=a+i/2+r/2+n,0===t&&(a=a-h.size/2-n),Math.abs(a)<.001&&(a=0),s%h.params.slidesPerGroup==0&&h.snapGrid.push(a),h.slidesGrid.push(a)):(s%h.params.slidesPerGroup==0&&h.snapGrid.push(a),h.slidesGrid.push(a),a=a+i+n),h.virtualSize+=i+n,r=i,s++)}if(h.virtualSize=Math.max(h.virtualSize,h.size),h.rtl&&h.wrongRTL&&("slide"===h.params.effect||"coverflow"===h.params.effect)&&h.wrapper.css({width:h.virtualSize+h.params.spaceBetween+"px"}),h.support.flexbox&&!h.params.setWrapperSize||(E()?h.wrapper.css({width:h.virtualSize+h.params.spaceBetween+"px"}):h.wrapper.css({height:h.virtualSize+h.params.spaceBetween+"px"})),h.params.slidesPerColumn>1&&(h.virtualSize=(i+h.params.spaceBetween)*e,h.virtualSize=Math.ceil(h.virtualSize/h.params.slidesPerColumn)-h.params.spaceBetween,h.wrapper.css({width:h.virtualSize+h.params.spaceBetween+"px"}),h.params.centeredSlides)){for(o=[],t=0;t<h.snapGrid.length;t++)h.snapGrid[t]<h.virtualSize+h.snapGrid[0]&&o.push(h.snapGrid[t]);h.snapGrid=o}if(!h.params.centeredSlides){for(o=[],t=0;t<h.snapGrid.length;t++)h.snapGrid[t]<=h.virtualSize-h.size&&o.push(h.snapGrid[t]);h.snapGrid=o,Math.floor(h.virtualSize-h.size)>Math.floor(h.snapGrid[h.snapGrid.length-1])&&h.snapGrid.push(h.virtualSize-h.size)}0===h.snapGrid.length&&(h.snapGrid=[0]),0!==h.params.spaceBetween&&(E()?h.rtl?h.slides.css({marginLeft:n+"px"}):h.slides.css({marginRight:n+"px"}):h.slides.css({marginBottom:n+"px"})),h.params.watchSlidesProgress&&h.updateSlidesOffset()},h.updateSlidesOffset=function(){for(var t=0;t<h.slides.length;t++)h.slides[t].swiperSlideOffset=E()?h.slides[t].offsetLeft:h.slides[t].offsetTop},h.updateSlidesProgress=function(t){if(void 0===t&&(t=h.translate||0),0!==h.slides.length){void 0===h.slides[0].swiperSlideOffset&&h.updateSlidesOffset();var e=h.params.centeredSlides?-t+h.size/2:-t;h.rtl&&(e=h.params.centeredSlides?t-h.size/2:t);h.container[0].getBoundingClientRect(),E(),E();h.slides.removeClass(h.params.slideVisibleClass);for(var i=0;i<h.slides.length;i++){var n=h.slides[i],a=!0===h.params.centeredSlides?n.swiperSlideSize/2:0,r=(e-n.swiperSlideOffset-a)/(n.swiperSlideSize+h.params.spaceBetween);if(h.params.watchSlidesVisibility){var s=-(e-n.swiperSlideOffset-a),o=s+h.slidesSizesGrid[i];(s>=0&&s<h.size||o>0&&o<=h.size||s<=0&&o>=h.size)&&h.slides.eq(i).addClass(h.params.slideVisibleClass)}n.progress=h.rtl?-r:r}}},h.updateProgress=function(t){void 0===t&&(t=h.translate||0);var e=h.maxTranslate()-h.minTranslate();0===e?(h.progress=0,h.isBeginning=h.isEnd=!0):(h.progress=(t-h.minTranslate())/e,h.isBeginning=h.progress<=0,h.isEnd=h.progress>=1),h.isBeginning&&h.emit("onReachBeginning",h),h.isEnd&&h.emit("onReachEnd",h),h.params.watchSlidesProgress&&h.updateSlidesProgress(t),h.emit("onProgress",h,h.progress)},h.updateActiveIndex=function(){var t,e,i,n=h.rtl?h.translate:-h.translate;for(e=0;e<h.slidesGrid.length;e++)void 0!==h.slidesGrid[e+1]?n>=h.slidesGrid[e]&&n<h.slidesGrid[e+1]-(h.slidesGrid[e+1]-h.slidesGrid[e])/2?t=e:n>=h.slidesGrid[e]&&n<h.slidesGrid[e+1]&&(t=e+1):n>=h.slidesGrid[e]&&(t=e);(t<0||void 0===t)&&(t=0),(i=Math.floor(t/h.params.slidesPerGroup))>=h.snapGrid.length&&(i=h.snapGrid.length-1),t!==h.activeIndex&&(h.snapIndex=i,h.previousIndex=h.activeIndex,h.activeIndex=t,h.updateClasses())},h.updateClasses=function(){h.slides.removeClass(h.params.slideActiveClass+" "+h.params.slideNextClass+" "+h.params.slidePrevClass);var t,e=h.slides.eq(h.activeIndex);(e.addClass(h.params.slideActiveClass),e.next("."+h.params.slideClass).addClass(h.params.slideNextClass),e.prev("."+h.params.slideClass).addClass(h.params.slidePrevClass),h.bullets&&h.bullets.length>0)&&(h.bullets.removeClass(h.params.bulletActiveClass),h.params.loop?((t=Math.ceil(h.activeIndex-h.loopedSlides)/h.params.slidesPerGroup)>h.slides.length-1-2*h.loopedSlides&&(t-=h.slides.length-2*h.loopedSlides),t>h.bullets.length-1&&(t-=h.bullets.length)):t=void 0!==h.snapIndex?h.snapIndex:h.activeIndex||0,h.paginationContainer.length>1?h.bullets.each((function(){l(this).index()===t&&l(this).addClass(h.params.bulletActiveClass)})):h.bullets.eq(t).addClass(h.params.bulletActiveClass));h.params.loop||(h.params.prevButton&&(h.isBeginning?(l(h.params.prevButton).addClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.disable(l(h.params.prevButton))):(l(h.params.prevButton).removeClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.enable(l(h.params.prevButton)))),h.params.nextButton&&(h.isEnd?(l(h.params.nextButton).addClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.disable(l(h.params.nextButton))):(l(h.params.nextButton).removeClass(h.params.buttonDisabledClass),h.params.a11y&&h.a11y&&h.a11y.enable(l(h.params.nextButton)))))},h.updatePagination=function(){if(h.params.pagination&&h.paginationContainer&&h.paginationContainer.length>0){for(var t="",e=h.params.loop?Math.ceil((h.slides.length-2*h.loopedSlides)/h.params.slidesPerGroup):h.snapGrid.length,i=0;i<e;i++)h.params.paginationBulletRender?t+=h.params.paginationBulletRender(i,h.params.bulletClass):t+='<span class="'+h.params.bulletClass+'"></span>';h.paginationContainer.html(t),h.bullets=h.paginationContainer.find("."+h.params.bulletClass)}},h.update=function(t){function e(){i=Math.min(Math.max(h.translate,h.maxTranslate()),h.minTranslate()),h.setWrapperTranslate(i),h.updateActiveIndex(),h.updateClasses()}var i;(h.updateContainerSize(),h.updateSlidesSize(),h.updateProgress(),h.updatePagination(),h.updateClasses(),h.params.scrollbar&&h.scrollbar&&h.scrollbar.set(),t)&&(h.params.freeMode?e():("auto"===h.params.slidesPerView&&h.isEnd&&!h.params.centeredSlides?h.slideTo(h.slides.length-1,0,!1,!0):h.slideTo(h.activeIndex,0,!1,!0))||e())},h.onResize=function(t){if(h.updateContainerSize(),h.updateSlidesSize(),h.updateProgress(),("auto"===h.params.slidesPerView||h.params.freeMode||t)&&h.updatePagination(),h.params.scrollbar&&h.scrollbar&&h.scrollbar.set(),h.params.freeMode){var e=Math.min(Math.max(h.translate,h.maxTranslate()),h.minTranslate());h.setWrapperTranslate(e),h.updateActiveIndex(),h.updateClasses()}else h.updateClasses(),"auto"===h.params.slidesPerView&&h.isEnd&&!h.params.centeredSlides?h.slideTo(h.slides.length-1,0,!1,!0):h.slideTo(h.activeIndex,0,!1,!0)};var c=["mousedown","mousemove","mouseup"];window.navigator.pointerEnabled?c=["pointerdown","pointermove","pointerup"]:window.navigator.msPointerEnabled&&(c=["MSPointerDown","MSPointerMove","MSPointerUp"]),h.touchEvents={start:h.support.touch||!h.params.simulateTouch?"touchstart":c[0],move:h.support.touch||!h.params.simulateTouch?"touchmove":c[1],end:h.support.touch||!h.params.simulateTouch?"touchend":c[2]},(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&("container"===h.params.touchEventsTarget?h.container:h.wrapper).addClass("swiper-wp8-"+h.params.direction),h.initEvents=function(t){var i=t?"off":"on",n=t?"removeEventListener":"addEventListener",a="container"===h.params.touchEventsTarget?h.container[0]:h.wrapper[0],r=h.support.touch?a:document,s=!!h.params.nested;h.browser.ie?(a[n](h.touchEvents.start,h.onTouchStart,!1),r[n](h.touchEvents.move,h.onTouchMove,s),r[n](h.touchEvents.end,h.onTouchEnd,!1)):(h.support.touch&&(a[n](h.touchEvents.start,h.onTouchStart,!1),a[n](h.touchEvents.move,h.onTouchMove,s),a[n](h.touchEvents.end,h.onTouchEnd,!1)),!e.simulateTouch||h.device.ios||h.device.android||(a[n]("mousedown",h.onTouchStart,!1),document[n]("mousemove",h.onTouchMove,s),document[n]("mouseup",h.onTouchEnd,!1))),window[n]("resize",h.onResize),h.params.nextButton&&(l(h.params.nextButton)[i]("click",h.onClickNext),h.params.a11y&&h.a11y&&l(h.params.nextButton)[i]("keydown",h.a11y.onEnterKey)),h.params.prevButton&&(l(h.params.prevButton)[i]("click",h.onClickPrev),h.params.a11y&&h.a11y&&l(h.params.prevButton)[i]("keydown",h.a11y.onEnterKey)),h.params.pagination&&h.params.paginationClickable&&l(h.paginationContainer)[i]("click","."+h.params.bulletClass,h.onClickIndex),(h.params.preventClicks||h.params.preventClicksPropagation)&&a[n]("click",h.preventClicks,!0)},h.attachEvents=function(t){h.initEvents()},h.detachEvents=function(){h.initEvents(!0)},h.allowClick=!0,h.preventClicks=function(t){h.allowClick||(h.params.preventClicks&&t.preventDefault(),h.params.preventClicksPropagation&&h.animating&&(t.stopPropagation(),t.stopImmediatePropagation()))},h.onClickNext=function(t){t.preventDefault(),h.slideNext()},h.onClickPrev=function(t){t.preventDefault(),h.slidePrev()},h.onClickIndex=function(t){t.preventDefault();var e=l(this).index()*h.params.slidesPerGroup;h.params.loop&&(e+=h.loopedSlides),h.slideTo(e)},h.updateClickedSlide=function(t){var e=L(t,"."+h.params.slideClass),i=!1;if(e)for(var n=0;n<h.slides.length;n++)h.slides[n]===e&&(i=!0);if(!e||!i)return h.clickedSlide=void 0,void(h.clickedIndex=void 0);if(h.clickedSlide=e,h.clickedIndex=l(e).index(),h.params.slideToClickedSlide&&void 0!==h.clickedIndex&&h.clickedIndex!==h.activeIndex){var a,r=h.clickedIndex;if(h.params.loop)if(a=l(h.clickedSlide).attr("data-swiper-slide-index"),r>h.slides.length-h.params.slidesPerView)h.fixLoop(),r=h.wrapper.children("."+h.params.slideClass+'[data-swiper-slide-index="'+a+'"]').eq(0).index(),setTimeout((function(){h.slideTo(r)}),0);else if(r<h.params.slidesPerView-1){h.fixLoop();var s=h.wrapper.children("."+h.params.slideClass+'[data-swiper-slide-index="'+a+'"]');r=s.eq(s.length-1).index(),setTimeout((function(){h.slideTo(r)}),0)}else h.slideTo(r);else h.slideTo(r)}};var p,d,u,f,m,g,v,w,x,y,b,S="input, select, textarea, button",M=Date.now(),T=[];if(h.animating=!1,h.touches={startX:0,startY:0,currentX:0,currentY:0,diff:0},h.onTouchStart=function(t){if(t.originalEvent&&(t=t.originalEvent),(y="touchstart"===t.type)||!("which"in t)||3!==t.which)if(h.params.noSwiping&&L(t,"."+h.params.noSwipingClass))h.allowClick=!0;else if(!h.params.swipeHandler||L(t,h.params.swipeHandler)){if(p=!0,d=!1,f=void 0,b=void 0,h.touches.startX=h.touches.currentX="touchstart"===t.type?t.targetTouches[0].pageX:t.pageX,h.touches.startY=h.touches.currentY="touchstart"===t.type?t.targetTouches[0].pageY:t.pageY,u=Date.now(),h.allowClick=!0,h.updateContainerSize(),h.swipeDirection=void 0,h.params.threshold>0&&(v=!1),"touchstart"!==t.type){var e=!0;l(t.target).is(S)&&(e=!1),document.activeElement&&l(document.activeElement).is(S)&&document.activeElement.blur(),e&&t.preventDefault()}h.emit("onTouchStart",h,t)}},h.onTouchMove=function(t){if(t.originalEvent&&(t=t.originalEvent),!(y&&"mousemove"===t.type||t.preventedByNestedSwiper)){if(h.params.onlyExternal)return d=!0,void(h.allowClick=!1);if(y&&document.activeElement&&t.target===document.activeElement&&l(t.target).is(S))return d=!0,void(h.allowClick=!1);if(h.emit("onTouchMove",h,t),!(t.targetTouches&&t.targetTouches.length>1)){if(h.touches.currentX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,h.touches.currentY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,void 0===f){var i=180*Math.atan2(Math.abs(h.touches.currentY-h.touches.startY),Math.abs(h.touches.currentX-h.touches.startX))/Math.PI;f=E()?i>h.params.touchAngle:90-i>h.params.touchAngle}if(f&&h.emit("onTouchMoveOpposite",h,t),void 0===b&&h.browser.ieTouch&&(h.touches.currentX===h.touches.startX&&h.touches.currentY===h.touches.startY||(b=!0)),p)if(f)p=!1;else if(b||!h.browser.ieTouch){h.allowClick=!1,h.emit("onSliderMove",h,t),t.preventDefault(),h.params.touchMoveStopPropagation&&!h.params.nested&&t.stopPropagation(),d||(e.loop&&h.fixLoop(),g=h.getWrapperTranslate(),h.setWrapperTransition(0),h.animating&&h.wrapper.trigger("webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd msTransitionEnd"),h.params.autoplay&&h.autoplaying&&(h.params.autoplayDisableOnInteraction?h.stopAutoplay():h.pauseAutoplay()),x=!1,h.params.grabCursor&&(h.container[0].style.cursor="move",h.container[0].style.cursor="-webkit-grabbing",h.container[0].style.cursor="-moz-grabbin",h.container[0].style.cursor="grabbing")),d=!0;var n=h.touches.diff=E()?h.touches.currentX-h.touches.startX:h.touches.currentY-h.touches.startY;n*=h.params.touchRatio,h.rtl&&(n=-n),h.swipeDirection=n>0?"prev":"next",m=n+g;var a=!0;if(n>0&&m>h.minTranslate()?(a=!1,h.params.resistance&&(m=h.minTranslate()-1+Math.pow(-h.minTranslate()+g+n,h.params.resistanceRatio))):n<0&&m<h.maxTranslate()&&(a=!1,h.params.resistance&&(m=h.maxTranslate()+1-Math.pow(h.maxTranslate()-g-n,h.params.resistanceRatio))),a&&(t.preventedByNestedSwiper=!0),!h.params.allowSwipeToNext&&"next"===h.swipeDirection&&m<g&&(m=g),!h.params.allowSwipeToPrev&&"prev"===h.swipeDirection&&m>g&&(m=g),h.params.followFinger){if(h.params.threshold>0){if(!(Math.abs(n)>h.params.threshold||v))return void(m=g);if(!v)return v=!0,h.touches.startX=h.touches.currentX,h.touches.startY=h.touches.currentY,m=g,void(h.touches.diff=E()?h.touches.currentX-h.touches.startX:h.touches.currentY-h.touches.startY)}(h.params.freeMode||h.params.watchSlidesProgress)&&h.updateActiveIndex(),h.params.freeMode&&(0===T.length&&T.push({position:h.touches[E()?"startX":"startY"],time:u}),T.push({position:h.touches[E()?"currentX":"currentY"],time:(new window.Date).getTime()})),h.updateProgress(m),h.setWrapperTranslate(m)}}}}},h.onTouchEnd=function(t){if(t.originalEvent&&(t=t.originalEvent),h.emit("onTouchEnd",h,t),p){h.params.grabCursor&&d&&p&&(h.container[0].style.cursor="move",h.container[0].style.cursor="-webkit-grab",h.container[0].style.cursor="-moz-grab",h.container[0].style.cursor="grab");var e,i=Date.now(),n=i-u;if(h.allowClick&&(h.updateClickedSlide(t),h.emit("onTap",h,t),n<300&&i-M>300&&(w&&clearTimeout(w),w=setTimeout((function(){h&&(h.params.paginationHide&&h.paginationContainer.length>0&&!l(t.target).hasClass(h.params.bulletClass)&&h.paginationContainer.toggleClass(h.params.paginationHiddenClass),h.emit("onClick",h,t))}),300)),n<300&&i-M<300&&(w&&clearTimeout(w),h.emit("onDoubleTap",h,t))),M=Date.now(),setTimeout((function(){h&&(h.allowClick=!0)}),0),p&&d&&h.swipeDirection&&0!==h.touches.diff&&m!==g)if(p=d=!1,e=h.params.followFinger?h.rtl?h.translate:-h.translate:-m,h.params.freeMode){if(e<-h.minTranslate())return void h.slideTo(h.activeIndex);if(e>-h.maxTranslate())return void(h.slides.length<h.snapGrid.length?h.slideTo(h.snapGrid.length-1):h.slideTo(h.slides.length-1));if(h.params.freeModeMomentum){if(T.length>1){var a=T.pop(),r=T.pop(),s=a.position-r.position,o=a.time-r.time;h.velocity=s/o,h.velocity=h.velocity/2,Math.abs(h.velocity)<.02&&(h.velocity=0),(o>150||(new window.Date).getTime()-a.time>300)&&(h.velocity=0)}else h.velocity=0;T.length=0;var c=1e3*h.params.freeModeMomentumRatio,f=h.velocity*c,v=h.translate+f;h.rtl&&(v=-v);var y,b=!1,S=20*Math.abs(h.velocity)*h.params.freeModeMomentumBounceRatio;if(v<h.maxTranslate())h.params.freeModeMomentumBounce?(v+h.maxTranslate()<-S&&(v=h.maxTranslate()-S),y=h.maxTranslate(),b=!0,x=!0):v=h.maxTranslate();else if(v>h.minTranslate())h.params.freeModeMomentumBounce?(v-h.minTranslate()>S&&(v=h.minTranslate()+S),y=h.minTranslate(),b=!0,x=!0):v=h.minTranslate();else if(h.params.freeModeSticky){var C,z=0;for(z=0;z<h.snapGrid.length;z+=1)if(h.snapGrid[z]>-v){C=z;break}v=Math.abs(h.snapGrid[C]-v)<Math.abs(h.snapGrid[C-1]-v)||"next"===h.swipeDirection?h.snapGrid[C]:h.snapGrid[C-1],h.rtl||(v=-v)}if(0!==h.velocity)c=h.rtl?Math.abs((-v-h.translate)/h.velocity):Math.abs((v-h.translate)/h.velocity);else if(h.params.freeModeSticky)return void h.slideReset();h.params.freeModeMomentumBounce&&b?(h.updateProgress(y),h.setWrapperTransition(c),h.setWrapperTranslate(v),h.onTransitionStart(),h.animating=!0,h.wrapper.transitionEnd((function(){h&&x&&(h.emit("onMomentumBounce",h),h.setWrapperTransition(h.params.speed),h.setWrapperTranslate(y),h.wrapper.transitionEnd((function(){h&&h.onTransitionEnd()})))}))):h.velocity?(h.updateProgress(v),h.setWrapperTransition(c),h.setWrapperTranslate(v),h.onTransitionStart(),h.animating||(h.animating=!0,h.wrapper.transitionEnd((function(){h&&h.onTransitionEnd()})))):h.updateProgress(v),h.updateActiveIndex()}(!h.params.freeModeMomentum||n>=h.params.longSwipesMs)&&(h.updateProgress(),h.updateActiveIndex())}else{var E,P=0,L=h.slidesSizesGrid[0];for(E=0;E<h.slidesGrid.length;E+=h.params.slidesPerGroup)void 0!==h.slidesGrid[E+h.params.slidesPerGroup]?e>=h.slidesGrid[E]&&e<h.slidesGrid[E+h.params.slidesPerGroup]&&(P=E,L=h.slidesGrid[E+h.params.slidesPerGroup]-h.slidesGrid[E]):e>=h.slidesGrid[E]&&(P=E,L=h.slidesGrid[h.slidesGrid.length-1]-h.slidesGrid[h.slidesGrid.length-2]);var k=(e-h.slidesGrid[P])/L;if(n>h.params.longSwipesMs){if(!h.params.longSwipes)return void h.slideTo(h.activeIndex);"next"===h.swipeDirection&&(k>=h.params.longSwipesRatio?h.slideTo(P+h.params.slidesPerGroup):h.slideTo(P)),"prev"===h.swipeDirection&&(k>1-h.params.longSwipesRatio?h.slideTo(P+h.params.slidesPerGroup):h.slideTo(P))}else{if(!h.params.shortSwipes)return void h.slideTo(h.activeIndex);"next"===h.swipeDirection&&h.slideTo(P+h.params.slidesPerGroup),"prev"===h.swipeDirection&&h.slideTo(P)}}else p=d=!1}},h._slideTo=function(t,e){return h.slideTo(t,e,!0,!0)},h.slideTo=function(t,e,i,n){void 0===i&&(i=!0),void 0===t&&(t=0),t<0&&(t=0),h.snapIndex=Math.floor(t/h.params.slidesPerGroup),h.snapIndex>=h.snapGrid.length&&(h.snapIndex=h.snapGrid.length-1);var a=-h.snapGrid[h.snapIndex];if(!h.params.allowSwipeToNext&&a<h.translate&&a<h.minTranslate())return!1;if(!h.params.allowSwipeToPrev&&a>h.translate&&a>h.maxTranslate())return!1;h.params.autoplay&&h.autoplaying&&(n||!h.params.autoplayDisableOnInteraction?h.pauseAutoplay(e):h.stopAutoplay()),h.updateProgress(a);for(var r=0;r<h.slidesGrid.length;r++)-a>=h.slidesGrid[r]&&(t=r);if(void 0===e&&(e=h.params.speed),h.previousIndex=h.activeIndex||0,h.activeIndex=t,a===h.translate)return h.updateClasses(),!1;h.updateClasses(),h.onTransitionStart(i);E(),E();return 0===e?(h.setWrapperTransition(0),h.setWrapperTranslate(a),h.onTransitionEnd(i)):(h.setWrapperTransition(e),h.setWrapperTranslate(a),h.animating||(h.animating=!0,h.wrapper.transitionEnd((function(){h&&h.onTransitionEnd(i)})))),!0},h.onTransitionStart=function(t){void 0===t&&(t=!0),h.lazy&&h.lazy.onTransitionStart(),t&&(h.emit("onTransitionStart",h),h.activeIndex!==h.previousIndex&&h.emit("onSlideChangeStart",h))},h.onTransitionEnd=function(t){h.animating=!1,h.setWrapperTransition(0),void 0===t&&(t=!0),h.lazy&&h.lazy.onTransitionEnd(),t&&(h.emit("onTransitionEnd",h),h.activeIndex!==h.previousIndex&&h.emit("onSlideChangeEnd",h)),h.params.hashnav&&h.hashnav&&h.hashnav.setHash()},h.slideNext=function(t,e,i){if(h.params.loop){if(h.animating)return!1;h.fixLoop();h.container[0].clientLeft;return h.slideTo(h.activeIndex+h.params.slidesPerGroup,e,t,i)}return h.slideTo(h.activeIndex+h.params.slidesPerGroup,e,t,i)},h._slideNext=function(t){return h.slideNext(!0,t,!0)},h.slidePrev=function(t,e,i){if(h.params.loop){if(h.animating)return!1;h.fixLoop();h.container[0].clientLeft;return h.slideTo(h.activeIndex-1,e,t,i)}return h.slideTo(h.activeIndex-1,e,t,i)},h._slidePrev=function(t){return h.slidePrev(!0,t,!0)},h.slideReset=function(t,e,i){return h.slideTo(h.activeIndex,e,t)},h.setWrapperTransition=function(t,e){h.wrapper.transition(t),"slide"!==h.params.effect&&h.effects[h.params.effect]&&h.effects[h.params.effect].setTransition(t),h.params.parallax&&h.parallax&&h.parallax.setTransition(t),h.params.scrollbar&&h.scrollbar&&h.scrollbar.setTransition(t),h.params.control&&h.controller&&h.controller.setTransition(t,e),h.emit("onSetTransition",h,t)},h.setWrapperTranslate=function(t,e,i){var n=0,a=0;E()?n=h.rtl?-t:t:a=t,h.params.virtualTranslate||(h.support.transforms3d?h.wrapper.transform("translate3d("+n+"px, "+a+"px, 0px)"):h.wrapper.transform("translate("+n+"px, "+a+"px)")),h.translate=E()?n:a,e&&h.updateActiveIndex(),"slide"!==h.params.effect&&h.effects[h.params.effect]&&h.effects[h.params.effect].setTranslate(h.translate),h.params.parallax&&h.parallax&&h.parallax.setTranslate(h.translate),h.params.scrollbar&&h.scrollbar&&h.scrollbar.setTranslate(h.translate),h.params.control&&h.controller&&h.controller.setTranslate(h.translate,i),h.emit("onSetTranslate",h,h.translate)},h.getTranslate=function(t,e){var i,n,a,r;return void 0===e&&(e="x"),h.params.virtualTranslate?h.rtl?-h.translate:h.translate:(a=window.getComputedStyle(t,null),window.WebKitCSSMatrix?r=new window.WebKitCSSMatrix("none"===a.webkitTransform?"":a.webkitTransform):i=(r=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===e&&(n=window.WebKitCSSMatrix?r.m41:16===i.length?parseFloat(i[12]):parseFloat(i[4])),"y"===e&&(n=window.WebKitCSSMatrix?r.m42:16===i.length?parseFloat(i[13]):parseFloat(i[5])),h.rtl&&n&&(n=-n),n||0)},h.getWrapperTranslate=function(t){return void 0===t&&(t=E()?"x":"y"),h.getTranslate(h.wrapper[0],t)},h.observers=[],h.initObservers=function(){if(h.params.observeParents)for(var t=h.container.parents(),e=0;e<t.length;e++)k(t[e]);k(h.container[0],{childList:!1}),k(h.wrapper[0],{attributes:!1})},h.disconnectObservers=function(){for(var t=0;t<h.observers.length;t++)h.observers[t].disconnect();h.observers=[]},h.createLoop=function(){h.wrapper.children("."+h.params.slideClass+"."+h.params.slideDuplicateClass).remove();var t=h.wrapper.children("."+h.params.slideClass);h.loopedSlides=parseInt(h.params.loopedSlides||h.params.slidesPerView,10),h.loopedSlides=h.loopedSlides+h.params.loopAdditionalSlides,h.loopedSlides>t.length&&(h.loopedSlides=t.length);var e,i=[],n=[];for(t.each((function(e,a){var r=l(this);e<h.loopedSlides&&n.push(a),e<t.length&&e>=t.length-h.loopedSlides&&i.push(a),r.attr("data-swiper-slide-index",e)})),e=0;e<n.length;e++)h.wrapper.append(l(n[e].cloneNode(!0)).addClass(h.params.slideDuplicateClass));for(e=i.length-1;e>=0;e--)h.wrapper.prepend(l(i[e].cloneNode(!0)).addClass(h.params.slideDuplicateClass))},h.destroyLoop=function(){h.wrapper.children("."+h.params.slideClass+"."+h.params.slideDuplicateClass).remove(),h.slides.removeAttr("data-swiper-slide-index")},h.fixLoop=function(){var t;h.activeIndex<h.loopedSlides?(t=h.slides.length-3*h.loopedSlides+h.activeIndex,t+=h.loopedSlides,h.slideTo(t,0,!1,!0)):("auto"===h.params.slidesPerView&&h.activeIndex>=2*h.loopedSlides||h.activeIndex>h.slides.length-2*h.params.slidesPerView)&&(t=-h.slides.length+h.activeIndex+h.loopedSlides,t+=h.loopedSlides,h.slideTo(t,0,!1,!0))},h.appendSlide=function(t){if(h.params.loop&&h.destroyLoop(),"object"==typeof t&&t.length)for(var e=0;e<t.length;e++)t[e]&&h.wrapper.append(t[e]);else h.wrapper.append(t);h.params.loop&&h.createLoop(),h.params.observer&&h.support.observer||h.update(!0)},h.prependSlide=function(t){h.params.loop&&h.destroyLoop();var e=h.activeIndex+1;if("object"==typeof t&&t.length){for(var i=0;i<t.length;i++)t[i]&&h.wrapper.prepend(t[i]);e=h.activeIndex+t.length}else h.wrapper.prepend(t);h.params.loop&&h.createLoop(),h.params.observer&&h.support.observer||h.update(!0),h.slideTo(e,0,!1)},h.removeSlide=function(t){h.params.loop&&(h.destroyLoop(),h.slides=h.wrapper.children("."+h.params.slideClass));var e,i=h.activeIndex;if("object"==typeof t&&t.length){for(var n=0;n<t.length;n++)e=t[n],h.slides[e]&&h.slides.eq(e).remove(),e<i&&i--;i=Math.max(i,0)}else e=t,h.slides[e]&&h.slides.eq(e).remove(),e<i&&i--,i=Math.max(i,0);h.params.loop&&h.createLoop(),h.params.observer&&h.support.observer||h.update(!0),h.params.loop?h.slideTo(i+h.loopedSlides,0,!1):h.slideTo(i,0,!1)},h.removeAllSlides=function(){for(var t=[],e=0;e<h.slides.length;e++)t.push(e);h.removeSlide(t)},h.effects={fade:{setTranslate:function(){for(var t=0;t<h.slides.length;t++){var e=h.slides.eq(t),i=-e[0].swiperSlideOffset;h.params.virtualTranslate||(i-=h.translate);var n=0;E()||(n=i,i=0);var a=h.params.fade.crossFade?Math.max(1-Math.abs(e[0].progress),0):1+Math.min(Math.max(e[0].progress,-1),0);e.css({opacity:a}).transform("translate3d("+i+"px, "+n+"px, 0px)")}},setTransition:function(t){if(h.slides.transition(t),h.params.virtualTranslate&&0!==t){var e=!1;h.slides.transitionEnd((function(){if(!e&&h){e=!0,h.animating=!1;for(var t=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],i=0;i<t.length;i++)h.wrapper.trigger(t[i])}}))}}},cube:{setTranslate:function(){var t,e=0;h.params.cube.shadow&&(E()?(0===(t=h.wrapper.find(".swiper-cube-shadow")).length&&(t=l('<div class="swiper-cube-shadow"></div>'),h.wrapper.append(t)),t.css({height:h.width+"px"})):0===(t=h.container.find(".swiper-cube-shadow")).length&&(t=l('<div class="swiper-cube-shadow"></div>'),h.container.append(t)));for(var i=0;i<h.slides.length;i++){var n=h.slides.eq(i),a=90*i,r=Math.floor(a/360);h.rtl&&(a=-a,r=Math.floor(-a/360));var s=Math.max(Math.min(n[0].progress,1),-1),o=0,c=0,p=0;i%4==0?(o=4*-r*h.size,p=0):(i-1)%4==0?(o=0,p=4*-r*h.size):(i-2)%4==0?(o=h.size+4*r*h.size,p=h.size):(i-3)%4==0&&(o=-h.size,p=3*h.size+4*h.size*r),h.rtl&&(o=-o),E()||(c=o,o=0);var d="rotateX("+(E()?0:-a)+"deg) rotateY("+(E()?a:0)+"deg) translate3d("+o+"px, "+c+"px, "+p+"px)";if(s<=1&&s>-1&&(e=90*i+90*s,h.rtl&&(e=90*-i-90*s)),n.transform(d),h.params.cube.slideShadows){var u=E()?n.find(".swiper-slide-shadow-left"):n.find(".swiper-slide-shadow-top"),f=E()?n.find(".swiper-slide-shadow-right"):n.find(".swiper-slide-shadow-bottom");0===u.length&&(u=l('<div class="swiper-slide-shadow-'+(E()?"left":"top")+'"></div>'),n.append(u)),0===f.length&&(f=l('<div class="swiper-slide-shadow-'+(E()?"right":"bottom")+'"></div>'),n.append(f));n[0].progress;u.length&&(u[0].style.opacity=-n[0].progress),f.length&&(f[0].style.opacity=n[0].progress)}}if(h.wrapper.css({"-webkit-transform-origin":"50% 50% -"+h.size/2+"px","-moz-transform-origin":"50% 50% -"+h.size/2+"px","-ms-transform-origin":"50% 50% -"+h.size/2+"px","transform-origin":"50% 50% -"+h.size/2+"px"}),h.params.cube.shadow)if(E())t.transform("translate3d(0px, "+(h.width/2+h.params.cube.shadowOffset)+"px, "+-h.width/2+"px) rotateX(90deg) rotateZ(0deg) scale("+h.params.cube.shadowScale+")");else{var m=Math.abs(e)-90*Math.floor(Math.abs(e)/90),g=1.5-(Math.sin(2*m*Math.PI/360)/2+Math.cos(2*m*Math.PI/360)/2),v=h.params.cube.shadowScale,w=h.params.cube.shadowScale/g,x=h.params.cube.shadowOffset;t.transform("scale3d("+v+", 1, "+w+") translate3d(0px, "+(h.height/2+x)+"px, "+-h.height/2/w+"px) rotateX(-90deg)")}var y=h.isSafari||h.isUiWebView?-h.size/2:0;h.wrapper.transform("translate3d(0px,0,"+y+"px) rotateX("+(E()?0:e)+"deg) rotateY("+(E()?-e:0)+"deg)")},setTransition:function(t){h.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),h.params.cube.shadow&&!E()&&h.container.find(".swiper-cube-shadow").transition(t)}},coverflow:{setTranslate:function(){for(var t=h.translate,e=E()?-t+h.width/2:-t+h.height/2,i=E()?h.params.coverflow.rotate:-h.params.coverflow.rotate,n=h.params.coverflow.depth,a=0,r=h.slides.length;a<r;a++){var s=h.slides.eq(a),o=h.slidesSizesGrid[a],c=(e-s[0].swiperSlideOffset-o/2)/o*h.params.coverflow.modifier,p=E()?i*c:0,d=E()?0:i*c,u=-n*Math.abs(c),f=E()?0:h.params.coverflow.stretch*c,m=E()?h.params.coverflow.stretch*c:0;Math.abs(m)<.001&&(m=0),Math.abs(f)<.001&&(f=0),Math.abs(u)<.001&&(u=0),Math.abs(p)<.001&&(p=0),Math.abs(d)<.001&&(d=0);var g="translate3d("+m+"px,"+f+"px,"+u+"px)  rotateX("+d+"deg) rotateY("+p+"deg)";if(s.transform(g),s[0].style.zIndex=1-Math.abs(Math.round(c)),h.params.coverflow.slideShadows){var v=E()?s.find(".swiper-slide-shadow-left"):s.find(".swiper-slide-shadow-top"),w=E()?s.find(".swiper-slide-shadow-right"):s.find(".swiper-slide-shadow-bottom");0===v.length&&(v=l('<div class="swiper-slide-shadow-'+(E()?"left":"top")+'"></div>'),s.append(v)),0===w.length&&(w=l('<div class="swiper-slide-shadow-'+(E()?"right":"bottom")+'"></div>'),s.append(w)),v.length&&(v[0].style.opacity=c>0?c:0),w.length&&(w[0].style.opacity=-c>0?-c:0)}}h.browser.ie&&(h.wrapper[0].style.perspectiveOrigin=e+"px 50%")},setTransition:function(t){h.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t)}}},h.lazy={initialImageLoaded:!1,loadImageInSlide:function(t,e){if(void 0!==t&&(void 0===e&&(e=!0),0!==h.slides.length)){var i=h.slides.eq(t),n=i.find(".swiper-lazy:not(.swiper-lazy-loaded):not(.swiper-lazy-loading)");!i.hasClass("swiper-lazy")||i.hasClass("swiper-lazy-loaded")||i.hasClass("swiper-lazy-loading")||n.add(i[0]),0!==n.length&&n.each((function(){var t=l(this);t.addClass("swiper-lazy-loading");var n=t.attr("data-background"),a=t.attr("data-src");h.loadImage(t[0],a||n,!1,(function(){if(n?(t.css("background-image","url("+n+")"),t.removeAttr("data-background")):(t.attr("src",a),t.removeAttr("data-src")),t.addClass("swiper-lazy-loaded").removeClass("swiper-lazy-loading"),i.find(".swiper-lazy-preloader, .preloader").remove(),h.params.loop&&e){var r=i.attr("data-swiper-slide-index");if(i.hasClass(h.params.slideDuplicateClass)){var s=h.wrapper.children('[data-swiper-slide-index="'+r+'"]:not(.'+h.params.slideDuplicateClass+")");h.lazy.loadImageInSlide(s.index(),!1)}else{var o=h.wrapper.children("."+h.params.slideDuplicateClass+'[data-swiper-slide-index="'+r+'"]');h.lazy.loadImageInSlide(o.index(),!1)}}h.emit("onLazyImageReady",h,i[0],t[0])})),h.emit("onLazyImageLoad",h,i[0],t[0])}))}},load:function(){var t;if(h.params.watchSlidesVisibility)h.wrapper.children("."+h.params.slideVisibleClass).each((function(){h.lazy.loadImageInSlide(l(this).index())}));else if(h.params.slidesPerView>1)for(t=h.activeIndex;t<h.activeIndex+h.params.slidesPerView;t++)h.slides[t]&&h.lazy.loadImageInSlide(t);else h.lazy.loadImageInSlide(h.activeIndex);if(h.params.lazyLoadingInPrevNext)if(h.params.slidesPerView>1){for(t=h.activeIndex+h.params.slidesPerView;t<h.activeIndex+h.params.slidesPerView+h.params.slidesPerView;t++)h.slides[t]&&h.lazy.loadImageInSlide(t);for(t=h.activeIndex-h.params.slidesPerView;t<h.activeIndex;t++)h.slides[t]&&h.lazy.loadImageInSlide(t)}else{var e=h.wrapper.children("."+h.params.slideNextClass);e.length>0&&h.lazy.loadImageInSlide(e.index());var i=h.wrapper.children("."+h.params.slidePrevClass);i.length>0&&h.lazy.loadImageInSlide(i.index())}},onTransitionStart:function(){h.params.lazyLoading&&(h.params.lazyLoadingOnTransitionStart||!h.params.lazyLoadingOnTransitionStart&&!h.lazy.initialImageLoaded)&&h.lazy.load()},onTransitionEnd:function(){h.params.lazyLoading&&!h.params.lazyLoadingOnTransitionStart&&h.lazy.load()}},h.scrollbar={set:function(){if(h.params.scrollbar){var t=h.scrollbar;t.track=l(h.params.scrollbar),t.drag=t.track.find(".swiper-scrollbar-drag"),0===t.drag.length&&(t.drag=l('<div class="swiper-scrollbar-drag"></div>'),t.track.append(t.drag)),t.drag[0].style.width="",t.drag[0].style.height="",t.trackSize=E()?t.track[0].offsetWidth:t.track[0].offsetHeight,t.divider=h.size/h.virtualSize,t.moveDivider=t.divider*(t.trackSize/h.size),t.dragSize=t.trackSize*t.divider,E()?t.drag[0].style.width=t.dragSize+"px":t.drag[0].style.height=t.dragSize+"px",t.divider>=1?t.track[0].style.display="none":t.track[0].style.display="",h.params.scrollbarHide&&(t.track[0].style.opacity=0)}},setTranslate:function(){if(h.params.scrollbar){var t,e=h.scrollbar,i=(h.translate,e.dragSize);t=(e.trackSize-e.dragSize)*h.progress,h.rtl&&E()?(t=-t)>0?(i=e.dragSize-t,t=0):-t+e.dragSize>e.trackSize&&(i=e.trackSize+t):t<0?(i=e.dragSize+t,t=0):t+e.dragSize>e.trackSize&&(i=e.trackSize-t),E()?(h.support.transforms3d?e.drag.transform("translate3d("+t+"px, 0, 0)"):e.drag.transform("translateX("+t+"px)"),e.drag[0].style.width=i+"px"):(h.support.transforms3d?e.drag.transform("translate3d(0px, "+t+"px, 0)"):e.drag.transform("translateY("+t+"px)"),e.drag[0].style.height=i+"px"),h.params.scrollbarHide&&(clearTimeout(e.timeout),e.track[0].style.opacity=1,e.timeout=setTimeout((function(){e.track[0].style.opacity=0,e.track.transition(400)}),1e3))}},setTransition:function(t){h.params.scrollbar&&h.scrollbar.drag.transition(t)}},h.controller={setTranslate:function(t,e){var i,n,a=h.params.control;function s(e){t=e.rtl&&"horizontal"===e.params.direction?-h.translate:h.translate,i=(e.maxTranslate()-e.minTranslate())/(h.maxTranslate()-h.minTranslate()),n=(t-h.minTranslate())*i+e.minTranslate(),h.params.controlInverse&&(n=e.maxTranslate()-n),e.updateProgress(n),e.setWrapperTranslate(n,!1,h),e.updateActiveIndex()}if(h.isArray(a))for(var o=0;o<a.length;o++)a[o]!==e&&a[o]instanceof r&&s(a[o]);else a instanceof r&&e!==a&&s(a)},setTransition:function(t,e){var i,n=h.params.control;function a(e){e.setWrapperTransition(t,h),0!==t&&(e.onTransitionStart(),e.wrapper.transitionEnd((function(){n&&e.onTransitionEnd()})))}if(h.isArray(n))for(i=0;i<n.length;i++)n[i]!==e&&n[i]instanceof r&&a(n[i]);else n instanceof r&&e!==n&&a(n)}},h.hashnav={init:function(){if(h.params.hashnav){h.hashnav.initialized=!0;var t=document.location.hash.replace("#","");if(t)for(var e=0,i=h.slides.length;e<i;e++){var n=h.slides.eq(e);if(n.attr("data-hash")===t&&!n.hasClass(h.params.slideDuplicateClass)){var a=n.index();h.slideTo(a,0,h.params.runCallbacksOnInit,!0)}}}},setHash:function(){h.hashnav.initialized&&h.params.hashnav&&(document.location.hash=h.slides.eq(h.activeIndex).attr("data-hash")||"")}},h.disableKeyboardControl=function(){l(document).off("keydown",V)},h.enableKeyboardControl=function(){l(document).on("keydown",V)},h.mousewheel={event:!1,lastScrollTime:(new window.Date).getTime()},h.params.mousewheelControl){if(void 0!==document.onmousewheel&&(h.mousewheel.event="mousewheel"),!h.mousewheel.event)try{new window.WheelEvent("wheel"),h.mousewheel.event="wheel"}catch(t){}h.mousewheel.event||(h.mousewheel.event="DOMMouseScroll")}for(var C in h.disableMousewheelControl=function(){return!!h.mousewheel.event&&(h.container.off(h.mousewheel.event,I),!0)},h.enableMousewheelControl=function(){return!!h.mousewheel.event&&(h.container.on(h.mousewheel.event,I),!0)},h.parallax={setTranslate:function(){h.container.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each((function(){R(this,h.progress)})),h.slides.each((function(){var t=l(this);t.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each((function(){R(this,Math.min(Math.max(t[0].progress,-1),1))}))}))},setTransition:function(t){void 0===t&&(t=h.params.speed),h.container.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each((function(){var e=l(this),i=parseInt(e.attr("data-swiper-parallax-duration"),10)||t;0===t&&(i=0),e.transition(i)}))}},h._plugins=[],h.plugins){var z=h.plugins[C](h,h.params[C]);z&&h._plugins.push(z)}return h.callPlugins=function(t){for(var e=0;e<h._plugins.length;e++)t in h._plugins[e]&&h._plugins[e][t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},h.emitterEventListeners={},h.emit=function(t){var e;if(h.params[t]&&h.params[t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),h.emitterEventListeners[t])for(e=0;e<h.emitterEventListeners[t].length;e++)h.emitterEventListeners[t][e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);h.callPlugins&&h.callPlugins(t,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},h.on=function(t,e){return t=_(t),h.emitterEventListeners[t]||(h.emitterEventListeners[t]=[]),h.emitterEventListeners[t].push(e),h},h.off=function(t,e){var i;if(t=_(t),void 0===e)return h.emitterEventListeners[t]=[],h;if(h.emitterEventListeners[t]&&0!==h.emitterEventListeners[t].length){for(i=0;i<h.emitterEventListeners[t].length;i++)h.emitterEventListeners[t][i]===e&&h.emitterEventListeners[t].splice(i,1);return h}},h.once=function(t,e){t=_(t);var i=function(){e(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),h.off(t,i)};return h.on(t,i),h},h.a11y={makeFocusable:function(t){return t[0].tabIndex="0",t},addRole:function(t,e){return t.attr("role",e),t},addLabel:function(t,e){return t.attr("aria-label",e),t},disable:function(t){return t.attr("aria-disabled",!0),t},enable:function(t){return t.attr("aria-disabled",!1),t},onEnterKey:function(t){13===t.keyCode&&(l(t.target).is(h.params.nextButton)?(h.onClickNext(t),h.isEnd?h.a11y.notify(h.params.lastSlideMsg):h.a11y.notify(h.params.nextSlideMsg)):l(t.target).is(h.params.prevButton)&&(h.onClickPrev(t),h.isBeginning?h.a11y.notify(h.params.firstSlideMsg):h.a11y.notify(h.params.prevSlideMsg)))},liveRegion:l('<span class="swiper-notification" aria-live="assertive" aria-atomic="true"></span>'),notify:function(t){var e=h.a11y.liveRegion;0!==e.length&&(e.html(""),e.html(t))},init:function(){if(h.params.nextButton){var t=l(h.params.nextButton);h.a11y.makeFocusable(t),h.a11y.addRole(t,"button"),h.a11y.addLabel(t,h.params.nextSlideMsg)}if(h.params.prevButton){var e=l(h.params.prevButton);h.a11y.makeFocusable(e),h.a11y.addRole(e,"button"),h.a11y.addLabel(e,h.params.prevSlideMsg)}l(h.container).append(h.a11y.liveRegion)},destroy:function(){h.a11y.liveRegion&&h.a11y.liveRegion.length>0&&h.a11y.liveRegion.remove()}},h.init=function(){h.params.loop&&h.createLoop(),h.updateContainerSize(),h.updateSlidesSize(),h.updatePagination(),h.params.scrollbar&&h.scrollbar&&h.scrollbar.set(),"slide"!==h.params.effect&&h.effects[h.params.effect]&&(h.params.loop||h.updateProgress(),h.effects[h.params.effect].setTranslate()),h.params.loop?h.slideTo(h.params.initialSlide+h.loopedSlides,0,h.params.runCallbacksOnInit):(h.slideTo(h.params.initialSlide,0,h.params.runCallbacksOnInit),0===h.params.initialSlide&&(h.parallax&&h.params.parallax&&h.parallax.setTranslate(),h.lazy&&h.params.lazyLoading&&(h.lazy.load(),h.lazy.initialImageLoaded=!0))),h.attachEvents(),h.params.observer&&h.support.observer&&h.initObservers(),h.params.preloadImages&&!h.params.lazyLoading&&h.preloadImages(),h.params.autoplay&&h.startAutoplay(),h.params.keyboardControl&&h.enableKeyboardControl&&h.enableKeyboardControl(),h.params.mousewheelControl&&h.enableMousewheelControl&&h.enableMousewheelControl(),h.params.hashnav&&h.hashnav&&h.hashnav.init(),h.params.a11y&&h.a11y&&h.a11y.init(),h.emit("onInit",h)},h.cleanupStyles=function(){h.container.removeClass(h.classNames.join(" ")).removeAttr("style"),h.wrapper.removeAttr("style"),h.slides&&h.slides.length&&h.slides.removeClass([h.params.slideVisibleClass,h.params.slideActiveClass,h.params.slideNextClass,h.params.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-column").removeAttr("data-swiper-row"),h.paginationContainer&&h.paginationContainer.length&&h.paginationContainer.removeClass(h.params.paginationHiddenClass),h.bullets&&h.bullets.length&&h.bullets.removeClass(h.params.bulletActiveClass),h.params.prevButton&&l(h.params.prevButton).removeClass(h.params.buttonDisabledClass),h.params.nextButton&&l(h.params.nextButton).removeClass(h.params.buttonDisabledClass),h.params.scrollbar&&h.scrollbar&&(h.scrollbar.track&&h.scrollbar.track.length&&h.scrollbar.track.removeAttr("style"),h.scrollbar.drag&&h.scrollbar.drag.length&&h.scrollbar.drag.removeAttr("style"))},h.destroy=function(t,e){h.detachEvents(),h.stopAutoplay(),h.params.loop&&h.destroyLoop(),e&&h.cleanupStyles(),h.disconnectObservers(),h.params.keyboardControl&&h.disableKeyboardControl&&h.disableKeyboardControl(),h.params.mousewheelControl&&h.disableMousewheelControl&&h.disableMousewheelControl(),h.params.a11y&&h.a11y&&h.a11y.destroy(),h.emit("onDestroy"),!1!==t&&(h=null)},h.init(),h}h.container.each((function(){new r(this,e)}))}function E(){return"horizontal"===h.params.direction}function P(){h.autoplayTimeoutId=setTimeout((function(){h.params.loop?(h.fixLoop(),h._slideNext()):h.isEnd?e.autoplayStopOnLast?h.stopAutoplay():h._slideTo(0):h._slideNext()}),h.params.autoplay)}function L(t,e){var i=l(t.target);if(!i.is(e))if("string"==typeof e)i=i.parents(e);else if(e.nodeType){var n;return i.parents().each((function(t,i){i===e&&(n=e)})),n?e:void 0}if(0!==i.length)return i[0]}function k(t,e){e=e||{};var i=new(window.MutationObserver||window.WebkitMutationObserver)((function(t){t.forEach((function(t){h.onResize(!0),h.emit("onObserverUpdate",h,t)}))}));i.observe(t,{attributes:void 0===e.attributes||e.attributes,childList:void 0===e.childList||e.childList,characterData:void 0===e.characterData||e.characterData}),h.observers.push(i)}function V(t){t.originalEvent&&(t=t.originalEvent);var e=t.keyCode||t.charCode;if(!h.params.allowSwipeToNext&&(E()&&39===e||!E()&&40===e))return!1;if(!h.params.allowSwipeToPrev&&(E()&&37===e||!E()&&38===e))return!1;if(!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey||document.activeElement&&document.activeElement.nodeName&&("input"===document.activeElement.nodeName.toLowerCase()||"textarea"===document.activeElement.nodeName.toLowerCase()))){if(37===e||39===e||38===e||40===e){var i=!1;if(h.container.parents(".swiper-slide").length>0&&0===h.container.parents(".swiper-slide-active").length)return;var n={left:window.pageXOffset,top:window.pageYOffset},a=window.innerWidth,r=window.innerHeight,s=h.container.offset();h.rtl&&(s.left=s.left-h.container[0].scrollLeft);for(var o=[[s.left,s.top],[s.left+h.width,s.top],[s.left,s.top+h.height],[s.left+h.width,s.top+h.height]],l=0;l<o.length;l++){var c=o[l];c[0]>=n.left&&c[0]<=n.left+a&&c[1]>=n.top&&c[1]<=n.top+r&&(i=!0)}if(!i)return}E()?(37!==e&&39!==e||(t.preventDefault?t.preventDefault():t.returnValue=!1),(39===e&&!h.rtl||37===e&&h.rtl)&&h.slideNext(),(37===e&&!h.rtl||39===e&&h.rtl)&&h.slidePrev()):(38!==e&&40!==e||(t.preventDefault?t.preventDefault():t.returnValue=!1),40===e&&h.slideNext(),38===e&&h.slidePrev())}}function I(t){t.originalEvent&&(t=t.originalEvent);var e=h.mousewheel.event,i=0;if(t.detail)i=-t.detail;else if("mousewheel"===e)if(h.params.mousewheelForceToAxis)if(E()){if(!(Math.abs(t.wheelDeltaX)>Math.abs(t.wheelDeltaY)))return;i=t.wheelDeltaX}else{if(!(Math.abs(t.wheelDeltaY)>Math.abs(t.wheelDeltaX)))return;i=t.wheelDeltaY}else i=t.wheelDelta;else if("DOMMouseScroll"===e)i=-t.detail;else if("wheel"===e)if(h.params.mousewheelForceToAxis)if(E()){if(!(Math.abs(t.deltaX)>Math.abs(t.deltaY)))return;i=-t.deltaX}else{if(!(Math.abs(t.deltaY)>Math.abs(t.deltaX)))return;i=-t.deltaY}else i=Math.abs(t.deltaX)>Math.abs(t.deltaY)?-t.deltaX:-t.deltaY;if(h.params.mousewheelInvert&&(i=-i),h.params.freeMode){var n=h.getWrapperTranslate()+i;if(n>0&&(n=0),n<h.maxTranslate()&&(n=h.maxTranslate()),h.setWrapperTransition(0),h.setWrapperTranslate(n),h.updateProgress(),h.updateActiveIndex(),h.params.freeModeSticky&&(clearTimeout(h.mousewheel.timeout),h.mousewheel.timeout=setTimeout((function(){h.slideReset()}),300)),0===n||n===h.maxTranslate())return}else{if((new window.Date).getTime()-h.mousewheel.lastScrollTime>60)if(i<0)if(h.isEnd){if(h.params.mousewheelReleaseOnEdges)return!0}else h.slideNext();else if(h.isBeginning){if(h.params.mousewheelReleaseOnEdges)return!0}else h.slidePrev();h.mousewheel.lastScrollTime=(new window.Date).getTime()}return h.params.autoplay&&h.stopAutoplay(),t.preventDefault?t.preventDefault():t.returnValue=!1,!1}function R(t,e){var i,n,a;i=(t=l(t)).attr("data-swiper-parallax")||"0",n=t.attr("data-swiper-parallax-x"),a=t.attr("data-swiper-parallax-y"),n||a?(n=n||"0",a=a||"0"):E()?(n=i,a="0"):(a=i,n="0"),n=n.indexOf("%")>=0?parseInt(n,10)*e+"%":n*e+"px",a=a.indexOf("%")>=0?parseInt(a,10)*e+"%":a*e+"px",t.transform("translate3d("+n+", "+a+",0px)")}function _(t){return 0!==t.indexOf("on")&&(t=t[0]!==t[0].toUpperCase()?"on"+t[0].toUpperCase()+t.substring(1):"on"+t),t}};r.prototype={isSafari:(a=navigator.userAgent.toLowerCase(),a.indexOf("safari")>=0&&a.indexOf("chrome")<0&&a.indexOf("android")<0),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),isArray:function(t){return"[object Array]"===Object.prototype.toString.apply(t)},browser:{ie:window.navigator.pointerEnabled||window.navigator.msPointerEnabled,ieTouch:window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints>1||window.navigator.pointerEnabled&&window.navigator.maxTouchPoints>1},device:function(){var t=navigator.userAgent,e=t.match(/(Android);?[\s\/]+([\d.]+)?/),i=t.match(/(iPad).*OS\s([\d_]+)/),n=(t.match(/(iPod)(.*OS\s([\d_]+))?/),!i&&t.match(/(iPhone\sOS)\s([\d_]+)/));return{ios:i||n||i,android:e}}(),support:{touch:window.Modernizr&&!0===Modernizr.touch||!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),transforms3d:window.Modernizr&&!0===Modernizr.csstransforms3d||(n=document.createElement("div").style,"webkitPerspective"in n||"MozPerspective"in n||"OPerspective"in n||"MsPerspective"in n||"perspective"in n),flexbox:function(){for(var t=document.createElement("div").style,e="alignItems webkitAlignItems webkitBoxAlign msFlexAlign mozBoxAlign webkitFlexDirection msFlexDirection mozBoxDirection mozBoxOrient webkitBoxDirection webkitBoxOrient".split(" "),i=0;i<e.length;i++)if(e[i]in t)return!0}(),observer:"MutationObserver"in window||"WebkitMutationObserver"in window},plugins:{}};var s,o=function(){var t=function(t){var e=0;for(e=0;e<t.length;e++)this[e]=t[e];return this.length=t.length,this},e=function(e,i){var n=[],a=0;if(e&&!i&&e instanceof t)return e;if(e)if("string"==typeof e){var r,s,o=e.trim();if(o.indexOf("<")>=0&&o.indexOf(">")>=0){var l="div";for(0===o.indexOf("<li")&&(l="ul"),0===o.indexOf("<tr")&&(l="tbody"),0!==o.indexOf("<td")&&0!==o.indexOf("<th")||(l="tr"),0===o.indexOf("<tbody")&&(l="table"),0===o.indexOf("<option")&&(l="select"),(s=document.createElement(l)).innerHTML=e,a=0;a<s.childNodes.length;a++)n.push(s.childNodes[a])}else for(r=i||"#"!==e[0]||e.match(/[ .<>:~]/)?(i||document).querySelectorAll(e):[document.getElementById(e.split("#")[1])],a=0;a<r.length;a++)r[a]&&n.push(r[a])}else if(e.nodeType||e===window||e===document)n.push(e);else if(e.length>0&&e[0].nodeType)for(a=0;a<e.length;a++)n.push(e[a]);return new t(n)};return t.prototype={addClass:function(t){if(void 0===t)return this;for(var e=t.split(" "),i=0;i<e.length;i++)for(var n=0;n<this.length;n++)this[n].classList.add(e[i]);return this},removeClass:function(t){for(var e=t.split(" "),i=0;i<e.length;i++)for(var n=0;n<this.length;n++)this[n].classList.remove(e[i]);return this},hasClass:function(t){return!!this[0]&&this[0].classList.contains(t)},toggleClass:function(t){for(var e=t.split(" "),i=0;i<e.length;i++)for(var n=0;n<this.length;n++)this[n].classList.toggle(e[i]);return this},attr:function(t,e){if(1===arguments.length&&"string"==typeof t)return this[0]?this[0].getAttribute(t):void 0;for(var i=0;i<this.length;i++)if(2===arguments.length)this[i].setAttribute(t,e);else for(var n in t)this[i][n]=t[n],this[i].setAttribute(n,t[n]);return this},removeAttr:function(t){for(var e=0;e<this.length;e++)this[e].removeAttribute(t);return this},data:function(t,e){if(void 0!==e){for(var i=0;i<this.length;i++){var n=this[i];n.dom7ElementDataStorage||(n.dom7ElementDataStorage={}),n.dom7ElementDataStorage[t]=e}return this}if(this[0]){var a=this[0].getAttribute("data-"+t);return a||(this[0].dom7ElementDataStorage&&t in this[0].dom7ElementDataStorage?this[0].dom7ElementDataStorage[t]:void 0)}},transform:function(t){for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransform=i.MsTransform=i.msTransform=i.MozTransform=i.OTransform=i.transform=t}return this},transition:function(t){"string"!=typeof t&&(t+="ms");for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransitionDuration=i.MsTransitionDuration=i.msTransitionDuration=i.MozTransitionDuration=i.OTransitionDuration=i.transitionDuration=t}return this},on:function(t,i,n,a){function r(t){var a=t.target;if(e(a).is(i))n.call(a,t);else for(var r=e(a).parents(),s=0;s<r.length;s++)e(r[s]).is(i)&&n.call(r[s],t)}var s,o,l=t.split(" ");for(s=0;s<this.length;s++)if("function"==typeof i||!1===i)for("function"==typeof i&&(n=arguments[1],a=arguments[2]||!1),o=0;o<l.length;o++)this[s].addEventListener(l[o],n,a);else for(o=0;o<l.length;o++)this[s].dom7LiveListeners||(this[s].dom7LiveListeners=[]),this[s].dom7LiveListeners.push({listener:n,liveListener:r}),this[s].addEventListener(l[o],r,a);return this},off:function(t,e,i,n){for(var a=t.split(" "),r=0;r<a.length;r++)for(var s=0;s<this.length;s++)if("function"==typeof e||!1===e)"function"==typeof e&&(i=arguments[1],n=arguments[2]||!1),this[s].removeEventListener(a[r],i,n);else if(this[s].dom7LiveListeners)for(var o=0;o<this[s].dom7LiveListeners.length;o++)this[s].dom7LiveListeners[o].listener===i&&this[s].removeEventListener(a[r],this[s].dom7LiveListeners[o].liveListener,n);return this},once:function(t,e,i,n){var a=this;"function"==typeof e&&(e=!1,i=arguments[1],n=arguments[2]),a.on(t,e,(function r(s){i(s),a.off(t,e,r,n)}),n)},trigger:function(t,e){for(var i=0;i<this.length;i++){var n;try{n=new window.CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0})}catch(i){(n=document.createEvent("Event")).initEvent(t,!0,!0),n.detail=e}this[i].dispatchEvent(n)}return this},transitionEnd:function(t){var e,i=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=this;function a(r){if(r.target===this)for(t.call(this,r),e=0;e<i.length;e++)n.off(i[e],a)}if(t)for(e=0;e<i.length;e++)n.on(i[e],a);return this},width:function(){return this[0]===window?window.innerWidth:this.length>0?parseFloat(this.css("width")):null},outerWidth:function(t){return this.length>0?t?this[0].offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this[0].offsetWidth:null},height:function(){return this[0]===window?window.innerHeight:this.length>0?parseFloat(this.css("height")):null},outerHeight:function(t){return this.length>0?t?this[0].offsetHeight+parseFloat(this.css("margin-top"))+parseFloat(this.css("margin-bottom")):this[0].offsetHeight:null},offset:function(){if(this.length>0){var t=this[0],e=t.getBoundingClientRect(),i=document.body,n=t.clientTop||i.clientTop||0,a=t.clientLeft||i.clientLeft||0,r=window.pageYOffset||t.scrollTop,s=window.pageXOffset||t.scrollLeft;return{top:e.top+r-n,left:e.left+s-a}}return null},css:function(t,e){var i;if(1===arguments.length){if("string"!=typeof t){for(i=0;i<this.length;i++)for(var n in t)this[i].style[n]=t[n];return this}if(this[0])return window.getComputedStyle(this[0],null).getPropertyValue(t)}if(2===arguments.length&&"string"==typeof t){for(i=0;i<this.length;i++)this[i].style[t]=e;return this}return this},each:function(t){for(var e=0;e<this.length;e++)t.call(this[e],e,this[e]);return this},html:function(t){if(void 0===t)return this[0]?this[0].innerHTML:void 0;for(var e=0;e<this.length;e++)this[e].innerHTML=t;return this},is:function(i){if(!this[0])return!1;var n,a;if("string"==typeof i){var r=this[0];if(r===document)return i===document;if(r===window)return i===window;if(r.matches)return r.matches(i);if(r.webkitMatchesSelector)return r.webkitMatchesSelector(i);if(r.mozMatchesSelector)return r.mozMatchesSelector(i);if(r.msMatchesSelector)return r.msMatchesSelector(i);for(n=e(i),a=0;a<n.length;a++)if(n[a]===this[0])return!0;return!1}if(i===document)return this[0]===document;if(i===window)return this[0]===window;if(i.nodeType||i instanceof t){for(n=i.nodeType?[i]:i,a=0;a<n.length;a++)if(n[a]===this[0])return!0;return!1}return!1},index:function(){if(this[0]){for(var t=this[0],e=0;null!==(t=t.previousSibling);)1===t.nodeType&&e++;return e}},eq:function(e){if(void 0===e)return this;var i,n=this.length;return new t(e>n-1?[]:e<0?(i=n+e)<0?[]:[this[i]]:[this[e]])},append:function(e){var i,n;for(i=0;i<this.length;i++)if("string"==typeof e){var a=document.createElement("div");for(a.innerHTML=e;a.firstChild;)this[i].appendChild(a.firstChild)}else if(e instanceof t)for(n=0;n<e.length;n++)this[i].appendChild(e[n]);else this[i].appendChild(e);return this},prepend:function(e){var i,n;for(i=0;i<this.length;i++)if("string"==typeof e){var a=document.createElement("div");for(a.innerHTML=e,n=a.childNodes.length-1;n>=0;n--)this[i].insertBefore(a.childNodes[n],this[i].childNodes[0])}else if(e instanceof t)for(n=0;n<e.length;n++)this[i].insertBefore(e[n],this[i].childNodes[0]);else this[i].insertBefore(e,this[i].childNodes[0]);return this},insertBefore:function(t){for(var i=e(t),n=0;n<this.length;n++)if(1===i.length)i[0].parentNode.insertBefore(this[n],i[0]);else if(i.length>1)for(var a=0;a<i.length;a++)i[a].parentNode.insertBefore(this[n].cloneNode(!0),i[a])},insertAfter:function(t){for(var i=e(t),n=0;n<this.length;n++)if(1===i.length)i[0].parentNode.insertBefore(this[n],i[0].nextSibling);else if(i.length>1)for(var a=0;a<i.length;a++)i[a].parentNode.insertBefore(this[n].cloneNode(!0),i[a].nextSibling)},next:function(i){return this.length>0?i?this[0].nextElementSibling&&e(this[0].nextElementSibling).is(i)?new t([this[0].nextElementSibling]):new t([]):this[0].nextElementSibling?new t([this[0].nextElementSibling]):new t([]):new t([])},nextAll:function(i){var n=[],a=this[0];if(!a)return new t([]);for(;a.nextElementSibling;){var r=a.nextElementSibling;i?e(r).is(i)&&n.push(r):n.push(r),a=r}return new t(n)},prev:function(i){return this.length>0?i?this[0].previousElementSibling&&e(this[0].previousElementSibling).is(i)?new t([this[0].previousElementSibling]):new t([]):this[0].previousElementSibling?new t([this[0].previousElementSibling]):new t([]):new t([])},prevAll:function(i){var n=[],a=this[0];if(!a)return new t([]);for(;a.previousElementSibling;){var r=a.previousElementSibling;i?e(r).is(i)&&n.push(r):n.push(r),a=r}return new t(n)},parent:function(t){for(var i=[],n=0;n<this.length;n++)t?e(this[n].parentNode).is(t)&&i.push(this[n].parentNode):i.push(this[n].parentNode);return e(e.unique(i))},parents:function(t){for(var i=[],n=0;n<this.length;n++)for(var a=this[n].parentNode;a;)t?e(a).is(t)&&i.push(a):i.push(a),a=a.parentNode;return e(e.unique(i))},find:function(e){for(var i=[],n=0;n<this.length;n++)for(var a=this[n].querySelectorAll(e),r=0;r<a.length;r++)i.push(a[r]);return new t(i)},children:function(i){for(var n=[],a=0;a<this.length;a++)for(var r=this[a].childNodes,s=0;s<r.length;s++)i?1===r[s].nodeType&&e(r[s]).is(i)&&n.push(r[s]):1===r[s].nodeType&&n.push(r[s]);return new t(e.unique(n))},remove:function(){for(var t=0;t<this.length;t++)this[t].parentNode&&this[t].parentNode.removeChild(this[t]);return this},add:function(){var t,i,n=this;for(t=0;t<arguments.length;t++){var a=e(arguments[t]);for(i=0;i<a.length;i++)n[n.length]=a[i],n.length++}return n}},e.fn=t.prototype,e.unique=function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e},e}(),l=["jQuery","Zepto","Dom7"];function h(t){t.fn.swiper=function(e){var i;return t(this).each((function(){var t=new r(this,e);i||(i=t)})),i}}for(var c=0;c<l.length;c++)window[l[c]]&&h(window[l[c]]);(s=void 0===o?window.Dom7||window.Zepto||window.jQuery:o)&&("transitionEnd"in s.fn||(s.fn.transitionEnd=function(t){var e,i=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=this;function a(r){if(r.target===this)for(t.call(this,r),e=0;e<i.length;e++)n.off(i[e],a)}if(t)for(e=0;e<i.length;e++)n.on(i[e],a);return this}),"transform"in s.fn||(s.fn.transform=function(t){for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransform=i.MsTransform=i.msTransform=i.MozTransform=i.OTransform=i.transform=t}return this}),"transition"in s.fn||(s.fn.transition=function(t){"string"!=typeof t&&(t+="ms");for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransitionDuration=i.MsTransitionDuration=i.msTransitionDuration=i.MozTransitionDuration=i.OTransitionDuration=i.transitionDuration=t}return this})),i.exports=r})),define("jquery.bpopup.min",[],(function(t,e,i){var n;(n=jQuery).fn.bPopup=function(t,e){function i(){f.modal&&n('<div class="b-modal '+m+'"></div>').css({backgroundColor:f.modalColor,position:"fixed",top:0,right:0,bottom:0,left:0,opacity:0,zIndex:f.zIndex+I}).appendTo(f.appendTo).fadeTo(f.speed,f.opacity),d(),z.data("bPopup",f).data("id",m).css({left:"slideIn"==f.transition||"slideBack"==f.transition?"slideBack"==f.transition?E.scrollLeft()+k:-1*(b+M):h(!(!f.follow[0]&&w||x)),position:f.positionStyle||"absolute",top:"slideDown"==f.transition||"slideUp"==f.transition?"slideUp"==f.transition?E.scrollTop()+L:y+-1*S:c(!(!f.follow[1]&&v||x)),"z-index":f.zIndex+I+1}).each((function(){f.appending&&n(this).appendTo(f.appendTo)})),o(!0)}function a(){return f.modal&&n(".b-modal."+z.data("id")).fadeTo(f.speed,0,(function(){n(this).remove()})),f.scrollBar||n("html").css("overflow","auto"),n(".b-modal."+m).unbind("click"),E.unbind("keydown."+m),P.unbind("."+m).data("bPopup",0<P.data("bPopup")-1?P.data("bPopup")-1:null),z.undelegate(".bClose, ."+f.closeClass,"click."+m,a).data("bPopup",null),clearTimeout(C),o(),!1}function r(t){L=P.height(),k=P.width(),((g=u()).x||g.y)&&(clearTimeout(T),T=setTimeout((function(){d(),t=t||f.followSpeed;var e={};g.x&&(e.left=f.follow[0]?h(!0):"auto"),g.y&&(e.top=f.follow[1]?c(!0):"auto"),z.dequeue().each((function(){x?n(this).css({left:b,top:y}):n(this).animate(e,t,f.followEasing)}))}),50))}function s(t){var e=t.width(),i=t.height(),n={};f.contentContainer.css({height:i,width:e}),i>=z.height()&&(n.height=z.height()),e>=z.width()&&(n.width=z.width()),S=z.outerHeight(!0),M=z.outerWidth(!0),d(),f.contentContainer.css({height:"auto",width:"auto"}),n.left=h(!(!f.follow[0]&&w||x)),n.top=c(!(!f.follow[1]&&v||x)),z.animate(n,250,(function(){t.show(),g=u()}))}function o(t){function e(e){z.css({display:"block",opacity:1}).animate(e,f.speed,f.easing,(function(){l(t)}))}switch(t?f.transition:f.transitionClose||f.transition){case"slideIn":e({left:t?h(!(!f.follow[0]&&w||x)):E.scrollLeft()-(M||z.outerWidth(!0))-200});break;case"slideBack":e({left:t?h(!(!f.follow[0]&&w||x)):E.scrollLeft()+k+200});break;case"slideDown":e({top:t?c(!(!f.follow[1]&&v||x)):E.scrollTop()-(S||z.outerHeight(!0))-200});break;case"slideUp":e({top:t?c(!(!f.follow[1]&&v||x)):E.scrollTop()+L+200});break;default:z.stop().fadeTo(f.speed,t?1:0,(function(){l(t)}))}}function l(t){t?(P.data("bPopup",I),z.delegate(".bClose, ."+f.closeClass,"click."+m,a),f.modalClose&&n(".b-modal."+m).css("cursor","pointer").bind("click",a),V||!f.follow[0]&&!f.follow[1]||P.bind("scroll."+m,(function(){if(g.x||g.y){var t={};g.x&&(t.left=f.follow[0]?h(!x):"auto"),g.y&&(t.top=f.follow[1]?c(!x):"auto"),z.dequeue().animate(t,f.followSpeed,f.followEasing)}})).bind("resize."+m,(function(){r()})),f.escClose&&E.bind("keydown."+m,(function(t){27==t.which&&a()})),p(e),f.autoClose&&(C=setTimeout(a,f.autoClose))):(z.hide(),p(f.onClose),f.loadUrl&&(f.contentContainer.empty(),z.css({height:"auto",width:"auto"})))}function h(t){return t?b+E.scrollLeft():b}function c(t){return t?y+E.scrollTop():y}function p(t,e){n.isFunction(t)&&t.call(z,e)}function d(){y=v?f.position[1]:Math.max(0,(L-z.outerHeight(!0))/2-f.amsl),b=w?f.position[0]:(k-z.outerWidth(!0))/2,g=u()}function u(){return{x:k>z.outerWidth(!0),y:L>z.outerHeight(!0)}}n.isFunction(t)&&(e=t,t=null);var f=n.extend({},n.fn.bPopup.defaults,t);f.scrollBar||n("html").css("overflow","hidden");var m,g,v,w,x,y,b,S,M,T,C,z=this,E=n(document),P=n(window),L=P.height(),k=P.width(),V=/OS 6(_\d)+/i.test(navigator.userAgent),I=0;return z.close=function(){a()},z.reposition=function(t){r(t)},z.each((function(){n(this).data("bPopup")||(p(f.onOpen),I=(P.data("bPopup")||0)+1,m="__b-popup"+I+"__",v="auto"!==f.position[1],w="auto"!==f.position[0],x="fixed"===f.positionStyle,S=z.outerHeight(!0),M=z.outerWidth(!0),f.loadUrl?function(){switch(f.contentContainer=n(f.contentContainer||z),f.content){case"iframe":var t=n('<iframe class="b-iframe" '+f.iframeAttr+"></iframe>");t.appendTo(f.contentContainer),S=z.outerHeight(!0),M=z.outerWidth(!0),i(),t.attr("src",f.loadUrl),p(f.loadCallback);break;case"image":i(),n("<img />").load((function(){p(f.loadCallback),s(n(this))})).attr("src",f.loadUrl).hide().appendTo(f.contentContainer);break;default:i(),n('<div class="b-ajax-wrapper"></div>').load(f.loadUrl,f.loadData,(function(t,e,i){p(f.loadCallback,e),s(n(this))})).hide().appendTo(f.contentContainer)}}():i())}))},n.fn.bPopup.defaults={amsl:50,appending:!0,appendTo:"body",autoClose:!1,closeClass:"b-close",content:"ajax",contentContainer:!1,easing:"swing",escClose:!0,follow:[!0,!0],followEasing:"swing",followSpeed:500,iframeAttr:'scrolling="no" frameborder="0"',loadCallback:!1,loadData:!1,loadUrl:!1,modal:!0,modalClose:!0,modalColor:"#000",onClose:!1,onOpen:!1,opacity:.7,position:["auto","auto"],positionStyle:"absolute",scrollBar:!0,speed:250,transition:"fadeIn",transitionClose:!1,zIndex:9997}})),define("jquery.mobile-events.min",[],(function(t,e,i){"use strict";!function(t){function e(){var t=s();t!==o&&(o=t,c.trigger("orientationchange"))}function i(e,i,n,a){var r=n.type;n.type=i,t.event.dispatch.call(e,n,a),n.type=r}t.attrFn=t.attrFn||{};var n=navigator.userAgent.toLowerCase(),a=n.indexOf("chrome")>-1&&(n.indexOf("windows")>-1||n.indexOf("macintosh")>-1||n.indexOf("linux")>-1)&&n.indexOf("mobile")<0&&n.indexOf("android")<0,r={tap_pixel_range:5,swipe_h_threshold:50,swipe_v_threshold:50,taphold_threshold:750,doubletap_int:500,touch_capable:"ontouchstart"in window&&!a,orientation_support:"orientation"in window&&"onorientationchange"in window,startevent:"ontouchstart"in window&&!a?"touchstart":"mousedown",endevent:"ontouchstart"in window&&!a?"touchend":"mouseup",moveevent:"ontouchstart"in window&&!a?"touchmove":"mousemove",tapevent:"ontouchstart"in window&&!a?"tap":"click",scrollevent:"ontouchstart"in window&&!a?"touchmove":"scroll",hold_timer:null,tap_timer:null};t.isTouchCapable=function(){return r.touch_capable},t.getStartEvent=function(){return r.startevent},t.getEndEvent=function(){return r.endevent},t.getMoveEvent=function(){return r.moveevent},t.getTapEvent=function(){return r.tapevent},t.getScrollEvent=function(){return r.scrollevent},t.each(["tapstart","tapend","tapmove","tap","tap2","tap3","tap4","singletap","doubletap","taphold","swipe","swipeup","swiperight","swipedown","swipeleft","swipeend","scrollstart","scrollend","orientationchange"],(function(e,i){t.fn[i]=function(t){return t?this.on(i,t):this.trigger(i)},t.attrFn[i]=!0})),t.event.special.tapstart={setup:function(){var e=this,n=t(e);n.on(r.startevent,(function t(a){if(n.data("callee",t),a.which&&1!==a.which)return!1;var s=a.originalEvent,o={position:{x:r.touch_capable?s.touches[0].screenX:a.screenX,y:r.touch_capable?s.touches[0].screenY:a.screenY},offset:{x:Math.round(r.touch_capable?s.changedTouches[0].pageX-n.offset().left:a.pageX-n.offset().left),y:Math.round(r.touch_capable?s.changedTouches[0].pageY-n.offset().top:a.pageY-n.offset().top)},time:Date.now(),target:a.target};return i(e,"tapstart",a,o),!0}))},remove:function(){t(this).off(r.startevent,t(this).data.callee)}},t.event.special.tapmove={setup:function(){var e=this,n=t(e);n.on(r.moveevent,(function t(a){n.data("callee",t);var s=a.originalEvent,o={position:{x:r.touch_capable?s.touches[0].screenX:a.screenX,y:r.touch_capable?s.touches[0].screenY:a.screenY},offset:{x:Math.round(r.touch_capable?s.changedTouches[0].pageX-n.offset().left:a.pageX-n.offset().left),y:Math.round(r.touch_capable?s.changedTouches[0].pageY-n.offset().top:a.pageY-n.offset().top)},time:Date.now(),target:a.target};return i(e,"tapmove",a,o),!0}))},remove:function(){t(this).off(r.moveevent,t(this).data.callee)}},t.event.special.tapend={setup:function(){var e=this,n=t(e);n.on(r.endevent,(function t(a){n.data("callee",t);var s=a.originalEvent,o={position:{x:r.touch_capable?s.changedTouches[0].screenX:a.screenX,y:r.touch_capable?s.changedTouches[0].screenY:a.screenY},offset:{x:Math.round(r.touch_capable?s.changedTouches[0].pageX-n.offset().left:a.pageX-n.offset().left),y:Math.round(r.touch_capable?s.changedTouches[0].pageY-n.offset().top:a.pageY-n.offset().top)},time:Date.now(),target:a.target};return i(e,"tapend",a,o),!0}))},remove:function(){t(this).off(r.endevent,t(this).data.callee)}},t.event.special.taphold={setup:function(){var e,n=this,a=t(n),s={x:0,y:0},o=0,l=0;a.on(r.startevent,(function t(h){if(h.which&&1!==h.which)return!1;a.data("tapheld",!1),e=h.target;var c=h.originalEvent,p=Date.now(),d={x:r.touch_capable?c.touches[0].screenX:h.screenX,y:r.touch_capable?c.touches[0].screenY:h.screenY},u={x:r.touch_capable?c.touches[0].pageX-c.touches[0].target.offsetLeft:h.offsetX,y:r.touch_capable?c.touches[0].pageY-c.touches[0].target.offsetTop:h.offsetY};return s.x=h.originalEvent.targetTouches?h.originalEvent.targetTouches[0].pageX:h.pageX,s.y=h.originalEvent.targetTouches?h.originalEvent.targetTouches[0].pageY:h.pageY,o=s.x,l=s.y,r.hold_timer=window.setTimeout((function(){var f=s.x-o,m=s.y-l;if(h.target==e&&(s.x==o&&s.y==l||f>=-r.tap_pixel_range&&f<=r.tap_pixel_range&&m>=-r.tap_pixel_range&&m<=r.tap_pixel_range)){a.data("tapheld",!0);var g=Date.now(),v={x:r.touch_capable?c.touches[0].screenX:h.screenX,y:r.touch_capable?c.touches[0].screenY:h.screenY},w={x:Math.round(r.touch_capable?c.changedTouches[0].pageX-a.offset().left:h.pageX-a.offset().left),y:Math.round(r.touch_capable?c.changedTouches[0].pageY-a.offset().top:h.pageY-a.offset().top)},x={startTime:p,endTime:g,startPosition:d,startOffset:u,endPosition:v,endOffset:w,duration:g-p,target:h.target};a.data("callee1",t),i(n,"taphold",h,x)}}),r.taphold_threshold),!0})).on(r.endevent,(function t(){a.data("callee2",t),a.data("tapheld",!1),window.clearTimeout(r.hold_timer)})).on(r.moveevent,(function t(e){a.data("callee3",t),o=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,l=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY}))},remove:function(){t(this).off(r.startevent,t(this).data.callee1).off(r.endevent,t(this).data.callee2).off(r.moveevent,t(this).data.callee3)}},t.event.special.doubletap={setup:function(){var e,n,a,s=this,o=t(s),l=null,h=!1;o.on(r.startevent,(function t(i){return(!i.which||1===i.which)&&(o.data("doubletapped",!1),e=i.target,o.data("callee1",t),a=i.originalEvent,l||(l={position:{x:r.touch_capable?a.touches[0].screenX:i.screenX,y:r.touch_capable?a.touches[0].screenY:i.screenY},offset:{x:Math.round(r.touch_capable?a.changedTouches[0].pageX-o.offset().left:i.pageX-o.offset().left),y:Math.round(r.touch_capable?a.changedTouches[0].pageY-o.offset().top:i.pageY-o.offset().top)},time:Date.now(),target:i.target}),!0)})).on(r.endevent,(function t(c){var p=Date.now(),d=p-(o.data("lastTouch")||p+1);if(window.clearTimeout(n),o.data("callee2",t),d<r.doubletap_int&&c.target==e&&d>100){o.data("doubletapped",!0),window.clearTimeout(r.tap_timer);var u={position:{x:r.touch_capable?c.originalEvent.changedTouches[0].screenX:c.screenX,y:r.touch_capable?c.originalEvent.changedTouches[0].screenY:c.screenY},offset:{x:Math.round(r.touch_capable?a.changedTouches[0].pageX-o.offset().left:c.pageX-o.offset().left),y:Math.round(r.touch_capable?a.changedTouches[0].pageY-o.offset().top:c.pageY-o.offset().top)},time:Date.now(),target:c.target},f={firstTap:l,secondTap:u,interval:u.time-l.time};h||(i(s,"doubletap",c,f),l=null),h=!0,window.setTimeout((function(){h=!1}),r.doubletap_int)}else o.data("lastTouch",p),n=window.setTimeout((function(){l=null,window.clearTimeout(n)}),r.doubletap_int,[c]);o.data("lastTouch",p)}))},remove:function(){t(this).off(r.startevent,t(this).data.callee1).off(r.endevent,t(this).data.callee2)}},t.event.special.singletap={setup:function(){var e=this,n=t(e),a=null,s=null,o={x:0,y:0};n.on(r.startevent,(function t(e){return(!e.which||1===e.which)&&(s=Date.now(),a=e.target,n.data("callee1",t),o.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,o.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY,!0)})).on(r.endevent,(function t(l){if(n.data("callee2",t),l.target==a){var h=l.originalEvent.changedTouches?l.originalEvent.changedTouches[0].pageX:l.pageX,c=l.originalEvent.changedTouches?l.originalEvent.changedTouches[0].pageY:l.pageY;r.tap_timer=window.setTimeout((function(){if(!n.data("doubletapped")&&!n.data("tapheld")&&o.x==h&&o.y==c){var t=l.originalEvent,a={position:{x:r.touch_capable?t.changedTouches[0].screenX:l.screenX,y:r.touch_capable?t.changedTouches[0].screenY:l.screenY},offset:{x:Math.round(r.touch_capable?t.changedTouches[0].pageX-n.offset().left:l.pageX-n.offset().left),y:Math.round(r.touch_capable?t.changedTouches[0].pageY-n.offset().top:l.pageY-n.offset().top)},time:Date.now(),target:l.target};a.time-s<r.taphold_threshold&&i(e,"singletap",l,a)}}),r.doubletap_int)}}))},remove:function(){t(this).off(r.startevent,t(this).data.callee1).off(r.endevent,t(this).data.callee2)}},t.event.special.tap={setup:function(){var e,n,a=this,s=t(a),o=!1,l=null,h={x:0,y:0};s.on(r.startevent,(function t(i){return s.data("callee1",t),(!i.which||1===i.which)&&(o=!0,h.x=i.originalEvent.targetTouches?i.originalEvent.targetTouches[0].pageX:i.pageX,h.y=i.originalEvent.targetTouches?i.originalEvent.targetTouches[0].pageY:i.pageY,e=Date.now(),l=i.target,n=i.originalEvent.targetTouches?i.originalEvent.targetTouches:[i],!0)})).on(r.endevent,(function t(c){s.data("callee2",t);var p=c.originalEvent.targetTouches?c.originalEvent.changedTouches[0].pageX:c.pageX,d=c.originalEvent.targetTouches?c.originalEvent.changedTouches[0].pageY:c.pageY,u=h.x-p,f=h.y-d;if(l==c.target&&o&&Date.now()-e<r.taphold_threshold&&(h.x==p&&h.y==d||u>=-r.tap_pixel_range&&u<=r.tap_pixel_range&&f>=-r.tap_pixel_range&&f<=r.tap_pixel_range)){for(var m=c.originalEvent,g=[],v=0;v<n.length;v++){var w={position:{x:r.touch_capable?m.changedTouches[v].screenX:c.screenX,y:r.touch_capable?m.changedTouches[v].screenY:c.screenY},offset:{x:Math.round(r.touch_capable?m.changedTouches[v].pageX-s.offset().left:c.pageX-s.offset().left),y:Math.round(r.touch_capable?m.changedTouches[v].pageY-s.offset().top:c.pageY-s.offset().top)},time:Date.now(),target:c.target};g.push(w)}i(a,"tap",c,g)}}))},remove:function(){t(this).off(r.startevent,t(this).data.callee1).off(r.endevent,t(this).data.callee2)}},t.event.special.swipe={setup:function(){var e,i=t(this),n=!1,a=!1,s={x:0,y:0},o={x:0,y:0};i.on(r.startevent,(function a(l){(i=t(l.currentTarget)).data("callee1",a),s.x=l.originalEvent.targetTouches?l.originalEvent.targetTouches[0].pageX:l.pageX,s.y=l.originalEvent.targetTouches?l.originalEvent.targetTouches[0].pageY:l.pageY,o.x=s.x,o.y=s.y,n=!0;var h=l.originalEvent;e={position:{x:r.touch_capable?h.touches[0].screenX:l.screenX,y:r.touch_capable?h.touches[0].screenY:l.screenY},offset:{x:Math.round(r.touch_capable?h.changedTouches[0].pageX-i.offset().left:l.pageX-i.offset().left),y:Math.round(r.touch_capable?h.changedTouches[0].pageY-i.offset().top:l.pageY-i.offset().top)},time:Date.now(),target:l.target}})),i.on(r.moveevent,(function l(h){(i=t(h.currentTarget)).data("callee2",l),o.x=h.originalEvent.targetTouches?h.originalEvent.targetTouches[0].pageX:h.pageX,o.y=h.originalEvent.targetTouches?h.originalEvent.targetTouches[0].pageY:h.pageY;var c,p=i.parent().data("xthreshold")?i.parent().data("xthreshold"):i.data("xthreshold"),d=i.parent().data("ythreshold")?i.parent().data("ythreshold"):i.data("ythreshold"),u=void 0!==p&&!1!==p&&parseInt(p)?parseInt(p):r.swipe_h_threshold,f=void 0!==d&&!1!==d&&parseInt(d)?parseInt(d):r.swipe_v_threshold;if(s.y>o.y&&s.y-o.y>f&&(c="swipeup"),s.x<o.x&&o.x-s.x>u&&(c="swiperight"),s.y<o.y&&o.y-s.y>f&&(c="swipedown"),s.x>o.x&&s.x-o.x>u&&(c="swipeleft"),null!=c&&n){s.x=0,s.y=0,o.x=0,o.y=0,n=!1;var m=h.originalEvent,g={position:{x:r.touch_capable?m.touches[0].screenX:h.screenX,y:r.touch_capable?m.touches[0].screenY:h.screenY},offset:{x:Math.round(r.touch_capable?m.changedTouches[0].pageX-i.offset().left:h.pageX-i.offset().left),y:Math.round(r.touch_capable?m.changedTouches[0].pageY-i.offset().top:h.pageY-i.offset().top)},time:Date.now(),target:h.target},v=Math.abs(e.position.x-g.position.x),w=Math.abs(e.position.y-g.position.y),x={startEvnt:e,endEvnt:g,direction:c.replace("swipe",""),xAmount:v,yAmount:w,duration:g.time-e.time};a=!0,i.trigger("swipe",x).trigger(c,x)}})),i.on(r.endevent,(function s(o){var l="";if((i=t(o.currentTarget)).data("callee3",s),a){var h=i.data("xthreshold"),c=i.data("ythreshold"),p=void 0!==h&&!1!==h&&parseInt(h)?parseInt(h):r.swipe_h_threshold,d=void 0!==c&&!1!==c&&parseInt(c)?parseInt(c):r.swipe_v_threshold,u=o.originalEvent,f={position:{x:r.touch_capable?u.changedTouches[0].screenX:o.screenX,y:r.touch_capable?u.changedTouches[0].screenY:o.screenY},offset:{x:Math.round(r.touch_capable?u.changedTouches[0].pageX-i.offset().left:o.pageX-i.offset().left),y:Math.round(r.touch_capable?u.changedTouches[0].pageY-i.offset().top:o.pageY-i.offset().top)},time:Date.now(),target:o.target};e.position.y>f.position.y&&e.position.y-f.position.y>d&&(l="swipeup"),e.position.x<f.position.x&&f.position.x-e.position.x>p&&(l="swiperight"),e.position.y<f.position.y&&f.position.y-e.position.y>d&&(l="swipedown"),e.position.x>f.position.x&&e.position.x-f.position.x>p&&(l="swipeleft");var m=Math.abs(e.position.x-f.position.x),g=Math.abs(e.position.y-f.position.y),v={startEvnt:e,endEvnt:f,direction:l.replace("swipe",""),xAmount:m,yAmount:g,duration:f.time-e.time};i.trigger("swipeend",v)}n=!1,a=!1}))},remove:function(){t(this).off(r.startevent,t(this).data.callee1).off(r.moveevent,t(this).data.callee2).off(r.endevent,t(this).data.callee3)}},t.event.special.scrollstart={setup:function(){function e(t,e){i(s,(n=e)?"scrollstart":"scrollend",t)}var n,a,s=this,o=t(s);o.on(r.scrollevent,(function t(i){o.data("callee",t),n||e(i,!0),clearTimeout(a),a=setTimeout((function(){e(i,!1)}),50)}))},remove:function(){t(this).off(r.scrollevent,t(this).data.callee)}};var s,o,l,h,c=t(window),p={0:!0,180:!0};if(r.orientation_support){var d=window.innerWidth||c.width(),u=window.innerHeight||c.height();l=d>u&&d-u>50,h=p[window.orientation],(l&&h||!l&&!h)&&(p={"-90":!0,90:!0})}t.event.special.orientationchange={setup:function(){return!r.orientation_support&&(o=s(),c.on("throttledresize",e),!0)},teardown:function(){return!r.orientation_support&&(c.off("throttledresize",e),!0)},add:function(t){var e=t.handler;t.handler=function(t){return t.orientation=s(),e.apply(this,arguments)}}},t.event.special.orientationchange.orientation=s=function(){var t=document.documentElement;return(r.orientation_support?p[window.orientation]:t&&t.clientWidth/t.clientHeight<1.1)?"portrait":"landscape"},t.event.special.throttledresize={setup:function(){t(this).on("resize",v)},teardown:function(){t(this).off("resize",v)}};var f,m,g,v=function(){m=Date.now(),(g=m-w)>=250?(w=m,t(this).trigger("throttledresize")):(f&&window.clearTimeout(f),f=window.setTimeout(e,250-g))},w=0;t.each({scrollend:"scrollstart",swipeup:"swipe",swiperight:"swipe",swipedown:"swipe",swipeleft:"swipe",swipeend:"swipe",tap2:"tap"},(function(e,i){t.event.special[e]={setup:function(){t(this).on(i,t.noop)}}}))}(jQuery)})),define("leaves",["../lib/js/config/config"],(function(t,e,i){function n(){for(var t=document.getElementById("yinghua"),e=0;e<3;e++)t.appendChild(o())}function a(t,e){return t+Math.floor(Math.random()*(e-t))}function r(t,e){return t+Math.random()*(e-t)}function s(t){return t+"s"}function o(){var t=document.createElement("div"),e=document.createElement("img");e.src=OP_CDN_PREFIX+"images/yinghua"+a(1,3)+".png",t.style.top="-20px",t.style.left=a(10,80)+"%";var i=Math.random()<.5?"clockwiseSpin":"counterclockwiseSpinAndFlip";t.style.webkitAnimationName="fade, drop",e.style.webkitAnimationName=i;var n=s(r(2,11)),o=s(r(4,42));t.style.webkitAnimationDuration=n+", "+n;var l=s(r(0,2));return t.style.webkitAnimationDelay=l+", "+l,e.style.webkitAnimationDuration=o,t.appendChild(e),t}t("../lib/js/config/config"),window.addEventListener("load",n,!1),i.exports=n})),define("../lib/js/config/config",[],(function(t,e,i){DOMAIN_SERVER="http://test.117go.wang:8011",MYHOST="http://test.117go.wang:8011",MYHOSTPAY="http://test.117go.wang:8011",OP_CDN_PREFIX="http://555.117go.wang:8011/jp20151223/",LIB_PREFIX="http://555.117go.wang:8011/lib/",OP_DATA_PREFIX="http://555.117go.wang:8011/jp20151223/",SYSTEM_ERROR_MSG="系统繁忙，请稍后重试！"})),define("prefixfree.min",[],(function(t,e,i){(function(){function t(t,e){return[].slice.call((e||document).querySelectorAll(t))}if(window.addEventListener){var e=window.StyleFix={link:function(t){try{if("stylesheet"!==t.rel||t.hasAttribute("data-noprefix"))return}catch(t){return}var i,n=t.href||t.getAttribute("data-href"),a=n.replace(/[^\/]+$/,""),r=(/^[a-z]{3,10}:/.exec(a)||[""])[0],s=(/^[a-z]{3,10}:\/\/[^\/]+/.exec(a)||[""])[0],o=/^([^?]*)\??/.exec(n)[1],l=t.parentNode,h=new XMLHttpRequest;h.onreadystatechange=function(){4===h.readyState&&i()},i=function(){var i=h.responseText;if(i&&t.parentNode&&(!h.status||h.status<400||h.status>600)){if(i=e.fix(i,!0,t),a){i=i.replace(/url\(\s*?((?:"|')?)(.+?)\1\s*?\)/gi,(function(t,e,i){return/^([a-z]{3,10}:|#)/i.test(i)?t:/^\/\//.test(i)?'url("'+r+i+'")':/^\//.test(i)?'url("'+s+i+'")':/^\?/.test(i)?'url("'+o+i+'")':'url("'+a+i+'")'}));var n=a.replace(/([\\\^\$*+[\]?{}.=!:(|)])/g,"\\$1");i=i.replace(RegExp("\\b(behavior:\\s*?url\\('?\"?)"+n,"gi"),"$1")}var c=document.createElement("style");c.textContent=i,c.media=t.media,c.disabled=t.disabled,c.setAttribute("data-href",t.getAttribute("href")),l.insertBefore(c,t),l.removeChild(t),c.media=t.media}};try{h.open("GET",n),h.send(null)}catch(t){"undefined"!=typeof XDomainRequest&&((h=new XDomainRequest).onerror=h.onprogress=function(){},h.onload=i,h.open("GET",n),h.send(null))}t.setAttribute("data-inprogress","")},styleElement:function(t){if(!t.hasAttribute("data-noprefix")){var i=t.disabled;t.textContent=e.fix(t.textContent,!0,t),t.disabled=i}},styleAttribute:function(t){var i=t.getAttribute("style");i=e.fix(i,!1,t),t.setAttribute("style",i)},process:function(){t("style").forEach(StyleFix.styleElement),t("[style]").forEach(StyleFix.styleAttribute)},register:function(t,i){(e.fixers=e.fixers||[]).splice(void 0===i?e.fixers.length:i,0,t)},fix:function(t,i,n){for(var a=0;a<e.fixers.length;a++)t=e.fixers[a](t,i,n)||t;return t},camelCase:function(t){return t.replace(/-([a-z])/g,(function(t,e){return e.toUpperCase()})).replace("-","")},deCamelCase:function(t){return t.replace(/[A-Z]/g,(function(t){return"-"+t.toLowerCase()}))}};setTimeout((function(){}),10),document.addEventListener("DOMContentLoaded",StyleFix.process,!1)}})(),function(t){function e(t,e,n,a,r){if((t=i[t]).length){var s=RegExp(e+"("+t.join("|")+")"+n,"gi");r=r.replace(s,a)}return r}if(window.StyleFix&&window.getComputedStyle){var i=window.PrefixFree={prefixCSS:function(t,n,a){var r=i.prefix;if(i.functions.indexOf("linear-gradient")>-1&&(t=t.replace(/(\s|:|,)(repeating-)?linear-gradient\(\s*(-?\d*\.?\d*)deg/gi,(function(t,e,i,n){return e+(i||"")+"linear-gradient("+(90-n)+"deg"}))),t=e("functions","(\\s|:|,)","\\s*\\(","$1"+r+"$2(",t),t=e("keywords","(\\s|:)","(\\s|;|\\}|$)","$1"+r+"$2$3",t),t=e("properties","(^|\\{|\\s|;)","\\s*:","$1"+r+"$2:",t),i.properties.length){var s=RegExp("\\b("+i.properties.join("|")+")(?!:)","gi");t=e("valueProperties","\\b",":(.+?);",(function(t){return t.replace(s,r+"$1")}),t)}return n&&(t=e("selectors","","\\b",i.prefixSelector,t),t=e("atrules","@","\\b","@"+r+"$1",t)),t=(t=t.replace(RegExp("-"+r,"g"),"-")).replace(/-\*-(?=[a-z]+)/gi,i.prefix)},property:function(t){return(i.properties.indexOf(t)?i.prefix:"")+t},value:function(t,n){return t=e("functions","(^|\\s|,)","\\s*\\(","$1"+i.prefix+"$2(",t),t=e("keywords","(^|\\s)","(\\s|$)","$1"+i.prefix+"$2$3",t)},prefixSelector:function(t){return t.replace(/^:{1,2}/,(function(t){return t+i.prefix}))},prefixProperty:function(t,e){var n=i.prefix+t;return e?StyleFix.camelCase(n):n}};(function(){var t={},e=[],n=getComputedStyle(document.documentElement,null),a=document.createElement("div").style,r=function(i){if("-"===i.charAt(0)){e.push(i);var n=i.split("-"),a=n[1];for(t[a]=++t[a]||1;n.length>3;){n.pop();var r=n.join("-");s(r)&&-1===e.indexOf(r)&&e.push(r)}}},s=function(t){return StyleFix.camelCase(t)in a};if(n.length>0)for(var o=0;o<n.length;o++)r(n[o]);else for(var l in n)r(StyleFix.deCamelCase(l));var h={uses:0};for(var c in t){var p=t[c];h.uses<p&&(h={prefix:c,uses:p})}i.prefix="-"+h.prefix+"-",i.Prefix=StyleFix.camelCase(i.prefix),i.properties=[];for(o=0;o<e.length;o++){if(0===(l=e[o]).indexOf(i.prefix)){var d=l.slice(i.prefix.length);s(d)||i.properties.push(d)}}"Ms"==i.Prefix&&!("transform"in a)&&!("MsTransform"in a)&&"msTransform"in a&&i.properties.push("transform","transform-origin"),i.properties.sort()})(),function(){function t(t,e){return a[e]="",a[e]=t,!!a[e]}var e={"linear-gradient":{property:"backgroundImage",params:"red, teal"},calc:{property:"width",params:"1px + 5%"},element:{property:"backgroundImage",params:"#foo"},"cross-fade":{property:"backgroundImage",params:"url(a.png), url(b.png), 50%"}};e["repeating-linear-gradient"]=e["repeating-radial-gradient"]=e["radial-gradient"]=e["linear-gradient"];var n={initial:"color","zoom-in":"cursor","zoom-out":"cursor",box:"display",flexbox:"display","inline-flexbox":"display",flex:"display","inline-flex":"display",grid:"display","inline-grid":"display","min-content":"width"};i.functions=[],i.keywords=[];var a=document.createElement("div").style;for(var r in e){var s=e[r],o=s.property,l=r+"("+s.params+")";!t(l,o)&&t(i.prefix+l,o)&&i.functions.push(r)}for(var h in n){!t(h,o=n[h])&&t(i.prefix+h,o)&&i.keywords.push(h)}}(),function(){function e(t){return r.textContent=t+"{}",!!r.sheet.cssRules.length}var n={":read-only":null,":read-write":null,":any-link":null,"::selection":null},a={keyframes:"name",viewport:null,document:'regexp(".")'};i.selectors=[],i.atrules=[];var r=t.appendChild(document.createElement("style"));for(var s in n){!e(l=s+(n[s]?"("+n[s]+")":""))&&e(i.prefixSelector(l))&&i.selectors.push(s)}for(var o in a){var l;!e("@"+(l=o+" "+(a[o]||"")))&&e("@"+i.prefix+l)&&i.atrules.push(o)}t.removeChild(r)}(),i.valueProperties=["transition","transition-property"],t.className+=" "+i.prefix,StyleFix.register(i.prefixCSS)}}(document.documentElement)})),define("yanhua",[],(function(t,e,i){var n,a=(n=document.getElementsByTagName("html")[0],function(){return parseInt(window.getComputedStyle(n).fontSize)}),r=function(){var t=this,e=function(t,e){return~~(Math.random()*(e-t+1)+t)};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},t.init=function(){t.dt=0,t.oldTime=Date.now(),t.canvas=document.createElement("canvas"),t.canvasContainer=$("#yanhua");document.getElementById("canvas-container");function e(t){return parseInt(t)/a()}t.canvas.onselectstart=function(){return!1},t.canvas.width=t.cw=e($("#yanhua").width())*parseFloat(document.querySelector("html").style.fontSize),t.canvas.height=t.ch=e($("#yanhua").height())*parseFloat(document.querySelector("html").style.fontSize),t.particles=[],t.partCount=60,t.fireworks=[],t.mx=t.cw/2,t.my=t.ch/2,t.currentHue=170,t.partSpeed=5,t.partSpeedVariance=10,t.partWind=50,t.partFriction=25,t.partGravity=1,t.hueMin=200,t.hueMax=360,t.fworkSpeed=2,t.fworkAccel=4,t.hueVariance=30,t.flickerDensity=20,t.showShockwave=!0,t.showTarget=!1,t.clearAlpha=25,t.canvasContainer.append(t.canvas),t.ctx=t.canvas.getContext("2d"),t.ctx.lineCap="round",t.ctx.lineJoin="round",t.lineWidth=1,t.bindEvents(),t.canvasLoop(),t.canvas.onselectstart=function(){return!1}};var i=function(i,n,a){this.x=i,this.y=n,this.coordLast=[{x:i,y:n},{x:i,y:n},{x:i,y:n}],this.angle=e(0,360),this.speed=e(t.partSpeed-t.partSpeedVariance<=0?1:t.partSpeed-t.partSpeedVariance,t.partSpeed+t.partSpeedVariance),this.friction=1-t.partFriction/100,this.gravity=t.partGravity/2,this.hue=e(a-t.hueVariance,a+t.hueVariance),this.brightness=e(50,80),this.alpha=e(40,100)/100,this.decay=e(10,50)/1e3,this.wind=(e(0,t.partWind)-t.partWind/2)/25,this.lineWidth=t.lineWidth};i.prototype.update=function(e){var i,n,a,r,s,o,l,h,c=this.angle*Math.PI/180,p=Math.cos(c)*this.speed,d=Math.sin(c)*this.speed+this.gravity;this.speed*=this.friction,this.coordLast[2].x=this.coordLast[1].x,this.coordLast[2].y=this.coordLast[1].y,this.coordLast[1].x=this.coordLast[0].x,this.coordLast[1].y=this.coordLast[0].y,this.coordLast[0].x=this.x,this.coordLast[0].y=this.y,this.x+=p*t.dt,this.y+=d*t.dt,this.angle+=this.wind,this.alpha-=this.decay,i=0,n=0,a=t.cw,r=t.ch,s=this.x-this.radius,o=this.y-this.radius,l=2*this.radius,h=2*this.radius,(i+a<s||s+l<i||n+r<o||o+h<n||this.alpha<.05)&&t.particles.splice(e,1)},i.prototype.draw=function(){var i=e(1,3)-1;if(t.ctx.beginPath(),t.ctx.moveTo(Math.round(this.coordLast[i].x),Math.round(this.coordLast[i].y)),t.ctx.lineTo(Math.round(this.x),Math.round(this.y)),t.ctx.closePath(),t.ctx.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+this.alpha+")",t.ctx.stroke(),t.flickerDensity>0){var n=50-t.flickerDensity;if(e(0,n)===n){t.ctx.beginPath(),t.ctx.arc(Math.round(this.x),Math.round(this.y),e(this.lineWidth,this.lineWidth+3)/2,0,2*Math.PI,!1),t.ctx.closePath();var a=e(50,100)/100;t.ctx.fillStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+a+")",t.ctx.fill()}}},t.createParticles=function(e,n,a){for(var r=t.partCount;r--;)t.particles.push(new i(e,n,a))},t.updateParticles=function(){for(var e=t.particles.length;e--;){t.particles[e].update(e)}},t.drawParticles=function(){for(var e=t.particles.length;e--;){t.particles[e].draw()}};var n=function(i,n,a,r){this.x=i,this.y=n,this.startX=i,this.startY=n,this.hitX=!1,this.hitY=!1,this.coordLast=[{x:i,y:n},{x:i,y:n},{x:i,y:n}],this.targetX=a,this.targetY=r,this.speed=t.fworkSpeed,this.angle=Math.atan2(r-n,a-i),this.shockwaveAngle=Math.atan2(r-n,a-i)+Math.PI/180*90,this.acceleration=t.fworkAccel/100,this.hue=t.currentHue,this.brightness=e(50,80),this.alpha=e(50,100)/100,this.lineWidth=t.lineWidth,this.targetRadius=1};n.prototype.update=function(i){if(t.ctx.lineWidth=this.lineWidth,vx=Math.cos(this.angle)*this.speed,vy=Math.sin(this.angle)*this.speed,this.speed*=1+this.acceleration,this.coordLast[2].x=this.coordLast[1].x,this.coordLast[2].y=this.coordLast[1].y,this.coordLast[1].x=this.coordLast[0].x,this.coordLast[1].y=this.coordLast[0].y,this.coordLast[0].x=this.x,this.coordLast[0].y=this.y,t.showTarget&&(this.targetRadius<8?this.targetRadius+=.25*t.dt:this.targetRadius=1*t.dt),this.startX>=this.targetX?this.x+vx<=this.targetX?(this.x=this.targetX,this.hitX=!0):this.x+=vx*t.dt:this.x+vx>=this.targetX?(this.x=this.targetX,this.hitX=!0):this.x+=vx*t.dt,this.startY>=this.targetY?this.y+vy<=this.targetY?(this.y=this.targetY,this.hitY=!0):this.y+=vy*t.dt:this.y+vy>=this.targetY?(this.y=this.targetY,this.hitY=!0):this.y+=vy*t.dt,this.hitX&&this.hitY){e(0,9);t.createParticles(this.targetX,this.targetY,this.hue),t.fireworks.splice(i,1)}},n.prototype.draw=function(){t.ctx.lineWidth=this.lineWidth;var i=e(1,3)-1;t.ctx.beginPath(),t.ctx.moveTo(Math.round(this.coordLast[i].x),Math.round(this.coordLast[i].y)),t.ctx.lineTo(Math.round(this.x),Math.round(this.y)),t.ctx.closePath(),t.ctx.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+this.alpha+")",t.ctx.stroke(),t.showTarget&&(t.ctx.save(),t.ctx.beginPath(),t.ctx.arc(Math.round(this.targetX),Math.round(this.targetY),this.targetRadius,0,2*Math.PI,!1),t.ctx.closePath(),t.ctx.lineWidth=1,t.ctx.stroke(),t.ctx.restore()),t.showShockwave&&(t.ctx.save(),t.ctx.translate(Math.round(this.x),Math.round(this.y)),t.ctx.rotate(this.shockwaveAngle),t.ctx.beginPath(),t.ctx.arc(0,0,this.speed/5*1,0,Math.PI,!0),t.ctx.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+e(25,60)/100+")",t.ctx.lineWidth=this.lineWidth,t.ctx.stroke(),t.ctx.restore())},t.createFireworks=function(e,i,a,r){t.fireworks.push(new n(e,i,a,r))},t.updateFireworks=function(){for(var e=t.fireworks.length;e--;){t.fireworks[e].update(e)}},t.drawFireworks=function(){for(var e=t.fireworks.length;e--;){t.fireworks[e].draw()}},t.bindEvents=function(){$(window).on("resize",(function(){clearTimeout(t.timeout),t.timeout=setTimeout((function(){t.ctx.lineCap="round",t.ctx.lineJoin="round"}),100)})),$(t.canvas).on("mousedown",(function(i){e(0,5);t.mx=i.pageX-t.canvasContainer.offset().left,t.my=i.pageY-t.canvasContainer.offset().top,t.currentHue=e(t.hueMin,t.hueMax),t.createFireworks(t.cw/2,t.ch,t.mx,t.my),$(t.canvas).on("mousemove.fireworks",(function(i){e(0,5);t.mx=i.pageX-t.canvasContainer.offset().left,t.my=i.pageY-t.canvasContainer.offset().top,t.currentHue=e(t.hueMin,t.hueMax),t.createFireworks(t.cw/2,t.ch,t.mx,t.my)}))})),$(t.canvas).on("mouseup",(function(e){$(t.canvas).off("mousemove.fireworks")}))},t.clear=function(){t.particles=[],t.fireworks=[],t.ctx.clearRect(0,0,t.cw,t.ch)},t.updateDelta=function(){var e=Date.now();t.dt=(e-t.oldTime)/16,t.dt=t.dt>5?5:t.dt,t.oldTime=e},t.canvasLoop=function(){requestAnimFrame(t.canvasLoop,t.canvas),t.updateDelta(),t.ctx.globalCompositeOperation="destination-out",t.ctx.fillStyle="rgba(0,0,0,"+t.clearAlpha/100+")",t.ctx.fillRect(0,0,t.cw,t.ch),t.ctx.globalCompositeOperation="lighter",t.updateFireworks(),t.updateParticles(),t.drawFireworks(),t.drawParticles()},t.init();for(var r,s,o,l=3;l--;)setTimeout((function(){t.fireworks.push(new n(t.cw/2,t.ch,e(30,t.cw-50),e(50,t.ch/2)))}),500*l);void 0!==document.hidden?("hidden",s="visibilitychange",r="visibilityState"):void 0!==document.mozHidden?("mozHidden",s="mozvisibilitychange",r="mozVisibilityState"):void 0!==document.msHidden?("msHidden",s="msvisibilitychange",r="msVisibilityState"):void 0!==document.webkitHidden&&("webkitHidden",s="webkitvisibilitychange",r="webkitVisibilityState"),document.addEventListener(s,(function(){"visible"==document[r]?o=setInterval((function(){for(var i=3;i--;)setTimeout((function(){t.fireworks.push(new n(t.cw/2,t.ch,e(30,t.cw-50),e(50,t.ch/2)))}),500*i)}),4e3):clearInterval(o)}),!1),o=setInterval((function(){for(var i=3;i--;)setTimeout((function(){t.fireworks.push(new n(t.cw/2,t.ch,e(30,t.cw-50),e(50,t.ch/2)))}),500*i)}),4e3)};setTimeout((function(){new r}),1e3)})),define("Snow",["ThreeCanvas"],(function(t,e,i){var n=t("./ThreeCanvas");Particle3D=function(t){n.Particle.call(this,t),this.velocity=new n.Vector3(0,-8,0),this.velocity.rotateX(r(-45,45)),this.velocity.rotateY(r(0,360)),this.gravity=new n.Vector3(0,0,0),this.drag=1},Particle3D.prototype=new n.Particle,Particle3D.prototype.constructor=Particle3D,Particle3D.prototype.updatePhysics=function(){this.velocity.multiplyScalar(this.drag),this.velocity.addSelf(this.gravity),this.position.addSelf(this.velocity)};var a=Math.PI/180;function r(t,e){return Math.random()*(e-t)+t}n.Vector3.prototype.rotateY=function(t){cosRY=Math.cos(t*a),sinRY=Math.sin(t*a);var e=this.z,i=this.x;this.x=i*cosRY+e*sinRY,this.z=i*-sinRY+e*cosRY},n.Vector3.prototype.rotateX=function(t){cosRY=Math.cos(t*a),sinRY=Math.sin(t*a);var e=this.z,i=this.y;this.y=i*cosRY+e*sinRY,this.z=i*-sinRY+e*cosRY},n.Vector3.prototype.rotateZ=function(t){cosRY=Math.cos(t*a),sinRY=Math.sin(t*a);var e=this.x,i=this.y;this.y=i*cosRY+e*sinRY,this.x=i*-sinRY+e*cosRY},i.exports=Particle3D})),define("ThreeCanvas",[],(function(t,e,i){var n=n||{};self.Int32Array||(self.Int32Array=Array,self.Float32Array=Array),n.Color=function(t){return void 0!==t&&this.setHex(t),this},n.Color.prototype={constructor:n.Color,r:1,g:1,b:1,copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t){return this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b,this},copyLinearToGamma:function(t){return this.r=Math.sqrt(t.r),this.g=Math.sqrt(t.g),this.b=Math.sqrt(t.b),this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSV:function(t,e,i){var n,a,r;if(0===i)this.r=this.g=this.b=0;else switch(n=Math.floor(6*t),a=6*t-n,t=i*(1-e),r=i*(1-e*a),e=i*(1-e*(1-a)),n){case 1:this.r=r,this.g=i,this.b=t;break;case 2:this.r=t,this.g=i,this.b=e;break;case 3:this.r=t,this.g=r,this.b=i;break;case 4:this.r=e,this.g=t,this.b=i;break;case 5:this.r=i,this.g=t,this.b=r;break;case 6:case 0:this.r=i,this.g=e,this.b=t}return this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},getHex:function(){return~~(255*this.r)<<16^~~(255*this.g)<<8^~~(255*this.b)},getContextStyle:function(){return"rgb("+Math.floor(255*this.r)+","+Math.floor(255*this.g)+","+Math.floor(255*this.b)+")"},clone:function(){return(new n.Color).setRGB(this.r,this.g,this.b)}},n.Vector2=function(t,e){this.x=t||0,this.y=e||0},n.Vector2.prototype={constructor:n.Vector2,set:function(t,e){return this.x=t,this.y=e,this},copy:function(t){return this.x=t.x,this.y=t.y,this},clone:function(){return new n.Vector2(this.x,this.y)},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return t?(this.x/=t,this.y/=t):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t){return t.x===this.x&&t.y===this.y}},n.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},n.Vector3.prototype={constructor:n.Vector3,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},clone:function(){return new n.Vector3(this.x,this.y,this.z)},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},multiply:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},multiplySelf:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},divideSelf:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return t?(this.x/=t,this.y/=t,this.z/=t):this.z=this.y=this.x=0,this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return this.x+this.y+this.z},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.normalize().multiplyScalar(t)},cross:function(t,e){return this.x=t.y*e.z-t.z*e.y,this.y=t.z*e.x-t.x*e.z,this.z=t.x*e.y-t.y*e.x,this},crossSelf:function(t){var e=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-i*t.x,this},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){return(new n.Vector3).sub(this,t).lengthSq()},setPositionFromMatrix:function(t){this.x=t.n14,this.y=t.n24,this.z=t.n34},setRotationFromMatrix:function(t){var e=Math.cos(this.y);this.y=Math.asin(t.n13),Math.abs(e)>1e-5?(this.x=Math.atan2(-t.n23/e,t.n33/e),this.z=Math.atan2(-t.n12/e,t.n11/e)):(this.x=0,this.z=Math.atan2(t.n21,t.n22))},isZero:function(){return this.lengthSq()<1e-4}},n.Vector4=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1},n.Vector4.prototype={constructor:n.Vector4,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},copy:function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1},clone:function(){return new n.Vector4(this.x,this.y,this.z,this.w)},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},divideScalar:function(t){return t?(this.x/=t,this.y/=t,this.z/=t,this.w/=t):(this.z=this.y=this.x=0,this.w=1),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.normalize().multiplyScalar(t)},lerpSelf:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}},n.Ray=function(t,e){function i(t,e,i){return S.sub(i,t),(d=S.dot(e))<=0?null:(u=M.add(t,T.copy(e).multiplyScalar(d)),i.distanceTo(u))}function a(t,e,i,n){return S.sub(n,e),M.sub(i,e),T.sub(t,e),f=S.dot(S),m=S.dot(M),g=S.dot(T),v=M.dot(M),w=M.dot(T),b=(f*w-m*g)*(x=1/(f*v-m*m)),(y=(v*g-m*w)*x)>=0&&b>=0&&y+b<1}this.origin=t||new n.Vector3,this.direction=e||new n.Vector3,this.intersectScene=function(t){return this.intersectObjects(t.children)},this.intersectObjects=function(t){var e,i,n=[];for(e=0,i=t.length;e<i;e++)Array.prototype.push.apply(n,this.intersectObject(t[e]));return n.sort((function(t,e){return t.distance-e.distance})),n};var r=new n.Vector3,s=new n.Vector3,o=new n.Vector3,l=new n.Vector3,h=(t=new n.Vector3,e=new n.Vector3,new n.Vector3),c=new n.Vector3,p=new n.Vector3;this.intersectObject=function(d){for(var u,f=[],m=0,g=d.children.length;m<g;m++)Array.prototype.push.apply(f,this.intersectObject(d.children[m]));if(d instanceof n.Particle){if(null===(m=i(this.origin,this.direction,d.matrixWorld.getPosition()))||m>d.scale.x)return[];u={distance:m,point:d.position,face:null,object:d},f.push(u)}else if(d instanceof n.Mesh){if(null===(m=i(this.origin,this.direction,d.matrixWorld.getPosition()))||m>d.geometry.boundingSphere.radius*Math.max(d.scale.x,Math.max(d.scale.y,d.scale.z)))return f;var v,w,x=d.geometry,y=x.vertices;for(d.matrixRotationWorld.extractRotation(d.matrixWorld),m=0,g=x.faces.length;m<g;m++)u=x.faces[m],t.copy(this.origin),e.copy(this.direction),w=d.matrixWorld,(v=(h=w.multiplyVector3(h.copy(u.centroid)).subSelf(t)).dot(e))<=0||(r=w.multiplyVector3(r.copy(y[u.a].position)),s=w.multiplyVector3(s.copy(y[u.b].position)),o=w.multiplyVector3(o.copy(y[u.c].position)),u instanceof n.Face4&&(l=w.multiplyVector3(l.copy(y[u.d].position))),c=d.matrixRotationWorld.multiplyVector3(c.copy(u.normal)),v=e.dot(c),!d.doubleSided&&!(d.flipSided?v>0:v<0))||(v=c.dot(h.sub(r,t))/v,p.add(t,e.multiplyScalar(v)),u instanceof n.Face3?a(p,r,s,o)&&(u={distance:t.distanceTo(p),point:p.clone(),face:u,object:d},f.push(u)):u instanceof n.Face4&&(a(p,r,s,l)||a(p,s,o,l))&&(u={distance:t.distanceTo(p),point:p.clone(),face:u,object:d},f.push(u)))}return f};var d,u,f,m,g,v,w,x,y,b,S=new n.Vector3,M=new n.Vector3,T=new n.Vector3},n.Rectangle=function(){function t(){r=n-e,s=a-i}var e,i,n,a,r,s,o=!0;this.getX=function(){return e},this.getY=function(){return i},this.getWidth=function(){return r},this.getHeight=function(){return s},this.getLeft=function(){return e},this.getTop=function(){return i},this.getRight=function(){return n},this.getBottom=function(){return a},this.set=function(r,s,l,h){o=!1,e=r,i=s,n=l,a=h,t()},this.addPoint=function(r,s){o?(o=!1,e=r,i=s,n=r,a=s):(e=e<r?e:r,i=i<s?i:s,n=n>r?n:r,a=a>s?a:s),t()},this.add3Points=function(r,s,l,h,c,p){o?(o=!1,e=r<l?r<c?r:c:l<c?l:c,i=s<h?s<p?s:p:h<p?h:p,n=r>l?r>c?r:c:l>c?l:c,a=s>h?s>p?s:p:h>p?h:p):(e=r<l?r<c?r<e?r:e:c<e?c:e:l<c?l<e?l:e:c<e?c:e,i=s<h?s<p?s<i?s:i:p<i?p:i:h<p?h<i?h:i:p<i?p:i,n=r>l?r>c?r>n?r:n:c>n?c:n:l>c?l>n?l:n:c>n?c:n,a=s>h?s>p?s>a?s:a:p>a?p:a:h>p?h>a?h:a:p>a?p:a),t()},this.addRectangle=function(r){o?(o=!1,e=r.getLeft(),i=r.getTop(),n=r.getRight(),a=r.getBottom()):(e=e<r.getLeft()?e:r.getLeft(),i=i<r.getTop()?i:r.getTop(),n=n>r.getRight()?n:r.getRight(),a=a>r.getBottom()?a:r.getBottom()),t()},this.inflate=function(r){e-=r,i-=r,n+=r,a+=r,t()},this.minSelf=function(r){e=e>r.getLeft()?e:r.getLeft(),i=i>r.getTop()?i:r.getTop(),n=n<r.getRight()?n:r.getRight(),a=a<r.getBottom()?a:r.getBottom(),t()},this.intersects=function(t){return Math.min(n,t.getRight())-Math.max(e,t.getLeft())>=0&&Math.min(a,t.getBottom())-Math.max(i,t.getTop())>=0},this.empty=function(){o=!0,a=n=i=e=0,t()},this.isEmpty=function(){return o}},n.Math={clamp:function(t,e,i){return t<e?e:t>i?i:t},clampBottom:function(t,e){return t<e?e:t},mapLinear:function(t,e,i,n,a){return n+(t-e)*(a-n)/(i-e)},random16:function(){return(65280*Math.random()+255*Math.random())/65535}},n.Matrix3=function(){this.m=[]},n.Matrix3.prototype={constructor:n.Matrix3,transpose:function(){var t,e=this.m;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},transposeIntoArray:function(t){var e=this.m;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}},n.Matrix4=function(t,e,i,a,r,s,o,l,h,c,p,d,u,f,m,g){this.set(void 0!==t?t:1,e||0,i||0,a||0,r||0,void 0!==s?s:1,o||0,l||0,h||0,c||0,void 0!==p?p:1,d||0,u||0,f||0,m||0,void 0!==g?g:1),this.flat=Array(16),this.m33=new n.Matrix3},n.Matrix4.prototype={constructor:n.Matrix4,set:function(t,e,i,n,a,r,s,o,l,h,c,p,d,u,f,m){return this.n11=t,this.n12=e,this.n13=i,this.n14=n,this.n21=a,this.n22=r,this.n23=s,this.n24=o,this.n31=l,this.n32=h,this.n33=c,this.n34=p,this.n41=d,this.n42=u,this.n43=f,this.n44=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){return this.set(t.n11,t.n12,t.n13,t.n14,t.n21,t.n22,t.n23,t.n24,t.n31,t.n32,t.n33,t.n34,t.n41,t.n42,t.n43,t.n44),this},lookAt:function(t,e,i){var a=n.Matrix4.__v1,r=n.Matrix4.__v2,s=n.Matrix4.__v3;return s.sub(t,e).normalize(),0===s.length()&&(s.z=1),a.cross(i,s).normalize(),0===a.length()&&(s.x+=1e-4,a.cross(i,s).normalize()),r.cross(s,a).normalize(),this.n11=a.x,this.n12=r.x,this.n13=s.x,this.n21=a.y,this.n22=r.y,this.n23=s.y,this.n31=a.z,this.n32=r.z,this.n33=s.z,this},multiply:function(t,e){var i=t.n11,n=t.n12,a=t.n13,r=t.n14,s=t.n21,o=t.n22,l=t.n23,h=t.n24,c=t.n31,p=t.n32,d=t.n33,u=t.n34,f=t.n41,m=t.n42,g=t.n43,v=t.n44,w=e.n11,x=e.n12,y=e.n13,b=e.n14,S=e.n21,M=e.n22,T=e.n23,C=e.n24,z=e.n31,E=e.n32,P=e.n33,L=e.n34,k=e.n41,V=e.n42,I=e.n43,R=e.n44;return this.n11=i*w+n*S+a*z+r*k,this.n12=i*x+n*M+a*E+r*V,this.n13=i*y+n*T+a*P+r*I,this.n14=i*b+n*C+a*L+r*R,this.n21=s*w+o*S+l*z+h*k,this.n22=s*x+o*M+l*E+h*V,this.n23=s*y+o*T+l*P+h*I,this.n24=s*b+o*C+l*L+h*R,this.n31=c*w+p*S+d*z+u*k,this.n32=c*x+p*M+d*E+u*V,this.n33=c*y+p*T+d*P+u*I,this.n34=c*b+p*C+d*L+u*R,this.n41=f*w+m*S+g*z+v*k,this.n42=f*x+m*M+g*E+v*V,this.n43=f*y+m*T+g*P+v*I,this.n44=f*b+m*C+g*L+v*R,this},multiplySelf:function(t){return this.multiply(this,t)},multiplyToArray:function(t,e,i){return this.multiply(t,e),i[0]=this.n11,i[1]=this.n21,i[2]=this.n31,i[3]=this.n41,i[4]=this.n12,i[5]=this.n22,i[6]=this.n32,i[7]=this.n42,i[8]=this.n13,i[9]=this.n23,i[10]=this.n33,i[11]=this.n43,i[12]=this.n14,i[13]=this.n24,i[14]=this.n34,i[15]=this.n44,this},multiplyScalar:function(t){return this.n11*=t,this.n12*=t,this.n13*=t,this.n14*=t,this.n21*=t,this.n22*=t,this.n23*=t,this.n24*=t,this.n31*=t,this.n32*=t,this.n33*=t,this.n34*=t,this.n41*=t,this.n42*=t,this.n43*=t,this.n44*=t,this},multiplyVector3:function(t){var e=t.x,i=t.y,n=t.z,a=1/(this.n41*e+this.n42*i+this.n43*n+this.n44);return t.x=(this.n11*e+this.n12*i+this.n13*n+this.n14)*a,t.y=(this.n21*e+this.n22*i+this.n23*n+this.n24)*a,t.z=(this.n31*e+this.n32*i+this.n33*n+this.n34)*a,t},multiplyVector4:function(t){var e=t.x,i=t.y,n=t.z,a=t.w;return t.x=this.n11*e+this.n12*i+this.n13*n+this.n14*a,t.y=this.n21*e+this.n22*i+this.n23*n+this.n24*a,t.z=this.n31*e+this.n32*i+this.n33*n+this.n34*a,t.w=this.n41*e+this.n42*i+this.n43*n+this.n44*a,t},rotateAxis:function(t){var e=t.x,i=t.y,n=t.z;return t.x=e*this.n11+i*this.n12+n*this.n13,t.y=e*this.n21+i*this.n22+n*this.n23,t.z=e*this.n31+i*this.n32+n*this.n33,t.normalize(),t},crossVector:function(t){var e=new n.Vector4;return e.x=this.n11*t.x+this.n12*t.y+this.n13*t.z+this.n14*t.w,e.y=this.n21*t.x+this.n22*t.y+this.n23*t.z+this.n24*t.w,e.z=this.n31*t.x+this.n32*t.y+this.n33*t.z+this.n34*t.w,e.w=t.w?this.n41*t.x+this.n42*t.y+this.n43*t.z+this.n44*t.w:1,e},determinant:function(){var t=this.n11,e=this.n12,i=this.n13,n=this.n14,a=this.n21,r=this.n22,s=this.n23,o=this.n24,l=this.n31,h=this.n32,c=this.n33,p=this.n34,d=this.n41,u=this.n42,f=this.n43,m=this.n44;return n*s*h*d-i*o*h*d-n*r*c*d+e*o*c*d+i*r*p*d-e*s*p*d-n*s*l*u+i*o*l*u+n*a*c*u-t*o*c*u-i*a*p*u+t*s*p*u+n*r*l*f-e*o*l*f-n*a*h*f+t*o*h*f+e*a*p*f-t*r*p*f-i*r*l*m+e*s*l*m+i*a*h*m-t*s*h*m-e*a*c*m+t*r*c*m},transpose:function(){var t;return t=this.n21,this.n21=this.n12,this.n12=t,t=this.n31,this.n31=this.n13,this.n13=t,t=this.n32,this.n32=this.n23,this.n23=t,t=this.n41,this.n41=this.n14,this.n14=t,t=this.n42,this.n42=this.n24,this.n24=t,t=this.n43,this.n43=this.n34,this.n43=t,this},clone:function(){var t=new n.Matrix4;return t.n11=this.n11,t.n12=this.n12,t.n13=this.n13,t.n14=this.n14,t.n21=this.n21,t.n22=this.n22,t.n23=this.n23,t.n24=this.n24,t.n31=this.n31,t.n32=this.n32,t.n33=this.n33,t.n34=this.n34,t.n41=this.n41,t.n42=this.n42,t.n43=this.n43,t.n44=this.n44,t},flatten:function(){return this.flat[0]=this.n11,this.flat[1]=this.n21,this.flat[2]=this.n31,this.flat[3]=this.n41,this.flat[4]=this.n12,this.flat[5]=this.n22,this.flat[6]=this.n32,this.flat[7]=this.n42,this.flat[8]=this.n13,this.flat[9]=this.n23,this.flat[10]=this.n33,this.flat[11]=this.n43,this.flat[12]=this.n14,this.flat[13]=this.n24,this.flat[14]=this.n34,this.flat[15]=this.n44,this.flat},flattenToArray:function(t){return t[0]=this.n11,t[1]=this.n21,t[2]=this.n31,t[3]=this.n41,t[4]=this.n12,t[5]=this.n22,t[6]=this.n32,t[7]=this.n42,t[8]=this.n13,t[9]=this.n23,t[10]=this.n33,t[11]=this.n43,t[12]=this.n14,t[13]=this.n24,t[14]=this.n34,t[15]=this.n44,t},flattenToArrayOffset:function(t,e){return t[e]=this.n11,t[e+1]=this.n21,t[e+2]=this.n31,t[e+3]=this.n41,t[e+4]=this.n12,t[e+5]=this.n22,t[e+6]=this.n32,t[e+7]=this.n42,t[e+8]=this.n13,t[e+9]=this.n23,t[e+10]=this.n33,t[e+11]=this.n43,t[e+12]=this.n14,t[e+13]=this.n24,t[e+14]=this.n34,t[e+15]=this.n44,t},setTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},setScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},setRotationX:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},setRotationY:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},setRotationZ:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},setRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),a=1-i,r=t.x,s=t.y,o=t.z,l=a*r,h=a*s;return this.set(l*r+i,l*s-n*o,l*o+n*s,0,l*s+n*o,h*s+i,h*o-n*r,0,l*o-n*s,h*o+n*r,a*o*o+i,0,0,0,0,1),this},setPosition:function(t){return this.n14=t.x,this.n24=t.y,this.n34=t.z,this},getPosition:function(){return n.Matrix4.__v1.set(this.n14,this.n24,this.n34)},getColumnX:function(){return n.Matrix4.__v1.set(this.n11,this.n21,this.n31)},getColumnY:function(){return n.Matrix4.__v1.set(this.n12,this.n22,this.n32)},getColumnZ:function(){return n.Matrix4.__v1.set(this.n13,this.n23,this.n33)},getInverse:function(t){var e=t.n11,i=t.n12,n=t.n13,a=t.n14,r=t.n21,s=t.n22,o=t.n23,l=t.n24,h=t.n31,c=t.n32,p=t.n33,d=t.n34,u=t.n41,f=t.n42,m=t.n43,g=t.n44;return this.n11=o*d*f-l*p*f+l*c*m-s*d*m-o*c*g+s*p*g,this.n12=a*p*f-n*d*f-a*c*m+i*d*m+n*c*g-i*p*g,this.n13=n*l*f-a*o*f+a*s*m-i*l*m-n*s*g+i*o*g,this.n14=a*o*c-n*l*c-a*s*p+i*l*p+n*s*d-i*o*d,this.n21=l*p*u-o*d*u-l*h*m+r*d*m+o*h*g-r*p*g,this.n22=n*d*u-a*p*u+a*h*m-e*d*m-n*h*g+e*p*g,this.n23=a*o*u-n*l*u-a*r*m+e*l*m+n*r*g-e*o*g,this.n24=n*l*h-a*o*h+a*r*p-e*l*p-n*r*d+e*o*d,this.n31=s*d*u-l*c*u+l*h*f-r*d*f-s*h*g+r*c*g,this.n32=a*c*u-i*d*u-a*h*f+e*d*f+i*h*g-e*c*g,this.n33=n*l*u-a*s*u+a*r*f-e*l*f-i*r*g+e*s*g,this.n34=a*s*h-i*l*h-a*r*c+e*l*c+i*r*d-e*s*d,this.n41=o*c*u-s*p*u-o*h*f+r*p*f+s*h*m-r*c*m,this.n42=i*p*u-n*c*u+n*h*f-e*p*f-i*h*m+e*c*m,this.n43=n*s*u-i*o*u-n*r*f+e*o*f+i*r*m-e*s*m,this.n44=i*o*h-n*s*h+n*r*c-e*o*c-i*r*p+e*s*p,this.multiplyScalar(1/t.determinant()),this},setRotationFromEuler:function(t,e){var i=t.x,n=t.y,a=t.z,r=Math.cos(i),s=(i=Math.sin(i),Math.cos(n)),o=(n=Math.sin(n),Math.cos(a));a=Math.sin(a);switch(e){case"YXZ":var l=s*o,h=s*a,c=n*o,p=n*a;this.n11=l+p*i,this.n12=c*i-h,this.n13=r*n,this.n21=r*a,this.n22=r*o,this.n23=-i,this.n31=h*i-c,this.n32=p+l*i,this.n33=r*s;break;case"ZXY":l=s*o,h=s*a,c=n*o,p=n*a,this.n11=l-p*i,this.n12=-r*a,this.n13=c+h*i,this.n21=h+c*i,this.n22=r*o,this.n23=p-l*i,this.n31=-r*n,this.n32=i,this.n33=r*s;break;case"ZYX":l=r*o,h=r*a,c=i*o,p=i*a,this.n11=s*o,this.n12=c*n-h,this.n13=l*n+p,this.n21=s*a,this.n22=p*n+l,this.n23=h*n-c,this.n31=-n,this.n32=i*s,this.n33=r*s;break;case"YZX":l=r*s,h=r*n,c=i*s,p=i*n,this.n11=s*o,this.n12=p-l*a,this.n13=c*a+h,this.n21=a,this.n22=r*o,this.n23=-i*o,this.n31=-n*o,this.n32=h*a+c,this.n33=l-p*a;break;case"XZY":l=r*s,h=r*n,c=i*s,p=i*n,this.n11=s*o,this.n12=-a,this.n13=n*o,this.n21=l*a+p,this.n22=r*o,this.n23=h*a-c,this.n31=c*a-h,this.n32=i*o,this.n33=p*a+l;break;default:l=r*o,h=r*a,c=i*o,p=i*a,this.n11=s*o,this.n12=-s*a,this.n13=n,this.n21=h+c*n,this.n22=l-p*n,this.n23=-i*s,this.n31=p-l*n,this.n32=c+h*n,this.n33=r*s}return this},setRotationFromQuaternion:function(t){var e=t.x,i=t.y,n=t.z,a=t.w,r=e+e,s=i+i,o=n+n,l=(t=e*r,e*s);e*=o;var h=i*s;return i*=o,n*=o,r*=a,s*=a,a*=o,this.n11=1-(h+n),this.n12=l-a,this.n13=e+s,this.n21=l+a,this.n22=1-(t+n),this.n23=i-r,this.n31=e-s,this.n32=i+r,this.n33=1-(t+h),this},scale:function(t){var e=t.x,i=t.y;t=t.z;return this.n11*=e,this.n12*=i,this.n13*=t,this.n21*=e,this.n22*=i,this.n23*=t,this.n31*=e,this.n32*=i,this.n33*=t,this.n41*=e,this.n42*=i,this.n43*=t,this},compose:function(t,e,i){var a=n.Matrix4.__m1,r=n.Matrix4.__m2;return a.identity(),a.setRotationFromQuaternion(e),r.setScale(i.x,i.y,i.z),this.multiply(a,r),this.n14=t.x,this.n24=t.y,this.n34=t.z,this},decompose:function(t,e,i){var a=n.Matrix4.__v1,r=n.Matrix4.__v2,s=n.Matrix4.__v3;return a.set(this.n11,this.n21,this.n31),r.set(this.n12,this.n22,this.n32),s.set(this.n13,this.n23,this.n33),t=t instanceof n.Vector3?t:new n.Vector3,e=e instanceof n.Quaternion?e:new n.Quaternion,(i=i instanceof n.Vector3?i:new n.Vector3).x=a.length(),i.y=r.length(),i.z=s.length(),t.x=this.n14,t.y=this.n24,t.z=this.n34,(a=n.Matrix4.__m1).copy(this),a.n11/=i.x,a.n21/=i.x,a.n31/=i.x,a.n12/=i.y,a.n22/=i.y,a.n32/=i.y,a.n13/=i.z,a.n23/=i.z,a.n33/=i.z,e.setFromRotationMatrix(a),[t,e,i]},extractPosition:function(t){return this.n14=t.n14,this.n24=t.n24,this.n34=t.n34,this},extractRotation:function(t){var e=1/(a=n.Matrix4.__v1).set(t.n11,t.n21,t.n31).length(),i=1/a.set(t.n12,t.n22,t.n32).length(),a=1/a.set(t.n13,t.n23,t.n33).length();return this.n11=t.n11*e,this.n21=t.n21*e,this.n31=t.n31*e,this.n12=t.n12*i,this.n22=t.n22*i,this.n32=t.n32*i,this.n13=t.n13*a,this.n23=t.n23*a,this.n33=t.n33*a,this}},n.Matrix4.makeInvert3x3=function(t){var e=t.m33,i=e.m,n=t.n33*t.n22-t.n32*t.n23,a=-t.n33*t.n21+t.n31*t.n23,r=t.n32*t.n21-t.n31*t.n22,s=-t.n33*t.n12+t.n32*t.n13,o=t.n33*t.n11-t.n31*t.n13,l=-t.n32*t.n11+t.n31*t.n12,h=t.n23*t.n12-t.n22*t.n13,c=-t.n23*t.n11+t.n21*t.n13,p=t.n22*t.n11-t.n21*t.n12;return 0===(t=t.n11*n+t.n21*s+t.n31*h)&&console.error("THREE.Matrix4.makeInvert3x3: Matrix not invertible."),t=1/t,i[0]=t*n,i[1]=t*a,i[2]=t*r,i[3]=t*s,i[4]=t*o,i[5]=t*l,i[6]=t*h,i[7]=t*c,i[8]=t*p,e},n.Matrix4.makeFrustum=function(t,e,i,a,r,s){var o;return(o=new n.Matrix4).n11=2*r/(e-t),o.n12=0,o.n13=(e+t)/(e-t),o.n14=0,o.n21=0,o.n22=2*r/(a-i),o.n23=(a+i)/(a-i),o.n24=0,o.n31=0,o.n32=0,o.n33=-(s+r)/(s-r),o.n34=-2*s*r/(s-r),o.n41=0,o.n42=0,o.n43=-1,o.n44=0,o},n.Matrix4.makePerspective=function(t,e,i,a){var r;return r=-(t=i*Math.tan(t*Math.PI/360)),n.Matrix4.makeFrustum(r*e,t*e,r,t,i,a)},n.Matrix4.makeOrtho=function(t,e,i,a,r,s){var o,l,h,c;return l=e-t,h=i-a,c=s-r,(o=new n.Matrix4).n11=2/l,o.n12=0,o.n13=0,o.n14=-(e+t)/l,o.n21=0,o.n22=2/h,o.n23=0,o.n24=-(i+a)/h,o.n31=0,o.n32=0,o.n33=-2/c,o.n34=-(s+r)/c,o.n41=0,o.n42=0,o.n43=0,o.n44=1,o},n.Matrix4.__v1=new n.Vector3,n.Matrix4.__v2=new n.Vector3,n.Matrix4.__v3=new n.Vector3,n.Matrix4.__m1=new n.Matrix4,n.Matrix4.__m2=new n.Matrix4,n.Object3D=function(){this.name="",this.id=n.Object3DCount++,this.parent=void 0,this.children=[],this.up=new n.Vector3(0,1,0),this.position=new n.Vector3,this.rotation=new n.Vector3,this.eulerOrder="XYZ",this.scale=new n.Vector3(1,1,1),this.flipSided=this.doubleSided=this.dynamic=!1,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new n.Matrix4,this.matrixWorld=new n.Matrix4,this.matrixRotationWorld=new n.Matrix4,this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0,this.quaternion=new n.Quaternion,this.useQuaternion=!1,this.boundRadius=0,this.boundRadiusScale=1,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this._vector=new n.Vector3},n.Object3D.prototype={constructor:n.Object3D,translate:function(t,e){this.matrix.rotateAxis(e),this.position.addSelf(e.multiplyScalar(t))},translateX:function(t){this.translate(t,this._vector.set(1,0,0))},translateY:function(t){this.translate(t,this._vector.set(0,1,0))},translateZ:function(t){this.translate(t,this._vector.set(0,0,1))},lookAt:function(t){this.matrix.lookAt(t,this.position,this.up),this.rotationAutoUpdate&&this.rotation.setRotationFromMatrix(this.matrix)},add:function(t){if(-1===this.children.indexOf(t)){void 0!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t);for(var e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof n.Scene&&e.addObject(t)}},remove:function(t){var e=this.children.indexOf(t);if(-1!==e){for(t.parent=void 0,this.children.splice(e,1),e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof n.Scene&&e.removeObject(t)}},getChildByName:function(t,e){var i,n,a;for(i=0,n=this.children.length;i<n;i++){if((a=this.children[i]).name===t)return a;if(e&&void 0!==(a=a.getChildByName(t,e)))return a}},updateMatrix:function(){this.matrix.setPosition(this.position),this.useQuaternion?this.matrix.setRotationFromQuaternion(this.quaternion):this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder),1===this.scale.x&&1===this.scale.y&&1===this.scale.z||(this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,Math.max(this.scale.y,this.scale.z))),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent?this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;e<i;e++)this.children[e].updateMatrixWorld(t)}},n.Object3DCount=0,n.Projector=function(){function t(){var t=g[s]=g[s]||new n.RenderableObject;return s++,t}function e(){var t=v[l]=v[l]||new n.RenderableVertex;return l++,t}function i(t,e){return e.z-t.z}function a(t,e){var i=0,n=1,a=t.z+t.w,r=e.z+e.w,s=-t.z+t.w,o=-e.z+e.w;return a>=0&&r>=0&&s>=0&&o>=0||!(a<0&&r<0||s<0&&o<0)&&(a<0?i=Math.max(i,a/(a-r)):r<0&&(n=Math.min(n,a/(a-r))),s<0?i=Math.max(i,s/(s-o)):o<0&&(n=Math.min(n,s/(s-o))),!(n<i)&&(t.lerpSelf(e,i),e.lerpSelf(t,1-n),!0))}var r,s,o,l,h,c,p,d,u,f,m,g=[],v=[],w=[],x=[],y=[],b=[],S={objects:[],sprites:[],lights:[],elements:[]},M=new n.Vector3,T=new n.Vector4,C=new n.Matrix4,z=new n.Matrix4,E=[new n.Vector4,new n.Vector4,new n.Vector4,new n.Vector4,new n.Vector4,new n.Vector4],P=new n.Vector4,L=new n.Vector4;this.computeFrustum=function(t){for(E[0].set(t.n41-t.n11,t.n42-t.n12,t.n43-t.n13,t.n44-t.n14),E[1].set(t.n41+t.n11,t.n42+t.n12,t.n43+t.n13,t.n44+t.n14),E[2].set(t.n41+t.n21,t.n42+t.n22,t.n43+t.n23,t.n44+t.n24),E[3].set(t.n41-t.n21,t.n42-t.n22,t.n43-t.n23,t.n44-t.n24),E[4].set(t.n41-t.n31,t.n42-t.n32,t.n43-t.n33,t.n44-t.n34),E[5].set(t.n41+t.n31,t.n42+t.n32,t.n43+t.n33,t.n44+t.n34),t=0;t<6;t++){var e=E[t];e.divideScalar(Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z))}},this.projectVector=function(t,e){return e.matrixWorldInverse.getInverse(e.matrixWorld),C.multiply(e.projectionMatrix,e.matrixWorldInverse),C.multiplyVector3(t),t},this.unprojectVector=function(t,e){return e.projectionMatrixInverse.getInverse(e.projectionMatrix),C.multiply(e.matrixWorld,e.projectionMatrixInverse),C.multiplyVector3(t),t},this.pickingRay=function(t,e){var i;return t.z=-1,i=new n.Vector3(t.x,t.y,1),this.unprojectVector(t,e),this.unprojectVector(i,e),i.subSelf(t).normalize(),new n.Ray(t,i)},this.projectGraph=function(e,a){s=0,S.objects.length=0,S.sprites.length=0,S.lights.length=0;var o=function(e){if(!1!==e.visible){var i;if((i=e instanceof n.Mesh||e instanceof n.Line)&&!(i=!1===e.frustumCulled))t:{for(var a=e.matrixWorld,s=-e.geometry.boundingSphere.radius*Math.max(e.scale.x,Math.max(e.scale.y,e.scale.z)),l=0;l<6;l++)if((i=E[l].x*a.n14+E[l].y*a.n24+E[l].z*a.n34+E[l].w)<=s){i=!1;break t}i=!0}for(i?(C.multiplyVector3(M.copy(e.position)),(r=t()).object=e,r.z=M.z,S.objects.push(r)):e instanceof n.Sprite||e instanceof n.Particle?(C.multiplyVector3(M.copy(e.position)),(r=t()).object=e,r.z=M.z,S.sprites.push(r)):e instanceof n.Light&&S.lights.push(e),i=0,a=e.children.length;i<a;i++)o(e.children[i])}};return o(e),a&&S.objects.sort(i),S},this.projectScene=function(t,r,s){var g,M,E,k,V,I,R,_,D,A,W,O,B,Y,j,X,N=r.near,F=r.far;for(m=u=p=c=0,S.elements.length=0,void 0===r.parent&&(console.warn("DEPRECATED: Camera hasn't been added to a Scene. Adding it..."),t.add(r)),t.updateMatrixWorld(),r.matrixWorldInverse.getInverse(r.matrixWorld),C.multiply(r.projectionMatrix,r.matrixWorldInverse),this.computeFrustum(C),S=this.projectGraph(t,!1),t=0,g=S.objects.length;t<g;t++)if(A=(D=S.objects[t].object).matrixWorld,O=D.material,l=0,D instanceof n.Mesh){for(W=D.geometry,B=D.geometry.materials,k=W.vertices,Y=W.faces,j=W.faceVertexUvs,W=D.matrixRotationWorld.extractRotation(A),M=0,E=k.length;M<E;M++)(o=e()).positionWorld.copy(k[M].position),A.multiplyVector3(o.positionWorld),o.positionScreen.copy(o.positionWorld),C.multiplyVector4(o.positionScreen),o.positionScreen.x/=o.positionScreen.w,o.positionScreen.y/=o.positionScreen.w,o.visible=o.positionScreen.z>N&&o.positionScreen.z<F;for(k=0,M=Y.length;k<M;k++){if((E=Y[k])instanceof n.Face3){if(V=v[E.a],I=v[E.b],R=v[E.c],!(V.visible&&I.visible&&R.visible)||!D.doubleSided&&D.flipSided==(R.positionScreen.x-V.positionScreen.x)*(I.positionScreen.y-V.positionScreen.y)-(R.positionScreen.y-V.positionScreen.y)*(I.positionScreen.x-V.positionScreen.x)<0)continue;_=w[c]=w[c]||new n.RenderableFace3,c++,(h=_).v1.copy(V),h.v2.copy(I),h.v3.copy(R)}else if(E instanceof n.Face4){if(V=v[E.a],I=v[E.b],R=v[E.c],_=v[E.d],!(V.visible&&I.visible&&R.visible&&_.visible)||!D.doubleSided&&D.flipSided==((_.positionScreen.x-V.positionScreen.x)*(I.positionScreen.y-V.positionScreen.y)-(_.positionScreen.y-V.positionScreen.y)*(I.positionScreen.x-V.positionScreen.x)<0||(I.positionScreen.x-R.positionScreen.x)*(_.positionScreen.y-R.positionScreen.y)-(I.positionScreen.y-R.positionScreen.y)*(_.positionScreen.x-R.positionScreen.x)<0))continue;X=x[p]=x[p]||new n.RenderableFace4,p++,(h=X).v1.copy(V),h.v2.copy(I),h.v3.copy(R),h.v4.copy(_)}for(h.normalWorld.copy(E.normal),W.multiplyVector3(h.normalWorld),h.centroidWorld.copy(E.centroid),A.multiplyVector3(h.centroidWorld),h.centroidScreen.copy(h.centroidWorld),C.multiplyVector3(h.centroidScreen),V=0,I=(R=E.vertexNormals).length;V<I;V++)(_=h.vertexNormalsWorld[V]).copy(R[V]),W.multiplyVector3(_);for(V=0,I=j.length;V<I;V++)if(X=j[V][k])for(R=0,_=X.length;R<_;R++)h.uvs[V][R]=X[R];h.material=O,h.faceMaterial=null!==E.materialIndex?B[E.materialIndex]:null,h.z=h.centroidScreen.z,S.elements.push(h)}}else if(D instanceof n.Line)for(z.multiply(C,A),k=D.geometry.vertices,(V=e()).positionScreen.copy(k[0].position),z.multiplyVector4(V.positionScreen),M=1,E=k.length;M<E;M++)(V=e()).positionScreen.copy(k[M].position),z.multiplyVector4(V.positionScreen),I=v[l-2],P.copy(V.positionScreen),L.copy(I.positionScreen),a(P,L)&&(P.multiplyScalar(1/P.w),L.multiplyScalar(1/L.w),D=y[u]=y[u]||new n.RenderableLine,u++,(d=D).v1.positionScreen.copy(P),d.v2.positionScreen.copy(L),d.z=Math.max(P.z,L.z),d.material=O,S.elements.push(d));for(t=0,g=S.sprites.length;t<g;t++)A=(D=S.sprites[t].object).matrixWorld,D instanceof n.Particle&&(T.set(A.n14,A.n24,A.n34,1),C.multiplyVector4(T),T.z/=T.w,T.z>0&&T.z<1)&&(N=b[m]=b[m]||new n.RenderableParticle,m++,(f=N).x=T.x/T.w,f.y=T.y/T.w,f.z=T.z,f.rotation=D.rotation.z,f.scale.x=D.scale.x*Math.abs(f.x-(T.x+r.projectionMatrix.n11)/(T.w+r.projectionMatrix.n14)),f.scale.y=D.scale.y*Math.abs(f.y-(T.y+r.projectionMatrix.n22)/(T.w+r.projectionMatrix.n24)),f.material=D.material,S.elements.push(f));return s&&S.elements.sort(i),S}},n.Quaternion=function(t,e,i,n){this.set(t||0,e||0,i||0,void 0!==n?n:1)},n.Quaternion.prototype={constructor:n.Quaternion,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEuler:function(t){var e=Math.PI/360,i=t.x*e,n=t.y*e,a=t.z*e,r=(t=Math.cos(n),n=Math.sin(n),e=Math.cos(-a),a=Math.sin(-a),Math.cos(i)),s=(i=Math.sin(i),t*e),o=n*a;return this.w=s*r-o*i,this.x=s*i+o*r,this.y=n*e*r+t*a*i,this.z=t*a*r-n*e*i,this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Math.cos(i),this},setFromRotationMatrix:function(t){var e=Math.pow(t.determinant(),1/3);return this.w=Math.sqrt(Math.max(0,e+t.n11+t.n22+t.n33))/2,this.x=Math.sqrt(Math.max(0,e+t.n11-t.n22-t.n33))/2,this.y=Math.sqrt(Math.max(0,e-t.n11+t.n22-t.n33))/2,this.z=Math.sqrt(Math.max(0,e-t.n11-t.n22+t.n33))/2,this.x=t.n32-t.n23<0?-Math.abs(this.x):Math.abs(this.x),this.y=t.n13-t.n31<0?-Math.abs(this.y):Math.abs(this.y),this.z=t.n21-t.n12<0?-Math.abs(this.z):Math.abs(this.z),this.normalize(),this},calculateW:function(){return this.w=-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z)),this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===t?this.w=this.z=this.y=this.x=0:(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},multiplySelf:function(t){var e=this.x,i=this.y,n=this.z,a=this.w,r=t.x,s=t.y,o=t.z;t=t.w;return this.x=e*t+a*r+i*o-n*s,this.y=i*t+a*s+n*r-e*o,this.z=n*t+a*o+e*s-i*r,this.w=a*t-e*r-i*s-n*o,this},multiply:function(t,e){return this.x=t.x*e.w+t.y*e.z-t.z*e.y+t.w*e.x,this.y=-t.x*e.z+t.y*e.w+t.z*e.x+t.w*e.y,this.z=t.x*e.y-t.y*e.x+t.z*e.w+t.w*e.z,this.w=-t.x*e.x-t.y*e.y-t.z*e.z+t.w*e.w,this},multiplyVector3:function(t,e){e||(e=t);var i=t.x,n=t.y,a=t.z,r=this.x,s=this.y,o=this.z,l=this.w,h=l*i+s*a-o*n,c=l*n+o*i-r*a,p=l*a+r*n-s*i;i=-r*i-s*n-o*a;return e.x=h*l+i*-r+c*-o-p*-s,e.y=c*l+i*-s+p*-r-h*-o,e.z=p*l+i*-o+h*-s-c*-r,e}},n.Quaternion.slerp=function(t,e,i,n){if((r=t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z)<0?(i.w=-e.w,i.x=-e.x,i.y=-e.y,i.z=-e.z,r=-r):i.copy(e),Math.abs(r)>=1)return i.w=t.w,i.x=t.x,i.y=t.y,i.z=t.z,i;var a=Math.acos(r),r=Math.sqrt(1-r*r);return Math.abs(r)<.001?(i.w=.5*(t.w+e.w),i.x=.5*(t.x+e.x),i.y=.5*(t.y+e.y),i.z=.5*(t.z+e.z),i):(e=Math.sin((1-n)*a)/r,n=Math.sin(n*a)/r,i.w=t.w*e+i.w*n,i.x=t.x*e+i.x*n,i.y=t.y*e+i.y*n,i.z=t.z*e+i.z*n,i)},n.Vertex=function(t){this.position=t||new n.Vector3},n.Face3=function(t,e,i,a,r,s){this.a=t,this.b=e,this.c=i,this.normal=a instanceof n.Vector3?a:new n.Vector3,this.vertexNormals=a instanceof Array?a:[],this.color=r instanceof n.Color?r:new n.Color,this.vertexColors=r instanceof Array?r:[],this.vertexTangents=[],this.materialIndex=s,this.centroid=new n.Vector3},n.Face4=function(t,e,i,a,r,s,o){this.a=t,this.b=e,this.c=i,this.d=a,this.normal=r instanceof n.Vector3?r:new n.Vector3,this.vertexNormals=r instanceof Array?r:[],this.color=s instanceof n.Color?s:new n.Color,this.vertexColors=s instanceof Array?s:[],this.vertexTangents=[],this.materialIndex=o,this.centroid=new n.Vector3},n.UV=function(t,e){this.u=t||0,this.v=e||0},n.UV.prototype={constructor:n.UV,set:function(t,e){return this.u=t,this.v=e,this},copy:function(t){return this.u=t.u,this.v=t.v,this},clone:function(){return new n.UV(this.u,this.v)}},n.Geometry=function(){this.id=n.GeometryCount++,this.vertices=[],this.colors=[],this.materials=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.dynamic=this.hasTangents=!1},n.Geometry.prototype={constructor:n.Geometry,applyMatrix:function(t){var e=new n.Matrix4;e.extractRotation(t,new n.Vector3(1,1,1));for(var i=0,a=this.vertices.length;i<a;i++)t.multiplyVector3(this.vertices[i].position);for(i=0,a=this.faces.length;i<a;i++){var r=this.faces[i];e.multiplyVector3(r.normal);for(var s=0,o=r.vertexNormals.length;s<o;s++)e.multiplyVector3(r.vertexNormals[s]);t.multiplyVector3(r.centroid)}},computeCentroids:function(){var t,e,i;for(t=0,e=this.faces.length;t<e;t++)(i=this.faces[t]).centroid.set(0,0,0),i instanceof n.Face3?(i.centroid.addSelf(this.vertices[i.a].position),i.centroid.addSelf(this.vertices[i.b].position),i.centroid.addSelf(this.vertices[i.c].position),i.centroid.divideScalar(3)):i instanceof n.Face4&&(i.centroid.addSelf(this.vertices[i.a].position),i.centroid.addSelf(this.vertices[i.b].position),i.centroid.addSelf(this.vertices[i.c].position),i.centroid.addSelf(this.vertices[i.d].position),i.centroid.divideScalar(4))},computeFaceNormals:function(){var t,e,i,a,r,s,o=new n.Vector3,l=new n.Vector3;for(t=0,e=this.faces.length;t<e;t++)i=this.faces[t],a=this.vertices[i.a],r=this.vertices[i.b],s=this.vertices[i.c],o.sub(s.position,r.position),l.sub(a.position,r.position),o.crossSelf(l),o.isZero()||o.normalize(),i.normal.copy(o)},computeVertexNormals:function(){var t,e,i,a;if(void 0===this.__tmpVertices){for(a=this.__tmpVertices=Array(this.vertices.length),t=0,e=this.vertices.length;t<e;t++)a[t]=new n.Vector3;for(t=0,e=this.faces.length;t<e;t++)(i=this.faces[t])instanceof n.Face3?i.vertexNormals=[new n.Vector3,new n.Vector3,new n.Vector3]:i instanceof n.Face4&&(i.vertexNormals=[new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3])}else for(a=this.__tmpVertices,t=0,e=this.vertices.length;t<e;t++)a[t].set(0,0,0);for(t=0,e=this.faces.length;t<e;t++)(i=this.faces[t])instanceof n.Face3?(a[i.a].addSelf(i.normal),a[i.b].addSelf(i.normal),a[i.c].addSelf(i.normal)):i instanceof n.Face4&&(a[i.a].addSelf(i.normal),a[i.b].addSelf(i.normal),a[i.c].addSelf(i.normal),a[i.d].addSelf(i.normal));for(t=0,e=this.vertices.length;t<e;t++)a[t].normalize();for(t=0,e=this.faces.length;t<e;t++)(i=this.faces[t])instanceof n.Face3?(i.vertexNormals[0].copy(a[i.a]),i.vertexNormals[1].copy(a[i.b]),i.vertexNormals[2].copy(a[i.c])):i instanceof n.Face4&&(i.vertexNormals[0].copy(a[i.a]),i.vertexNormals[1].copy(a[i.b]),i.vertexNormals[2].copy(a[i.c]),i.vertexNormals[3].copy(a[i.d]))},computeTangents:function(){function t(t,e,i,n,a,r,s){l=t.vertices[e].position,h=t.vertices[i].position,c=t.vertices[n].position,p=o[a],d=o[r],u=o[s],f=h.x-l.x,m=c.x-l.x,g=h.y-l.y,v=c.y-l.y,w=h.z-l.z,x=c.z-l.z,y=d.u-p.u,b=u.u-p.u,S=d.v-p.v,M=u.v-p.v,T=1/(y*M-b*S),P.set((M*f-S*m)*T,(M*g-S*v)*T,(M*w-S*x)*T),L.set((y*m-b*f)*T,(y*v-b*g)*T,(y*x-b*w)*T),z[e].addSelf(P),z[i].addSelf(P),z[n].addSelf(P),E[e].addSelf(L),E[i].addSelf(L),E[n].addSelf(L)}var e,i,a,r,s,o,l,h,c,p,d,u,f,m,g,v,w,x,y,b,S,M,T,C,z=[],E=[],P=new n.Vector3,L=new n.Vector3,k=new n.Vector3,V=new n.Vector3,I=new n.Vector3;for(e=0,i=this.vertices.length;e<i;e++)z[e]=new n.Vector3,E[e]=new n.Vector3;for(e=0,i=this.faces.length;e<i;e++)s=this.faces[e],o=this.faceVertexUvs[0][e],s instanceof n.Face3?t(this,s.a,s.b,s.c,0,1,2):s instanceof n.Face4&&(t(this,s.a,s.b,s.c,0,1,2),t(this,s.a,s.b,s.d,0,1,3));var R=["a","b","c","d"];for(e=0,i=this.faces.length;e<i;e++)for(s=this.faces[e],a=0;a<s.vertexNormals.length;a++)I.copy(s.vertexNormals[a]),r=s[R[a]],C=z[r],k.copy(C),k.subSelf(I.multiplyScalar(I.dot(C))).normalize(),V.cross(s.vertexNormals[a],C),r=(r=V.dot(E[r]))<0?-1:1,s.vertexTangents[a]=new n.Vector4(k.x,k.y,k.z,r);this.hasTangents=!0},computeBoundingBox:function(){var t;if(this.vertices.length>0){this.boundingBox={x:[this.vertices[0].position.x,this.vertices[0].position.x],y:[this.vertices[0].position.y,this.vertices[0].position.y],z:[this.vertices[0].position.z,this.vertices[0].position.z]};for(var e=1,i=this.vertices.length;e<i;e++)(t=this.vertices[e]).position.x<this.boundingBox.x[0]?this.boundingBox.x[0]=t.position.x:t.position.x>this.boundingBox.x[1]&&(this.boundingBox.x[1]=t.position.x),t.position.y<this.boundingBox.y[0]?this.boundingBox.y[0]=t.position.y:t.position.y>this.boundingBox.y[1]&&(this.boundingBox.y[1]=t.position.y),t.position.z<this.boundingBox.z[0]?this.boundingBox.z[0]=t.position.z:t.position.z>this.boundingBox.z[1]&&(this.boundingBox.z[1]=t.position.z)}},computeBoundingSphere:function(){for(var t=0,e=0,i=this.vertices.length;e<i;e++)t=Math.max(t,this.vertices[e].position.length());this.boundingSphere={radius:t}},mergeVertices:function(){var t,e,i,a={},r=[],s=[],o=Math.pow(10,4);for(e=0,i=this.vertices.length;e<i;e++)t=this.vertices[e].position,void 0===a[t=[Math.round(t.x*o),Math.round(t.y*o),Math.round(t.z*o)].join("_")]?(a[t]=e,r.push(this.vertices[e]),s[e]=r.length-1):s[e]=s[a[t]];for(e=0,i=this.faces.length;e<i;e++)(a=this.faces[e])instanceof n.Face3?(a.a=s[a.a],a.b=s[a.b],a.c=s[a.c]):a instanceof n.Face4&&(a.a=s[a.a],a.b=s[a.b],a.c=s[a.c],a.d=s[a.d]);this.vertices=r}},n.GeometryCount=0,n.Camera=function(){if(arguments.length)return console.warn("DEPRECATED: Camera() is now PerspectiveCamera() or OrthographicCamera()."),new n.PerspectiveCamera(arguments[0],arguments[1],arguments[2],arguments[3]);n.Object3D.call(this),this.matrixWorldInverse=new n.Matrix4,this.projectionMatrix=new n.Matrix4,this.projectionMatrixInverse=new n.Matrix4},n.Camera.prototype=new n.Object3D,n.Camera.prototype.constructor=n.Camera,n.Camera.prototype.lookAt=function(t){this.matrix.lookAt(this.position,t,this.up),this.rotationAutoUpdate&&this.rotation.setRotationFromMatrix(this.matrix)},n.OrthographicCamera=function(t,e,i,a,r,s){n.Camera.call(this),this.left=t,this.right=e,this.top=i,this.bottom=a,this.near=void 0!==r?r:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()},n.OrthographicCamera.prototype=new n.Camera,n.OrthographicCamera.prototype.constructor=n.OrthographicCamera,n.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix=n.Matrix4.makeOrtho(this.left,this.right,this.top,this.bottom,this.near,this.far)},n.PerspectiveCamera=function(t,e,i,a){n.Camera.call(this),this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()},n.PerspectiveCamera.prototype=new n.Camera,n.PerspectiveCamera.prototype.constructor=n.PerspectiveCamera,n.PerspectiveCamera.prototype.setLens=function(t,e){this.fov=2*Math.atan((void 0!==e?e:43.25)/(2*t)),this.fov*=180/Math.PI,this.updateProjectionMatrix()},n.PerspectiveCamera.prototype.setViewOffset=function(t,e,i,n,a,r){this.fullWidth=t,this.fullHeight=e,this.x=i,this.y=n,this.width=a,this.height=r,this.updateProjectionMatrix()},n.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var t=this.fullWidth/this.fullHeight,e=Math.tan(this.fov*Math.PI/360)*this.near,i=t*(a=-e),a=(t=Math.abs(t*e-i),Math.abs(e-a));this.projectionMatrix=n.Matrix4.makeFrustum(i+this.x*t/this.fullWidth,i+(this.x+this.width)*t/this.fullWidth,e-(this.y+this.height)*a/this.fullHeight,e-this.y*a/this.fullHeight,this.near,this.far)}else this.projectionMatrix=n.Matrix4.makePerspective(this.fov,this.aspect,this.near,this.far)},n.Light=function(t){n.Object3D.call(this),this.color=new n.Color(t)},n.Light.prototype=new n.Object3D,n.Light.prototype.constructor=n.Light,n.Light.prototype.supr=n.Object3D.prototype,n.AmbientLight=function(t){n.Light.call(this,t)},n.AmbientLight.prototype=new n.Light,n.AmbientLight.prototype.constructor=n.AmbientLight,n.DirectionalLight=function(t,e,i){n.Light.call(this,t),this.position=new n.Vector3(0,1,0),this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0},n.DirectionalLight.prototype=new n.Light,n.DirectionalLight.prototype.constructor=n.DirectionalLight,n.PointLight=function(t,e,i){n.Light.call(this,t),this.position=new n.Vector3(0,0,0),this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0},n.PointLight.prototype=new n.Light,n.PointLight.prototype.constructor=n.PointLight,n.Material=function(t){this.name="",this.id=n.MaterialCount++,t=t||{},this.opacity=void 0!==t.opacity?t.opacity:1,this.transparent=void 0!==t.transparent&&t.transparent,this.blending=void 0!==t.blending?t.blending:n.NormalBlending,this.depthTest=void 0===t.depthTest||t.depthTest,this.depthWrite=void 0===t.depthWrite||t.depthWrite,this.polygonOffset=void 0!==t.polygonOffset&&t.polygonOffset,this.polygonOffsetFactor=void 0!==t.polygonOffsetFactor?t.polygonOffsetFactor:0,this.polygonOffsetUnits=void 0!==t.polygonOffsetUnits?t.polygonOffsetUnits:0,this.alphaTest=void 0!==t.alphaTest?t.alphaTest:0,this.overdraw=void 0!==t.overdraw&&t.overdraw},n.MaterialCount=0,n.NoShading=0,n.FlatShading=1,n.SmoothShading=2,n.NoColors=0,n.FaceColors=1,n.VertexColors=2,n.NormalBlending=0,n.AdditiveBlending=1,n.SubtractiveBlending=2,n.MultiplyBlending=3,n.AdditiveAlphaBlending=4,n.LineBasicMaterial=function(t){n.Material.call(this,t),t=t||{},this.color=void 0!==t.color?new n.Color(t.color):new n.Color(16777215),this.linewidth=void 0!==t.linewidth?t.linewidth:1,this.linecap=void 0!==t.linecap?t.linecap:"round",this.linejoin=void 0!==t.linejoin?t.linejoin:"round",this.vertexColors=!!t.vertexColors&&t.vertexColors,this.fog=void 0===t.fog||t.fog},n.LineBasicMaterial.prototype=new n.Material,n.LineBasicMaterial.prototype.constructor=n.LineBasicMaterial,n.MeshBasicMaterial=function(t){n.Material.call(this,t),t=t||{},this.color=void 0!==t.color?new n.Color(t.color):new n.Color(16777215),this.map=void 0!==t.map?t.map:null,this.lightMap=void 0!==t.lightMap?t.lightMap:null,this.envMap=void 0!==t.envMap?t.envMap:null,this.combine=void 0!==t.combine?t.combine:n.MultiplyOperation,this.reflectivity=void 0!==t.reflectivity?t.reflectivity:1,this.refractionRatio=void 0!==t.refractionRatio?t.refractionRatio:.98,this.fog=void 0===t.fog||t.fog,this.shading=void 0!==t.shading?t.shading:n.SmoothShading,this.wireframe=void 0!==t.wireframe&&t.wireframe,this.wireframeLinewidth=void 0!==t.wireframeLinewidth?t.wireframeLinewidth:1,this.wireframeLinecap=void 0!==t.wireframeLinecap?t.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==t.wireframeLinejoin?t.wireframeLinejoin:"round",this.vertexColors=void 0!==t.vertexColors&&t.vertexColors,this.skinning=void 0!==t.skinning&&t.skinning,this.morphTargets=void 0!==t.morphTargets&&t.morphTargets},n.MeshBasicMaterial.prototype=new n.Material,n.MeshBasicMaterial.prototype.constructor=n.MeshBasicMaterial,n.MeshLambertMaterial=function(t){n.Material.call(this,t),t=t||{},this.color=void 0!==t.color?new n.Color(t.color):new n.Color(16777215),this.ambient=void 0!==t.ambient?new n.Color(t.ambient):new n.Color(328965),this.map=void 0!==t.map?t.map:null,this.lightMap=void 0!==t.lightMap?t.lightMap:null,this.envMap=void 0!==t.envMap?t.envMap:null,this.combine=void 0!==t.combine?t.combine:n.MultiplyOperation,this.reflectivity=void 0!==t.reflectivity?t.reflectivity:1,this.refractionRatio=void 0!==t.refractionRatio?t.refractionRatio:.98,this.fog=void 0===t.fog||t.fog,this.shading=void 0!==t.shading?t.shading:n.SmoothShading,this.wireframe=void 0!==t.wireframe&&t.wireframe,this.wireframeLinewidth=void 0!==t.wireframeLinewidth?t.wireframeLinewidth:1,this.wireframeLinecap=void 0!==t.wireframeLinecap?t.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==t.wireframeLinejoin?t.wireframeLinejoin:"round",this.vertexColors=void 0!==t.vertexColors&&t.vertexColors,this.skinning=void 0!==t.skinning&&t.skinning,this.morphTargets=void 0!==t.morphTargets&&t.morphTargets},n.MeshLambertMaterial.prototype=new n.Material,n.MeshLambertMaterial.prototype.constructor=n.MeshLambertMaterial,n.MeshPhongMaterial=function(t){n.Material.call(this,t),t=t||{},this.color=void 0!==t.color?new n.Color(t.color):new n.Color(16777215),this.ambient=void 0!==t.ambient?new n.Color(t.ambient):new n.Color(328965),this.specular=void 0!==t.specular?new n.Color(t.specular):new n.Color(1118481),this.shininess=void 0!==t.shininess?t.shininess:30,this.metal=void 0!==t.metal&&t.metal,this.perPixel=void 0!==t.perPixel&&t.perPixel,this.map=void 0!==t.map?t.map:null,this.lightMap=void 0!==t.lightMap?t.lightMap:null,this.envMap=void 0!==t.envMap?t.envMap:null,this.combine=void 0!==t.combine?t.combine:n.MultiplyOperation,this.reflectivity=void 0!==t.reflectivity?t.reflectivity:1,this.refractionRatio=void 0!==t.refractionRatio?t.refractionRatio:.98,this.fog=void 0===t.fog||t.fog,this.shading=void 0!==t.shading?t.shading:n.SmoothShading,this.wireframe=void 0!==t.wireframe&&t.wireframe,this.wireframeLinewidth=void 0!==t.wireframeLinewidth?t.wireframeLinewidth:1,this.wireframeLinecap=void 0!==t.wireframeLinecap?t.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==t.wireframeLinejoin?t.wireframeLinejoin:"round",this.vertexColors=void 0!==t.vertexColors&&t.vertexColors,this.skinning=void 0!==t.skinning&&t.skinning,this.morphTargets=void 0!==t.morphTargets&&t.morphTargets},n.MeshPhongMaterial.prototype=new n.Material,n.MeshPhongMaterial.prototype.constructor=n.MeshPhongMaterial,n.MeshDepthMaterial=function(t){n.Material.call(this,t),t=t||{},this.shading=void 0!==t.shading?t.shading:n.SmoothShading,this.wireframe=void 0!==t.wireframe&&t.wireframe,this.wireframeLinewidth=void 0!==t.wireframeLinewidth?t.wireframeLinewidth:1},n.MeshDepthMaterial.prototype=new n.Material,n.MeshDepthMaterial.prototype.constructor=n.MeshDepthMaterial,n.MeshNormalMaterial=function(t){n.Material.call(this,t),t=t||{},this.shading=t.shading?t.shading:n.FlatShading,this.wireframe=!!t.wireframe&&t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth?t.wireframeLinewidth:1},n.MeshNormalMaterial.prototype=new n.Material,n.MeshNormalMaterial.prototype.constructor=n.MeshNormalMaterial,n.MeshFaceMaterial=function(){},n.ParticleBasicMaterial=function(t){n.Material.call(this,t),t=t||{},this.color=void 0!==t.color?new n.Color(t.color):new n.Color(16777215),this.map=void 0!==t.map?t.map:null,this.size=void 0!==t.size?t.size:1,this.sizeAttenuation=void 0===t.sizeAttenuation||t.sizeAttenuation,this.vertexColors=void 0!==t.vertexColors&&t.vertexColors,this.fog=void 0===t.fog||t.fog},n.ParticleBasicMaterial.prototype=new n.Material,n.ParticleBasicMaterial.prototype.constructor=n.ParticleBasicMaterial,n.ParticleCanvasMaterial=function(t){n.Material.call(this,t),t=t||{},this.color=void 0!==t.color?new n.Color(t.color):new n.Color(16777215),this.program=void 0!==t.program?t.program:function(){}},n.ParticleCanvasMaterial.prototype=new n.Material,n.ParticleCanvasMaterial.prototype.constructor=n.ParticleCanvasMaterial,n.Texture=function(t,e,i,a,r,s){this.id=n.TextureCount++,this.image=t,this.mapping=void 0!==e?e:new n.UVMapping,this.wrapS=void 0!==i?i:n.ClampToEdgeWrapping,this.wrapT=void 0!==a?a:n.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:n.LinearFilter,this.minFilter=void 0!==s?s:n.LinearMipMapLinearFilter,this.offset=new n.Vector2(0,0),this.repeat=new n.Vector2(1,1),this.needsUpdate=!1,this.onUpdate=null},n.Texture.prototype={constructor:n.Texture,clone:function(){var t=new n.Texture(this.image,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter);return t.offset.copy(this.offset),t.repeat.copy(this.repeat),t}},n.TextureCount=0,n.MultiplyOperation=0,n.MixOperation=1,n.CubeReflectionMapping=function(){},n.CubeRefractionMapping=function(){},n.LatitudeReflectionMapping=function(){},n.LatitudeRefractionMapping=function(){},n.SphericalReflectionMapping=function(){},n.SphericalRefractionMapping=function(){},n.UVMapping=function(){},n.RepeatWrapping=0,n.ClampToEdgeWrapping=1,n.MirroredRepeatWrapping=2,n.NearestFilter=3,n.NearestMipMapNearestFilter=4,n.NearestMipMapLinearFilter=5,n.LinearFilter=6,n.LinearMipMapNearestFilter=7,n.LinearMipMapLinearFilter=8,n.ByteType=9,n.UnsignedByteType=10,n.ShortType=11,n.UnsignedShortType=12,n.IntType=13,n.UnsignedIntType=14,n.FloatType=15,n.AlphaFormat=16,n.RGBFormat=17,n.RGBAFormat=18,n.LuminanceFormat=19,n.LuminanceAlphaFormat=20,n.Particle=function(t){n.Object3D.call(this),this.material=t},n.Particle.prototype=new n.Object3D,n.Particle.prototype.constructor=n.Particle,n.Line=function(t,e,i){n.Object3D.call(this),this.geometry=t,this.material=e,this.type=void 0!==i?i:n.LineStrip,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())},n.LineStrip=0,n.LinePieces=1,n.Line.prototype=new n.Object3D,n.Line.prototype.constructor=n.Line,n.Mesh=function(t,e){if(n.Object3D.call(this),this.geometry=t,this.material=e,e instanceof Array&&(console.warn("DEPRECATED: Mesh material can no longer be an Array. Using material at index 0..."),this.material=e[0]),this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=t.boundingSphere.radius,this.geometry.morphTargets.length)){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0;i<this.geometry.morphTargets.length;i++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[i].name]=i}},n.Mesh.prototype=new n.Object3D,n.Mesh.prototype.constructor=n.Mesh,n.Mesh.prototype.supr=n.Object3D.prototype,n.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},n.Bone=function(t){n.Object3D.call(this),this.skin=t,this.skinMatrix=new n.Matrix4},n.Bone.prototype=new n.Object3D,n.Bone.prototype.constructor=n.Bone,n.Bone.prototype.supr=n.Object3D.prototype,n.Bone.prototype.update=function(t,e){this.matrixAutoUpdate&&(e|=this.updateMatrix()),(e||this.matrixWorldNeedsUpdate)&&(t?this.skinMatrix.multiply(t,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);var i,n=this.children.length;for(i=0;i<n;i++)this.children[i].update(this.skinMatrix,e)},n.Sprite=function(t){n.Object3D.call(this),this.color=void 0!==t.color?new n.Color(t.color):new n.Color(16777215),this.map=t.map instanceof n.Texture?t.map:n.ImageUtils.loadTexture(t.map),this.blending=void 0!==t.blending?t.blending:n.NormalBlending,this.useScreenCoordinates=void 0===t.useScreenCoordinates||t.useScreenCoordinates,this.mergeWith3D=void 0!==t.mergeWith3D?t.mergeWith3D:!this.useScreenCoordinates,this.affectedByDistance=void 0!==t.affectedByDistance?t.affectedByDistance:!this.useScreenCoordinates,this.scaleByViewport=void 0!==t.scaleByViewport?t.scaleByViewport:!this.affectedByDistance,this.alignment=t.alignment instanceof n.Vector2?t.alignment:n.SpriteAlignment.center,this.rotation3d=this.rotation,this.rotation=0,this.opacity=1,this.uvOffset=new n.Vector2(0,0),this.uvScale=new n.Vector2(1,1)},n.Sprite.prototype=new n.Object3D,n.Sprite.prototype.constructor=n.Sprite,n.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),1===this.scale.x&&1===this.scale.y||(this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,this.scale.y)),this.matrixWorldNeedsUpdate=!0},n.SpriteAlignment={},n.SpriteAlignment.topLeft=new n.Vector2(1,-1),n.SpriteAlignment.topCenter=new n.Vector2(0,-1),n.SpriteAlignment.topRight=new n.Vector2(-1,-1),n.SpriteAlignment.centerLeft=new n.Vector2(1,0),n.SpriteAlignment.center=new n.Vector2(0,0),n.SpriteAlignment.centerRight=new n.Vector2(-1,0),n.SpriteAlignment.bottomLeft=new n.Vector2(1,1),n.SpriteAlignment.bottomCenter=new n.Vector2(0,1),n.SpriteAlignment.bottomRight=new n.Vector2(-1,1),n.Scene=function(){n.Object3D.call(this),this.overrideMaterial=this.fog=null,this.matrixAutoUpdate=!1,this.objects=[],this.lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},n.Scene.prototype=new n.Object3D,n.Scene.prototype.constructor=n.Scene,n.Scene.prototype.addObject=function(t){if(t instanceof n.Light)-1===this.lights.indexOf(t)&&this.lights.push(t);else if(!(t instanceof n.Camera||t instanceof n.Bone)&&-1===this.objects.indexOf(t)){this.objects.push(t),this.__objectsAdded.push(t);var e=this.__objectsRemoved.indexOf(t);-1!==e&&this.__objectsRemoved.splice(e,1)}for(e=0;e<t.children.length;e++)this.addObject(t.children[e])},n.Scene.prototype.removeObject=function(t){if(t instanceof n.Light){var e=this.lights.indexOf(t);-1!==e&&this.lights.splice(e,1)}else t instanceof n.Camera||-1!==(e=this.objects.indexOf(t))&&(this.objects.splice(e,1),this.__objectsRemoved.push(t),-1!==(e=this.__objectsAdded.indexOf(t))&&this.__objectsAdded.splice(e,1));for(e=0;e<t.children.length;e++)this.removeObject(t.children[e])},n.CanvasRenderer=function(t){function e(t){K!=t&&(U.globalAlpha=K=t)}function i(t){if(Q!=t){switch(t){case n.NormalBlending:U.globalCompositeOperation="source-over";break;case n.AdditiveBlending:U.globalCompositeOperation="lighter";break;case n.SubtractiveBlending:U.globalCompositeOperation="darker"}Q=t}}function a(t){J!=t&&(U.strokeStyle=J=t)}function r(t){tt!=t&&(U.fillStyle=tt=t)}var s,o,l,h,c,p,d,u,f,m,g,v,w,x,y,b,S,M,T,C,z,E,P,L,k,V,I,R,_,D,A,W,O,B,Y,j,X,N,F,G=this,H=new n.Projector,q=void 0!==(t=t||{}).canvas?t.canvas:document.createElement("canvas"),U=q.getContext("2d"),$=new n.Color(0),Z=0,K=1,Q=0,J=null,tt=null,et=null,it=null,nt=null,at=new n.RenderableVertex,rt=new n.RenderableVertex,st=new n.Color,ot=new n.Color,lt=new n.Color,ht=new n.Color,ct=new n.Color,pt=[],dt=[],ut=new n.Rectangle,ft=new n.Rectangle,mt=new n.Rectangle,gt=!1,vt=new n.Color,wt=new n.Color,xt=new n.Color,yt=new n.Vector3;t=16;(B=document.createElement("canvas")).width=B.height=2,(Y=B.getContext("2d")).fillStyle="rgba(0,0,0,1)",Y.fillRect(0,0,2,2),j=Y.getImageData(0,0,2,2),X=j.data,(N=document.createElement("canvas")).width=N.height=t,(F=N.getContext("2d")).translate(-t/2,-t/2),F.scale(t,t),t--,this.domElement=q,this.sortElements=this.sortObjects=this.autoClear=!0,this.info={render:{vertices:0,faces:0}},this.setSize=function(t,e){h=t,c=e,p=Math.floor(h/2),d=Math.floor(c/2),q.width=h,q.height=c,ut.set(-p,-d,p,d),ft.set(-p,-d,p,d),K=1,Q=0,nt=it=et=tt=J=null},this.setClearColor=function(t,e){$.copy(t),Z=e,ft.set(-p,-d,p,d)},this.setClearColorHex=function(t,e){$.setHex(t),Z=e,ft.set(-p,-d,p,d)},this.clear=function(){U.setTransform(1,0,0,-1,p,d),ft.isEmpty()||(ft.minSelf(ut),ft.inflate(2),Z<1&&U.clearRect(Math.floor(ft.getX()),Math.floor(ft.getY()),Math.floor(ft.getWidth()),Math.floor(ft.getHeight())),Z>0&&(i(n.NormalBlending),e(1),r("rgba("+Math.floor(255*$.r)+","+Math.floor(255*$.g)+","+Math.floor(255*$.b)+","+Z+")"),U.fillRect(Math.floor(ft.getX()),Math.floor(ft.getY()),Math.floor(ft.getWidth()),Math.floor(ft.getHeight()))),ft.empty())},this.render=function(t,h){function c(t,e,i,a){var r,s,o,l,h,c;for(r=0,s=t.length;r<s;r++)l=(o=t[r]).color,o instanceof n.DirectionalLight?(h=o.matrixWorld.getPosition(),(c=i.dot(h))<=0||(c*=o.intensity,a.r+=l.r*c,a.g+=l.g*c,a.b+=l.b*c)):o instanceof n.PointLight&&(h=o.matrixWorld.getPosition(),(c=i.dot(yt.sub(h,e).normalize()))<=0||0!=(c*=0==o.distance?1:1-Math.min(e.distanceTo(h)/o.distance,1))&&(c*=o.intensity,a.r+=l.r*c,a.g+=l.g*c,a.b+=l.b*c))}function q(t,s,o){var l,h,c,u,f,m;e(o.opacity),i(o.blending),o instanceof n.ParticleBasicMaterial?o.map&&(f=(u=o.map.image).width>>1,m=u.height>>1,l=(o=s.scale.x*p)*f,h=(c=s.scale.y*d)*m,mt.set(t.x-l,t.y-h,t.x+l,t.y+h),ut.intersects(mt)&&(U.save(),U.translate(t.x,t.y),U.rotate(-s.rotation),U.scale(o,-c),U.translate(-f,-m),U.drawImage(u,0,0),U.restore())):o instanceof n.ParticleCanvasMaterial&&(l=s.scale.x*p,h=s.scale.y*d,mt.set(t.x-l,t.y-h,t.x+l,t.y+h),ut.intersects(mt)&&(a(o.color.getContextStyle()),r(o.color.getContextStyle()),U.save(),U.translate(t.x,t.y),U.rotate(-s.rotation),U.scale(l,h),o.program(U),U.restore()))}function $(t,r,s,o){e(o.opacity),i(o.blending),U.beginPath(),U.moveTo(t.positionScreen.x,t.positionScreen.y),U.lineTo(r.positionScreen.x,r.positionScreen.y),U.closePath(),o instanceof n.LineBasicMaterial&&(t=o.linewidth,et!=t&&(U.lineWidth=et=t),t=o.linecap,it!=t&&(U.lineCap=it=t),t=o.linejoin,nt!=t&&(U.lineJoin=nt=t),a(o.color.getContextStyle()),U.stroke(),mt.inflate(2*o.linewidth))}function Z(t,a,r,s,o,p,d,u){G.info.render.vertices+=3,G.info.render.faces++,e(u.opacity),i(u.blending),v=t.positionScreen.x,w=t.positionScreen.y,x=a.positionScreen.x,y=a.positionScreen.y,b=r.positionScreen.x,S=r.positionScreen.y,Q(v,w,x,y,b,S),u instanceof n.MeshBasicMaterial?u.map?u.map.mapping instanceof n.UVMapping&&(I=d.uvs[0],St(v,w,x,y,b,S,I[s].u,I[s].v,I[o].u,I[o].v,I[p].u,I[p].v,u.map)):u.envMap?u.envMap.mapping instanceof n.SphericalReflectionMapping&&(t=h.matrixWorldInverse,yt.copy(d.vertexNormalsWorld[s]),R=.5*(yt.x*t.n11+yt.y*t.n12+yt.z*t.n13)+.5,_=.5*-(yt.x*t.n21+yt.y*t.n22+yt.z*t.n23)+.5,yt.copy(d.vertexNormalsWorld[o]),D=.5*(yt.x*t.n11+yt.y*t.n12+yt.z*t.n13)+.5,A=.5*-(yt.x*t.n21+yt.y*t.n22+yt.z*t.n23)+.5,yt.copy(d.vertexNormalsWorld[p]),W=.5*(yt.x*t.n11+yt.y*t.n12+yt.z*t.n13)+.5,O=.5*-(yt.x*t.n21+yt.y*t.n22+yt.z*t.n23)+.5,St(v,w,x,y,b,S,R,_,D,A,W,O,u.envMap)):u.wireframe?tt(u.color,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(u.color):u instanceof n.MeshLambertMaterial?(u.map&&!u.wireframe&&(u.map.mapping instanceof n.UVMapping&&(I=d.uvs[0],St(v,w,x,y,b,S,I[s].u,I[s].v,I[o].u,I[o].v,I[p].u,I[p].v,u.map)),i(n.SubtractiveBlending)),gt?u.wireframe||u.shading!=n.SmoothShading||3!=d.vertexNormalsWorld.length?(st.r=vt.r,st.g=vt.g,st.b=vt.b,c(l,d.centroidWorld,d.normalWorld,st),st.r=Math.max(0,Math.min(u.color.r*st.r,1)),st.g=Math.max(0,Math.min(u.color.g*st.g,1)),st.b=Math.max(0,Math.min(u.color.b*st.b,1)),u.wireframe?tt(st,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(st)):(ot.r=lt.r=ht.r=vt.r,ot.g=lt.g=ht.g=vt.g,ot.b=lt.b=ht.b=vt.b,c(l,d.v1.positionWorld,d.vertexNormalsWorld[0],ot),c(l,d.v2.positionWorld,d.vertexNormalsWorld[1],lt),c(l,d.v3.positionWorld,d.vertexNormalsWorld[2],ht),ot.r=Math.max(0,Math.min(u.color.r*ot.r,1)),ot.g=Math.max(0,Math.min(u.color.g*ot.g,1)),ot.b=Math.max(0,Math.min(u.color.b*ot.b,1)),lt.r=Math.max(0,Math.min(u.color.r*lt.r,1)),lt.g=Math.max(0,Math.min(u.color.g*lt.g,1)),lt.b=Math.max(0,Math.min(u.color.b*lt.b,1)),ht.r=Math.max(0,Math.min(u.color.r*ht.r,1)),ht.g=Math.max(0,Math.min(u.color.g*ht.g,1)),ht.b=Math.max(0,Math.min(u.color.b*ht.b,1)),ct.r=.5*(lt.r+ht.r),ct.g=.5*(lt.g+ht.g),ct.b=.5*(lt.b+ht.b),V=Tt(ot,lt,ht,ct),Mt(v,w,x,y,b,S,0,0,1,0,0,1,V)):u.wireframe?tt(u.color,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(u.color)):u instanceof n.MeshDepthMaterial?(L=h.near,k=h.far,ot.r=ot.g=ot.b=1-Ct(t.positionScreen.z,L,k),lt.r=lt.g=lt.b=1-Ct(a.positionScreen.z,L,k),ht.r=ht.g=ht.b=1-Ct(r.positionScreen.z,L,k),ct.r=.5*(lt.r+ht.r),ct.g=.5*(lt.g+ht.g),ct.b=.5*(lt.b+ht.b),V=Tt(ot,lt,ht,ct),Mt(v,w,x,y,b,S,0,0,1,0,0,1,V)):u instanceof n.MeshNormalMaterial&&(st.r=zt(d.normalWorld.x),st.g=zt(d.normalWorld.y),st.b=zt(d.normalWorld.z),u.wireframe?tt(st,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(st))}function K(t,a,r,s,o,p,d,u,f){G.info.render.vertices+=4,G.info.render.faces++,e(u.opacity),i(u.blending),u.map||u.envMap?(Z(t,a,s,0,1,3,d,u),Z(o,r,p,1,2,3,d,u)):(v=t.positionScreen.x,w=t.positionScreen.y,x=a.positionScreen.x,y=a.positionScreen.y,b=r.positionScreen.x,S=r.positionScreen.y,M=s.positionScreen.x,T=s.positionScreen.y,C=o.positionScreen.x,z=o.positionScreen.y,E=p.positionScreen.x,P=p.positionScreen.y,u instanceof n.MeshBasicMaterial?(J(v,w,x,y,b,S,M,T),u.wireframe?tt(u.color,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(u.color)):u instanceof n.MeshLambertMaterial?gt?u.wireframe||u.shading!=n.SmoothShading||4!=d.vertexNormalsWorld.length?(st.r=vt.r,st.g=vt.g,st.b=vt.b,c(l,d.centroidWorld,d.normalWorld,st),st.r=Math.max(0,Math.min(u.color.r*st.r,1)),st.g=Math.max(0,Math.min(u.color.g*st.g,1)),st.b=Math.max(0,Math.min(u.color.b*st.b,1)),J(v,w,x,y,b,S,M,T),u.wireframe?tt(st,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(st)):(ot.r=lt.r=ht.r=ct.r=vt.r,ot.g=lt.g=ht.g=ct.g=vt.g,ot.b=lt.b=ht.b=ct.b=vt.b,c(l,d.v1.positionWorld,d.vertexNormalsWorld[0],ot),c(l,d.v2.positionWorld,d.vertexNormalsWorld[1],lt),c(l,d.v4.positionWorld,d.vertexNormalsWorld[3],ht),c(l,d.v3.positionWorld,d.vertexNormalsWorld[2],ct),ot.r=Math.max(0,Math.min(u.color.r*ot.r,1)),ot.g=Math.max(0,Math.min(u.color.g*ot.g,1)),ot.b=Math.max(0,Math.min(u.color.b*ot.b,1)),lt.r=Math.max(0,Math.min(u.color.r*lt.r,1)),lt.g=Math.max(0,Math.min(u.color.g*lt.g,1)),lt.b=Math.max(0,Math.min(u.color.b*lt.b,1)),ht.r=Math.max(0,Math.min(u.color.r*ht.r,1)),ht.g=Math.max(0,Math.min(u.color.g*ht.g,1)),ht.b=Math.max(0,Math.min(u.color.b*ht.b,1)),ct.r=Math.max(0,Math.min(u.color.r*ct.r,1)),ct.g=Math.max(0,Math.min(u.color.g*ct.g,1)),ct.b=Math.max(0,Math.min(u.color.b*ct.b,1)),V=Tt(ot,lt,ht,ct),Q(v,w,x,y,M,T),Mt(v,w,x,y,M,T,0,0,1,0,0,1,V),Q(C,z,b,S,E,P),Mt(C,z,b,S,E,P,1,0,1,1,0,1,V)):(J(v,w,x,y,b,S,M,T),u.wireframe?tt(u.color,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(u.color)):u instanceof n.MeshNormalMaterial?(st.r=zt(d.normalWorld.x),st.g=zt(d.normalWorld.y),st.b=zt(d.normalWorld.z),J(v,w,x,y,b,S,M,T),u.wireframe?tt(st,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):bt(st)):u instanceof n.MeshDepthMaterial&&(L=h.near,k=h.far,ot.r=ot.g=ot.b=1-Ct(t.positionScreen.z,L,k),lt.r=lt.g=lt.b=1-Ct(a.positionScreen.z,L,k),ht.r=ht.g=ht.b=1-Ct(s.positionScreen.z,L,k),ct.r=ct.g=ct.b=1-Ct(r.positionScreen.z,L,k),V=Tt(ot,lt,ht,ct),Q(v,w,x,y,M,T),Mt(v,w,x,y,M,T,0,0,1,0,0,1,V),Q(C,z,b,S,E,P),Mt(C,z,b,S,E,P,1,0,1,1,0,1,V)))}function Q(t,e,i,n,a,r){U.beginPath(),U.moveTo(t,e),U.lineTo(i,n),U.lineTo(a,r),U.lineTo(t,e),U.closePath()}function J(t,e,i,n,a,r,s,o){U.beginPath(),U.moveTo(t,e),U.lineTo(i,n),U.lineTo(a,r),U.lineTo(s,o),U.lineTo(t,e),U.closePath()}function tt(t,e,i,n){et!=e&&(U.lineWidth=et=e),it!=i&&(U.lineCap=it=i),nt!=n&&(U.lineJoin=nt=n),a(t.getContextStyle()),U.stroke(),mt.inflate(2*e)}function bt(t){r(t.getContextStyle()),U.fill()}function St(t,e,i,a,s,o,l,h,c,p,d,u,f){if(0!=f.image.width){if(1==f.needsUpdate||null==pt[f.id]){var m=f.wrapS==n.RepeatWrapping,g=f.wrapT==n.RepeatWrapping;pt[f.id]=U.createPattern(f.image,m&&g?"repeat":m&&!g?"repeat-x":!m&&g?"repeat-y":"no-repeat"),f.needsUpdate=!1}r(pt[f.id]);m=f.offset.x/f.repeat.x,g=f.offset.y/f.repeat.y;var v=f.image.width*f.repeat.x,w=f.image.height*f.repeat.y;c=(c+m)*v,p=(p+g)*w,d=(d+m)*v,u=(u+g)*w;i-=t,a-=e,s-=t,o-=e,0==(m=(c-=l=(l+m)*v)*(u-=h=(h+g)*w)-(d-=l)*(p-=h))?(null==dt[f.id]&&((e=document.createElement("canvas")).width=f.image.width,e.height=f.image.height,(t=e.getContext("2d")).drawImage(f.image,0,0),dt[f.id]=t.getImageData(0,0,f.image.width,f.image.height).data,delete e),e=dt[f.id],l=4*(Math.floor(l)+Math.floor(h)*f.image.width),st.setRGB(e[l]/255,e[l+1]/255,e[l+2]/255),bt(st)):(t=t-(f=(u*i-p*s)*(m=1/m))*l-(i=(c*s-d*i)*m)*h,l=e-(p=(u*a-p*o)*m)*l-(a=(c*o-d*a)*m)*h,U.save(),U.transform(f,p,i,a,t,l),U.fill(),U.restore())}}function Mt(t,e,i,n,a,r,s,o,l,h,c,p,d){var u,f;l*=u=d.width-1,h*=f=d.height-1,c*=u,p*=f,t=t-(u=((p-=o*=f)*(i-=t)-(h-=o)*(a-=t))*(f=1/((l-=s*=u)*p-(c-=s)*h)))*s-(i=(l*a-c*i)*f)*o,e=e-(h=(p*(n-=e)-h*(r-=e))*f)*s-(n=(l*r-c*n)*f)*o,U.save(),U.transform(u,h,i,n,t,e),U.clip(),U.drawImage(d,0,0),U.restore()}function Tt(t,e,i,n){var a=~~(255*t.r),r=~~(255*t.g),s=(t=~~(255*t.b),~~(255*e.r)),o=~~(255*e.g),l=(e=~~(255*e.b),~~(255*i.r)),h=~~(255*i.g),c=(i=~~(255*i.b),~~(255*n.r)),p=~~(255*n.g);n=~~(255*n.b);return X[0]=a<0?0:a>255?255:a,X[1]=r<0?0:r>255?255:r,X[2]=t<0?0:t>255?255:t,X[4]=s<0?0:s>255?255:s,X[5]=o<0?0:o>255?255:o,X[6]=e<0?0:e>255?255:e,X[8]=l<0?0:l>255?255:l,X[9]=h<0?0:h>255?255:h,X[10]=i<0?0:i>255?255:i,X[12]=c<0?0:c>255?255:c,X[13]=p<0?0:p>255?255:p,X[14]=n<0?0:n>255?255:n,Y.putImageData(j,0,0),F.drawImage(B,0,0),N}function Ct(t,e,i){return(t=(t-e)/(i-e))*t*(3-2*t)}function zt(t){return(t=.5*(t+1))<0?0:t>1?1:t}function Et(t,e){var i=e.x-t.x,n=e.y-t.y,a=i*i+n*n;0!=a&&(i*=a=1/Math.sqrt(a),n*=a,e.x+=i,e.y+=n,t.x-=i,t.y-=n)}var Pt,Lt,kt,Vt;for(this.autoClear?this.clear():U.setTransform(1,0,0,-1,p,d),G.info.render.vertices=0,G.info.render.faces=0,s=H.projectScene(t,h,this.sortElements),o=s.elements,l=s.lights,(gt=l.length>0)&&function(t){var e,i,a,r;for(vt.setRGB(0,0,0),wt.setRGB(0,0,0),xt.setRGB(0,0,0),e=0,i=t.length;e<i;e++)r=(a=t[e]).color,a instanceof n.AmbientLight?(vt.r+=r.r,vt.g+=r.g,vt.b+=r.b):a instanceof n.DirectionalLight?(wt.r+=r.r,wt.g+=r.g,wt.b+=r.b):a instanceof n.PointLight&&(xt.r+=r.r,xt.g+=r.g,xt.b+=r.b)}(l),Pt=0,Lt=o.length;Pt<Lt;Pt++)null!=(Vt=(Vt=(kt=o[Pt]).material)instanceof n.MeshFaceMaterial?kt.faceMaterial:Vt)&&0!=Vt.opacity&&(mt.empty(),kt instanceof n.RenderableParticle?((u=kt).x*=p,u.y*=d,q(u,kt,Vt)):kt instanceof n.RenderableLine?(u=kt.v1,f=kt.v2,u.positionScreen.x*=p,u.positionScreen.y*=d,f.positionScreen.x*=p,f.positionScreen.y*=d,mt.addPoint(u.positionScreen.x,u.positionScreen.y),mt.addPoint(f.positionScreen.x,f.positionScreen.y),ut.intersects(mt)&&$(u,f,0,Vt)):kt instanceof n.RenderableFace3?(u=kt.v1,f=kt.v2,m=kt.v3,u.positionScreen.x*=p,u.positionScreen.y*=d,f.positionScreen.x*=p,f.positionScreen.y*=d,m.positionScreen.x*=p,m.positionScreen.y*=d,Vt.overdraw&&(Et(u.positionScreen,f.positionScreen),Et(f.positionScreen,m.positionScreen),Et(m.positionScreen,u.positionScreen)),mt.add3Points(u.positionScreen.x,u.positionScreen.y,f.positionScreen.x,f.positionScreen.y,m.positionScreen.x,m.positionScreen.y),ut.intersects(mt)&&Z(u,f,m,0,1,2,kt,Vt)):kt instanceof n.RenderableFace4&&(u=kt.v1,f=kt.v2,m=kt.v3,g=kt.v4,u.positionScreen.x*=p,u.positionScreen.y*=d,f.positionScreen.x*=p,f.positionScreen.y*=d,m.positionScreen.x*=p,m.positionScreen.y*=d,g.positionScreen.x*=p,g.positionScreen.y*=d,at.positionScreen.copy(f.positionScreen),rt.positionScreen.copy(g.positionScreen),Vt.overdraw&&(Et(u.positionScreen,f.positionScreen),Et(f.positionScreen,g.positionScreen),Et(g.positionScreen,u.positionScreen),Et(m.positionScreen,at.positionScreen),Et(m.positionScreen,rt.positionScreen)),mt.addPoint(u.positionScreen.x,u.positionScreen.y),mt.addPoint(f.positionScreen.x,f.positionScreen.y),mt.addPoint(m.positionScreen.x,m.positionScreen.y),mt.addPoint(g.positionScreen.x,g.positionScreen.y),ut.intersects(mt)&&K(u,f,m,g,at,rt,kt,Vt)),ft.addRectangle(mt));U.setTransform(1,0,0,1,0,0)}},n.RenderableVertex=function(){this.positionWorld=new n.Vector3,this.positionScreen=new n.Vector4,this.visible=!0},n.RenderableVertex.prototype.copy=function(t){this.positionWorld.copy(t.positionWorld),this.positionScreen.copy(t.positionScreen)},n.RenderableFace3=function(){this.v1=new n.RenderableVertex,this.v2=new n.RenderableVertex,this.v3=new n.RenderableVertex,this.centroidWorld=new n.Vector3,this.centroidScreen=new n.Vector3,this.normalWorld=new n.Vector3,this.vertexNormalsWorld=[new n.Vector3,new n.Vector3,new n.Vector3],this.faceMaterial=this.material=null,this.uvs=[[]],this.z=null},n.RenderableFace4=function(){this.v1=new n.RenderableVertex,this.v2=new n.RenderableVertex,this.v3=new n.RenderableVertex,this.v4=new n.RenderableVertex,this.centroidWorld=new n.Vector3,this.centroidScreen=new n.Vector3,this.normalWorld=new n.Vector3,this.vertexNormalsWorld=[new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3],this.faceMaterial=this.material=null,this.uvs=[[]],this.z=null},n.RenderableObject=function(){this.z=this.object=null},n.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=null,this.scale=new n.Vector2,this.material=null},n.RenderableLine=function(){this.z=null,this.v1=new n.RenderableVertex,this.v2=new n.RenderableVertex,this.material=null},i.exports=n})),define("playSnow",[],(function(require,exports,module){require("../lib/js/config/config");var THREE=require("./ThreeCanvas"),SCREEN_WIDTH=200,SCREEN_HEIGHT=200,container,particle,camera,scene,renderer,mouseX=0,mouseY=0,windowHalfX=200,windowHalfY=200,particles=[],particleImage=new Image;function Snowinit(){container=document.createElement("div"),document.getElementById("snow").appendChild(container),(camera=new THREE.PerspectiveCamera(75,SCREEN_WIDTH/SCREEN_HEIGHT,1,1e4)).position.z=1e3,(scene=new THREE.Scene).add(camera),(renderer=new THREE.CanvasRenderer).setSize(SCREEN_WIDTH,SCREEN_HEIGHT);for(var t=new THREE.ParticleBasicMaterial({map:new THREE.Texture(particleImage)}),e=0;e<200;e++)(particle=new Particle3D(t)).position.x=2e3*Math.random()-1e3,particle.position.y=2e3*Math.random()-1e3,particle.position.z=2e3*Math.random()-1e3,particle.scale.x=particle.scale.y=1,scene.add(particle),particles.push(particle);container.appendChild(renderer.domElement),setInterval(loop,1e3/60)}function onDocumentMouseMove(t){mouseX=t.clientX-windowHalfX,mouseY=t.clientY-windowHalfY}function onDocumentTouchStart(t){1==t.touches.length&&(t.preventDefault(),mouseX=t.touches[0].pageX-windowHalfX,mouseY=t.touches[0].pageY-windowHalfY)}function onDocumentTouchMove(t){1==t.touches.length&&(t.preventDefault(),mouseX=t.touches[0].pageX-windowHalfX,mouseY=t.touches[0].pageY-windowHalfY)}function loop(){for(var i=0;i<particles.length;i++){var particle=particles[i];with(particle.updatePhysics(),particle.position)y<-1e3&&(y+=2e3),x>1e3?x-=2e3:x<-1e3&&(x+=2e3),z>1e3?z-=2e3:z<-1e3&&(z+=2e3)}camera.position.x+=.05*(mouseX-camera.position.x),camera.position.y+=.05*(-mouseY-camera.position.y),camera.lookAt(scene.position),renderer.render(scene,camera)}particleImage.src=OP_CDN_PREFIX+"images/ParticleSmoke.png",module.exports=Snowinit}));